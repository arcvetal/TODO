var taskList=document.querySelector(".task-list"),templateList=document.querySelector(".list-template__task-list"),deleteIcon=document.querySelector(".delete-icon"),deleteIconTemplate=document.querySelector(".delete-icon--template"),taskReadyArr=[].slice.call(taskList.querySelectorAll(".task__ready")),storage=localStorage,dataList={"Начать делать презентацию":"work","Заплатить за аренду":"personal","Купить молоко":"shopping","Не забыть забрать Мишу со школы":"family","Купить шоколад Маше":"shopping"};storage.data=JSON.stringify(dataList);var renderMainList=function(e){var t=document.createDocumentFragment();for(key in e){var a=document.createElement("div");a.classList.add("task"),a.classList.add("task--"+e[key]);var n=document.createElement("div");n.classList.add("task__ready"),a.appendChild(n);var l=document.createElement("p");l.classList.add("task__text"),l.textContent=key,a.appendChild(l),t.appendChild(a)}taskList.appendChild(t)};renderMainList(JSON.parse(storage.data));var doneMark=document.querySelector(".task__ready--done");doneMark&&deleteIcon.classList.add("delete-icon--show");var onTaskDone=function(t){t.addEventListener("click",function(e){e.target.classList.contains("task__ready")&&(e.target.classList.toggle("task__ready--done"),e.target.nextElementSibling.classList.toggle("task__text--done"),e.target.parentElement.classList.toggle("task--done"),t.querySelector(".task__ready--done")?deleteIcon.classList.add("delete-icon--show"):deleteIcon.classList.remove("delete-icon--show"))})};onTaskDone(taskList),deleteIcon.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".task--done")),a=0;a<t.length;a++)t[a].remove();deleteIcon.classList.remove("delete-icon--show"),updateData()});var formBtn=document.querySelector(".form__btn"),btnList=document.querySelector(".create__items"),overlay=document.querySelector(".overlay");formBtn.addEventListener("click",function(e){formBtn.classList.toggle("form__btn--active"),btnList.classList.toggle("create__items--active"),overlay.classList.toggle("overlay--active")});var listTemplate=document.querySelector(".list-template"),templateTitile=listTemplate.querySelector(".list-template__title"),templateCount=listTemplate.querySelector(".list-template__count"),templateTaskList=document.querySelector(".list-template__task-list"),templateItem=document.querySelector(".list-template__task--template"),templateReady=templateItem.querySelector(".list-template__task-ready"),templateText=templateItem.querySelector(".list-template__task-text"),templateDate=templateItem.querySelector("task__date"),categoryList=document.querySelector(".category__list"),callback=function(e){var t=e.target;"LI"===event.target.parentElement.tagName&&(t=event.target.parentElement);var a=getComputedStyle(t).getPropertyValue("background-color"),n=t.firstElementChild.innerText,l=t.lastElementChild.innerText;listTemplate.style.backgroundColor=a,templateTitile.textContent=n,templateCount.textContent=l;var c=t.id.slice(4);!function(){for(var e=[].slice.call(taskList.querySelectorAll(".task--"+c)),t=document.createDocumentFragment(),a=0;a<e.length;a++){var n=document.createElement("div");n.classList.add("list-template__task"),n.classList.add("list-template__task--template");var l=document.createElement("div");l.classList.add("list-template__task-ready"),n.appendChild(l);var s=document.createElement("p");s.classList.add("list-template__task-text"),n.appendChild(s);var r=document.createElement("span");r.classList.add("list-template__task-date"),n.appendChild(r),s.textContent=e[a].textContent,t.appendChild(n)}templateTaskList.innerHTML="",templateTaskList.appendChild(t)}()};categoryList.addEventListener("click",callback),onTaskDone(templateTaskList);var onTaskDoneTemplate=function(t){t.addEventListener("click",function(e){e.target.classList.contains("list-template__task-ready")&&(e.target.classList.toggle("list-template__task-ready--done"),e.target.nextElementSibling.classList.toggle("list-template__task-text--done"),e.target.parentElement.classList.toggle("list-template__task--done"),t.querySelector(".list-template__task-ready--done")?deleteIconTemplate.classList.add("delete-icon--show"):deleteIconTemplate.classList.remove("delete-icon--show"))})};onTaskDoneTemplate(templateList),deleteIconTemplate.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".list-template__task--done")),a=[],n=0;n<t.length;n++)a[n]=t[n].textContent,t[n].remove();console.dir(a);var l=[].slice.call(taskList.querySelectorAll(".task"));for(n=0;n<t.length;n++)for(var s=0;s<l.length;s++)l[s].textContent===t[n].textContent&&l[s].remove();deleteIconTemplate.classList.remove("delete-icon--show"),updateData()});var updateData=function(){for(var e=[].slice.call(taskList.querySelectorAll(".task")),t=[].slice.call(categoryList.querySelectorAll(".category__item")),a={},n=0;n<t.length;n++)a[t[n].id.slice(4)]=0;!function(e){var t,a;for(key in e)a=categoryList.querySelector("#cat_"+key+" .category__count"),0===(t=e[key])?a.innerText="Нет задач":1===t?a.innerText=t+" задача":2<=t&&t<=4?a.innerText=t+" задачи":5<=t&&t<=20&&(a.innerText=t+" задач")}(function(e,t){for(var a=0;a<e.length;a++)e[a].classList.contains("task--work")?t.work++:e[a].classList.contains("task--personal")?t.personal++:e[a].classList.contains("task--shopping")?t.shopping++:e[a].classList.contains("task--family")?t.family++:e[a].classList.contains("task--warning")&&t.warning++;return t}(e,a))};updateData();var createNewTask=function(){document.createElement("div").classList.add("new-task");var e=document.createElement("div"),t=document.createElement("button"),a=document.createElement("button");e.appendChild(t),e.appendChild(a);var n=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div"),r=document.createElement("input");l.appendChild(s),l.appendChild(r),n.appendChild(l)},createTask=function(e){var t=document.createElement("li");t.classList.add("new-task__item");var a=document.createElement("div");a.classList.add("new-task__ready");var n=document.createElement("input");return n.id="new-task-"+e,n.name="new-task",n.type="text",n.placeholder="Что нужно сделать ?",t.appendChild(a),t.appendChild(n),t},removeInput=function(e){e.target.value||e.target.remove()},inputNewTask=document.querySelector("#new-task-1"),itemTemplate=document.querySelector(".new-task__item input"),currentItem=1,appendInput=function(e){if(13===e.keyCode&&0==!e.target.value){var t=document.querySelector(".new-task__list");e.preventDefault(),currentItem=++currentItem;var a=createTask(currentItem);a.addEventListener("keydown",appendInput),t.appendChild(a),t.querySelector("#new-task-"+currentItem).focus(),e.target.removeEventListener("keydown",appendInput),e.preventDefault()}13===e.keyCode&&0==e.target.value&&e.preventDefault(),0==e.target.value&&8===e.keyCode&&(e.target.parentNode.previousElementSibling.lastElementChild.focus(),e.target.parentNode.remove())};itemTemplate.addEventListener("keydown",appendInput);var newTaskScreen=document.querySelector(".new-task"),firstInput=document.querySelector("#new-task-1"),taskBtnDone=document.querySelector(".new-task__btn--done"),taskBtnCancel=document.querySelector(".new-task__btn--cancel");firstInput.addEventListener("input",function(e){e.target.value?taskBtnDone.classList.remove("new-task__btn--hide"):taskBtnDone.classList.add("new-task__btn--hide")}),taskBtnCancel.addEventListener("click",function(e){e.preventDefault(),newTaskScreen.classList.add("new-task--hide")}),taskBtnDone.addEventListener("click",function(e){e.preventDefault();for(var t=newTaskScreen.querySelectorAll(".new-task__item input"),a=newTaskScreen.querySelector(".new-task__cat-item input:checked").value,n={},l=0;l<t.length;l++)t[l].value&&(n[t[l].value]=a);storage.data=JSON.stringify(n),newTaskScreen.classList.add("new-task--hide"),renderMainList(JSON.parse(storage.data)),updateData()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhc2stbWFyay1hbmltYXRlLmpzIl0sIm5hbWVzIjpbInRhc2tMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGVtcGxhdGVMaXN0IiwiZGVsZXRlSWNvbiIsImRlbGV0ZUljb25UZW1wbGF0ZSIsInRhc2tSZWFkeUFyciIsInNsaWNlIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwiZGF0YUxpc3QiLCLQndCw0YfQsNGC0Ywg0LTQtdC70LDRgtGMINC/0YDQtdC30LXQvdGC0LDRhtC40Y4iLCLQl9Cw0L/Qu9Cw0YLQuNGC0Ywg0LfQsCDQsNGA0LXQvdC00YMiLCLQmtGD0L/QuNGC0Ywg0LzQvtC70L7QutC+Iiwi0J3QtSDQt9Cw0LHRi9GC0Ywg0LfQsNCx0YDQsNGC0Ywg0JzQuNGI0YMg0YHQviDRiNC60L7Qu9GLIiwi0JrRg9C/0LjRgtGMINGI0L7QutC+0LvQsNC0INCc0LDRiNC1IiwiZGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZW5kZXJNYWluTGlzdCIsIm9iaiIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImtleSIsInRhc2tJdGVtIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInRhc2tJdGVtUmVhZHkiLCJhcHBlbmRDaGlsZCIsInRhc2tJdGVtVGV4dCIsInRleHRDb250ZW50IiwicGFyc2UiLCJkb25lTWFyayIsIm9uVGFza0RvbmUiLCJ3cmFwcGVyTm9kZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJ0b2dnbGUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwidGFza0RvbmVBcnIiLCJpIiwibGVuZ3RoIiwidXBkYXRlRGF0YSIsImZvcm1CdG4iLCJidG5MaXN0Iiwib3ZlcmxheSIsImxpc3RUZW1wbGF0ZSIsInRlbXBsYXRlVGl0aWxlIiwidGVtcGxhdGVDb3VudCIsInRlbXBsYXRlVGFza0xpc3QiLCJ0ZW1wbGF0ZUl0ZW0iLCJ0ZW1wbGF0ZVJlYWR5IiwidGVtcGxhdGVUZXh0IiwidGVtcGxhdGVEYXRlIiwiY2F0ZWdvcnlMaXN0IiwiY2FsbGJhY2siLCJ0YXJnIiwiZXZlbnQiLCJ0YWdOYW1lIiwiY29sb3JUYXJnZXQiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInRpdGxlVGFyZ2V0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpbm5lclRleHQiLCJjb3VudGVyVGFyZ2V0IiwibGFzdEVsZW1lbnRDaGlsZCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiaWRDYXRlZ29yeSIsImlkIiwidGVtcGxhdGVUYXNrQXJyIiwibmV3SXRlbSIsIm5ld0l0ZW1SZWFkeSIsIm5ld0l0ZW1UZXh0IiwibmV3SXRlbURhdGUiLCJpbm5lckhUTUwiLCJjcmVhdGVUYXNrRWxlbSIsIm9uVGFza0RvbmVUZW1wbGF0ZSIsInRleHRDb250ZW50QXJyIiwiY29uc29sZSIsImRpciIsInRhc2tzQXJyIiwiayIsImNhdGVnb3JpZXNBcnIiLCJjYXRlZ29yaWVzSWRPYmoiLCJjdXJyZW50VmFsdWVDb3VudGVyIiwicENvdW50ZXIiLCJjb21iaWVuZFRhc2tXb3JkcyIsImFycmF5Iiwid29yayIsInBlcnNvbmFsIiwic2hvcHBpbmciLCJmYW1pbHkiLCJ3YXJuaW5nIiwiY291bnRUYXNrcyIsImNyZWF0ZU5ld1Rhc2siLCJidG5XcmFwcGVyIiwiYnRuQ2FuY2VsIiwiYnRuRG9uZSIsIm5ld1Rhc2tMaXN0IiwibmV3VGFza0l0ZW0iLCJuZXdUYXNrRG9uZSIsIm5ld1Rhc2tJbnB1dCIsImNyZWF0ZVRhc2siLCJjdXJyZW50IiwibmV3TGkiLCJuZXdEaXYiLCJuZXdJbnB1dCIsIm5hbWUiLCJ0eXBlIiwicGxhY2Vob2xkZXIiLCJyZW1vdmVJbnB1dCIsInZhbHVlIiwiaW5wdXROZXdUYXNrIiwiaXRlbVRlbXBsYXRlIiwiY3VycmVudEl0ZW0iLCJhcHBlbmRJbnB1dCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsIm5ld0l0ZW1UZW1wbGF0ZSIsImZvY3VzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInBhcmVudE5vZGUiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwibmV3VGFza1NjcmVlbiIsImZpcnN0SW5wdXQiLCJ0YXNrQnRuRG9uZSIsInRhc2tCdG5DYW5jZWwiLCJhbGxOZXdJdGVtcyIsImNhdGVnb3J5TmFtZSIsImRhdGFOZXdMaXN0Il0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxTQUFXQyxTQUFTQyxjQUFjLGNBQ2xDQyxhQUFlRixTQUFTQyxjQUFjLDZCQUN0Q0UsV0FBYUgsU0FBU0MsY0FBYyxnQkFDcENHLG1CQUFxQkosU0FBU0MsY0FBYywwQkFDNUNJLGFBQWUsR0FBR0MsTUFBTUMsS0FBS1IsU0FBU1MsaUJBQWlCLGlCQUV2REMsUUFBVUMsYUFFVkMsU0FBVyxDQUNiQyw0QkFBNkIsT0FDN0JDLHNCQUF1QixXQUN2QkMsZ0JBQWlCLFdBQ2pCQyxrQ0FBbUMsU0FDbkNDLHNCQUF1QixZQUl6QlAsUUFBUVEsS0FBT0MsS0FBS0MsVUFBVVIsVUFTOUIsSUFBSVMsZUFBaUIsU0FBVUMsR0FDN0IsSUFBSUMsRUFBV3RCLFNBQVN1Qix5QkFFeEIsSUFBS0MsT0FBT0gsRUFBSyxDQUVmLElBQUlJLEVBQVd6QixTQUFTMEIsY0FBYyxPQUN0Q0QsRUFBU0UsVUFBVUMsSUFBSSxRQUN2QkgsRUFBU0UsVUFBVUMsSUFBSSxTQUFXUCxFQUFJRyxNQUV0QyxJQUFJSyxFQUFnQjdCLFNBQVMwQixjQUFjLE9BQzNDRyxFQUFjRixVQUFVQyxJQUFJLGVBQzVCSCxFQUFTSyxZQUFZRCxHQUVyQixJQUFJRSxFQUFlL0IsU0FBUzBCLGNBQWMsS0FDMUNLLEVBQWFKLFVBQVVDLElBQUksY0FDM0JHLEVBQWFDLFlBQWNSLElBQzNCQyxFQUFTSyxZQUFZQyxHQUVyQlQsRUFBU1EsWUFBWUwsR0FHdkIxQixTQUFTK0IsWUFBWVIsSUFJdkJGLGVBQWVGLEtBQUtlLE1BQU14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dGFzay1tYXJrLWFuaW1hdGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFzay1saXN0Jyk7XHJcbnZhciB0ZW1wbGF0ZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGFzay1saXN0Jyk7XHJcbnZhciBkZWxldGVJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlbGV0ZS1pY29uJyk7XHJcbnZhciBkZWxldGVJY29uVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGVsZXRlLWljb24tLXRlbXBsYXRlJyk7XHJcbnZhciB0YXNrUmVhZHlBcnIgPSBbXS5zbGljZS5jYWxsKHRhc2tMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrX19yZWFkeScpKTtcclxuXHJcbnZhciBzdG9yYWdlID0gbG9jYWxTdG9yYWdlO1xyXG5cclxudmFyIGRhdGFMaXN0ID0ge1xyXG4gIFwi0J3QsNGH0LDRgtGMINC00LXQu9Cw0YLRjCDQv9GA0LXQt9C10L3RgtCw0YbQuNGOXCI6IFwid29ya1wiLFxyXG4gIFwi0JfQsNC/0LvQsNGC0LjRgtGMINC30LAg0LDRgNC10L3QtNGDXCI6IFwicGVyc29uYWxcIixcclxuICBcItCa0YPQv9C40YLRjCDQvNC+0LvQvtC60L5cIjogXCJzaG9wcGluZ1wiLFxyXG4gIFwi0J3QtSDQt9Cw0LHRi9GC0Ywg0LfQsNCx0YDQsNGC0Ywg0JzQuNGI0YMg0YHQviDRiNC60L7Qu9GLXCI6IFwiZmFtaWx5XCIsXHJcbiAgXCLQmtGD0L/QuNGC0Ywg0YjQvtC60L7Qu9Cw0LQg0JzQsNGI0LVcIjogXCJzaG9wcGluZ1wiXHJcblxyXG59O1xyXG5cclxuc3RvcmFnZS5kYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YUxpc3QpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vLyDQpNCe0KDQnNCY0KDQntCS0JDQndCY0JUg0KHQotCQ0KDQotCe0JLQntCT0J4g0KHQn9CY0KHQmtCQXHJcblxyXG52YXIgcmVuZGVyTWFpbkxpc3QgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICBmb3IgKGtleSBpbiBvYmopIHtcclxuXHJcbiAgICB2YXIgdGFza0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRhc2tJdGVtLmNsYXNzTGlzdC5hZGQoJ3Rhc2snKTtcclxuICAgIHRhc2tJdGVtLmNsYXNzTGlzdC5hZGQoJ3Rhc2stLScgKyBvYmpba2V5XSk7XHJcblxyXG4gICAgdmFyIHRhc2tJdGVtUmVhZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRhc2tJdGVtUmVhZHkuY2xhc3NMaXN0LmFkZCgndGFza19fcmVhZHknKTtcclxuICAgIHRhc2tJdGVtLmFwcGVuZENoaWxkKHRhc2tJdGVtUmVhZHkpO1xyXG5cclxuICAgIHZhciB0YXNrSXRlbVRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICB0YXNrSXRlbVRleHQuY2xhc3NMaXN0LmFkZCgndGFza19fdGV4dCcpO1xyXG4gICAgdGFza0l0ZW1UZXh0LnRleHRDb250ZW50ID0ga2V5O1xyXG4gICAgdGFza0l0ZW0uYXBwZW5kQ2hpbGQodGFza0l0ZW1UZXh0KTtcclxuXHJcbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0YXNrSXRlbSk7XHJcbiAgfVxyXG5cclxuICB0YXNrTGlzdC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XHJcblxyXG59O1xyXG5cclxucmVuZGVyTWFpbkxpc3QoSlNPTi5wYXJzZShzdG9yYWdlLmRhdGEpKTtcclxuXHJcblxyXG5cclxuXHJcbi8vINCT0JDQm9Ce0KfQmtCQINCYINCX0JDQp9CV0KDQmtCY0JLQkNCd0JjQlSDQotCQ0KHQmtCQXHJcblxyXG52YXIgZG9uZU1hcmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFza19fcmVhZHktLWRvbmUnKTtcclxuXHJcbmlmIChkb25lTWFyaykge1xyXG4gIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZCgnZGVsZXRlLWljb24tLXNob3cnKTtcclxufVxyXG5cclxuXHJcbnZhciBvblRhc2tEb25lID0gZnVuY3Rpb24gKHdyYXBwZXJOb2RlKSB7XHJcblxyXG4gIHdyYXBwZXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcblxyXG4gICAgLy8g0KPRgdGC0LDQvdC+0LLQutCwINC60LDQu9C+0YfQutC4INGC0LDRgdC60LBcclxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2tfX3JlYWR5JykpIHtcclxuICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgndGFza19fcmVhZHktLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ3Rhc2tfX3RleHQtLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCd0YXNrLS1kb25lJyk7XHJcblxyXG4gICAgICAvLyDQn9C+0Y/QstC70LXQvdC40LUg0LrQvtGA0LfQuNC90LrQuCDQv9GA0Lgg0LLRi9Cx0L7RgNC1INGC0LDRgdC60LBcclxuICAgICAgdmFyIGRvbmVNYXJrID0gd3JhcHBlck5vZGUucXVlcnlTZWxlY3RvcignLnRhc2tfX3JlYWR5LS1kb25lJyk7XHJcblxyXG4gICAgICBpZiAoZG9uZU1hcmspIHtcclxuICAgICAgICBkZWxldGVJY29uLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xyXG4gICAgICB9XHJcbiAgICB9IFxyXG4gICAgXHJcbiAgfSk7XHJcbn1cclxuXHJcbm9uVGFza0RvbmUodGFza0xpc3QpO1xyXG4vLyBcclxuLy8gXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8g0KPQlNCQ0JvQldCd0JjQlSDQotCQ0KHQmtCQXHJcblxyXG5cclxuZGVsZXRlSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgdmFyIHRhc2tEb25lQXJyID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay0tZG9uZScpKTtcclxuXHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXNrRG9uZUFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgdGFza0RvbmVBcnJbaV0ucmVtb3ZlKCk7XHJcbiAgICBcclxuICB9XHJcblxyXG4gIGRlbGV0ZUljb24uY2xhc3NMaXN0LnJlbW92ZSgnZGVsZXRlLWljb24tLXNob3cnKTtcclxuXHJcbiAgdXBkYXRlRGF0YSgpO1xyXG5cclxufSk7XHJcblxyXG4vLyBcclxuLy8gXHJcblxyXG5cclxuLy8gYnRuLXBsdXNcclxuXHJcbnZhciBmb3JtQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2J0bicpO1xyXG52YXIgYnRuTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGVfX2l0ZW1zJyk7XHJcbnZhciBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKTtcclxuXHJcbmZvcm1CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICBmb3JtQnRuLmNsYXNzTGlzdC50b2dnbGUoJ2Zvcm1fX2J0bi0tYWN0aXZlJyk7XHJcbiAgYnRuTGlzdC5jbGFzc0xpc3QudG9nZ2xlKCdjcmVhdGVfX2l0ZW1zLS1hY3RpdmUnKTtcclxuICBvdmVybGF5LmNsYXNzTGlzdC50b2dnbGUoJ292ZXJsYXktLWFjdGl2ZScpO1xyXG59KTtcclxuLy8gXHJcbi8vIFxyXG5cclxuXHJcblxyXG4vLyBsaXN0LXRlbXBsYXRlXHJcblxyXG4vLyDQodCe0JfQlNCQ0J3QmNCVINCX0JDQk9Ce0JvQntCS0JrQkCDQmCDQptCS0JXQotCQINCa0JDQoNCi0J7Qp9Ca0JhcclxudmFyIGxpc3RUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlJyk7XHJcbnZhciB0ZW1wbGF0ZVRpdGlsZSA9IGxpc3RUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGl0bGUnKTtcclxudmFyIHRlbXBsYXRlQ291bnQgPSBsaXN0VGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX2NvdW50Jyk7XHJcblxyXG4vLyB0ZW1wbGF0ZS1saXN0XHJcbnZhciB0ZW1wbGF0ZVRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stbGlzdCcpO1xyXG52YXIgdGVtcGxhdGVJdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stLXRlbXBsYXRlJyk7XHJcbnZhciB0ZW1wbGF0ZVJlYWR5ID0gdGVtcGxhdGVJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190YXNrLXJlYWR5Jyk7XHJcbnZhciB0ZW1wbGF0ZVRleHQgPSB0ZW1wbGF0ZUl0ZW0ucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dCcpO1xyXG52YXIgdGVtcGxhdGVEYXRlID0gdGVtcGxhdGVJdGVtLnF1ZXJ5U2VsZWN0b3IoJ3Rhc2tfX2RhdGUnKTtcclxuXHJcblxyXG52YXIgY2F0ZWdvcnlMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhdGVnb3J5X19saXN0Jyk7XHJcblxyXG5cclxuXHJcblxyXG5cclxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oZSl7XHJcbiAgdmFyIHRhcmcgPSBlLnRhcmdldDtcclxuXHJcbiAgLy8g0YTQuNC60YEg0LLRi9Cx0L7RgNCwINC60LDRgNGC0L7Rh9C60LhcclxuICBpZiAoZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQudGFnTmFtZSA9PT0gJ0xJJykge1xyXG4gICB0YXJnID0gZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQ7XHJcbiAgfVxyXG4gIFxyXG5cclxuXHJcblxyXG4gIC8vINC/0L7Qu9GD0YfQuNC8INGG0LLQtdGCLCDQt9Cw0LPQvtC70L7QstC+0LosINGB0YfQtdGC0YfQuNC6INC60LDRgtC10LPQvtGA0LjQuFxyXG4gIHZhciBjb2xvclRhcmdldCA9IGdldENvbXB1dGVkU3R5bGUodGFyZykuZ2V0UHJvcGVydHlWYWx1ZSgnYmFja2dyb3VuZC1jb2xvcicpO1xyXG4gIHZhciB0aXRsZVRhcmdldCA9IHRhcmcuZmlyc3RFbGVtZW50Q2hpbGQuaW5uZXJUZXh0O1xyXG4gIHZhciBjb3VudGVyVGFyZ2V0ID0gdGFyZy5sYXN0RWxlbWVudENoaWxkLmlubmVyVGV4dDtcclxuXHJcblxyXG4gIC8v0LfQsNC00LDQtNC40Lwg0YbQstC10YIsINC30LDQs9C+0LvQvtCy0L7Quiwg0YHRh9C10YLRh9C40Log0LrQsNGA0YLQvtGH0LrQuFxyXG4gIGxpc3RUZW1wbGF0ZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclRhcmdldDtcclxuICB0ZW1wbGF0ZVRpdGlsZS50ZXh0Q29udGVudCA9ICB0aXRsZVRhcmdldDtcclxuICB0ZW1wbGF0ZUNvdW50LnRleHRDb250ZW50ID0gY291bnRlclRhcmdldDtcclxuXHJcblxyXG5cclxuICAvLyBcclxuICAvLyBcclxuXHJcbiAgLy8g0YHQvtCx0LXRgNC10Lwg0YHQv9C40YHQvtC6INC30LDQtNCw0YdcclxuICB2YXIgaWRDYXRlZ29yeSA9IHRhcmcuaWQuc2xpY2UoNCk7XHJcblxyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVUYXNrRWxlbSgpIHtcclxuXHJcbiAgICB2YXIgdGVtcGxhdGVUYXNrQXJyID0gW10uc2xpY2UuY2FsbCh0YXNrTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay0tJyArIGlkQ2F0ZWdvcnkpKTtcclxuXHJcbiAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICBcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRlbXBsYXRlVGFza0Fyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICB2YXIgbmV3SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICBuZXdJdGVtLmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2snKTtcclxuICAgICAgbmV3SXRlbS5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrLS10ZW1wbGF0ZScpO1xyXG5cclxuICAgICAgdmFyIG5ld0l0ZW1SZWFkeSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICBuZXdJdGVtUmVhZHkuY2xhc3NMaXN0LmFkZCgnbGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeScpO1xyXG4gICAgICBuZXdJdGVtLmFwcGVuZENoaWxkKG5ld0l0ZW1SZWFkeSk7XHJcblxyXG4gICAgICB2YXIgbmV3SXRlbVRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICAgIG5ld0l0ZW1UZXh0LmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dCcpO1xyXG4gICAgICBuZXdJdGVtLmFwcGVuZENoaWxkKG5ld0l0ZW1UZXh0KTtcclxuXHJcbiAgICAgIHZhciBuZXdJdGVtRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgbmV3SXRlbURhdGUuY2xhc3NMaXN0LmFkZCgnbGlzdC10ZW1wbGF0ZV9fdGFzay1kYXRlJyk7XHJcbiAgICAgIG5ld0l0ZW0uYXBwZW5kQ2hpbGQobmV3SXRlbURhdGUpO1xyXG4gICAgICBuZXdJdGVtVGV4dC50ZXh0Q29udGVudCA9IHRlbXBsYXRlVGFza0FycltpXS50ZXh0Q29udGVudDtcclxuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobmV3SXRlbSk7XHJcbiAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0ZW1wbGF0ZVRhc2tMaXN0LmlubmVySFRNTD0gJyc7XHJcbiAgICB0ZW1wbGF0ZVRhc2tMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcclxuICB9XHJcblxyXG5cclxuICBjcmVhdGVUYXNrRWxlbSgpO1xyXG4gIFxyXG5cclxuICBcclxufTtcclxuXHJcbmNhdGVnb3J5TGlzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNhbGxiYWNrKTtcclxuXHJcbm9uVGFza0RvbmUodGVtcGxhdGVUYXNrTGlzdCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vINCT0LDQu9C+0YfQutCwINC4INC/0L7Rj9Cy0LvQtdC90LjQtSDQutC+0YDQt9C40L3QutC4INCyINC60LDRgNGC0L7Rh9C60LVcclxuXHJcbnZhciBvblRhc2tEb25lVGVtcGxhdGUgPSBmdW5jdGlvbiAod3JhcHBlck5vZGUpIHtcclxuXHJcbiAgd3JhcHBlck5vZGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuXHJcbiAgICAvLyDQo9GB0YLQsNC90L7QstC60LAg0LrQsNC70L7Rh9C60Lgg0YLQsNGB0LrQsFxyXG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeScpKSB7XHJcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stcmVhZHktLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dC0tZG9uZScpO1xyXG4gICAgICBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stLWRvbmUnKTtcclxuXHJcbiAgICAgIC8vINCf0L7Rj9Cy0LvQtdC90LjQtSDQutC+0YDQt9C40L3QutC4INC/0YDQuCDQstGL0LHQvtGA0LUg0YLQsNGB0LrQsFxyXG4gICAgICB2YXIgZG9uZU1hcmsgPSB3cmFwcGVyTm9kZS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeS0tZG9uZScpO1xyXG5cclxuICAgICAgaWYgKGRvbmVNYXJrKSB7XHJcbiAgICAgICAgZGVsZXRlSWNvblRlbXBsYXRlLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVsZXRlSWNvblRlbXBsYXRlLmNsYXNzTGlzdC5yZW1vdmUoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XHJcbiAgICAgIH1cclxuICAgIH0gXHJcbiAgICBcclxuICB9KTtcclxufVxyXG5cclxub25UYXNrRG9uZVRlbXBsYXRlKHRlbXBsYXRlTGlzdCk7XHJcblxyXG4vLyDQo9CU0JDQm9CV0J3QmNCVINCi0JDQodCa0JAg0JIg0JrQkNCg0KLQntCn0JrQlVxyXG5cclxuZGVsZXRlSWNvblRlbXBsYXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICB2YXIgdGFza0RvbmVBcnIgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saXN0LXRlbXBsYXRlX190YXNrLS1kb25lJykpO1xyXG5cclxuICB2YXIgdGV4dENvbnRlbnRBcnIgPSBbXTtcclxuICBcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tEb25lQXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICB0ZXh0Q29udGVudEFycltpXSA9IHRhc2tEb25lQXJyW2ldLnRleHRDb250ZW50O1xyXG4gICAgdGFza0RvbmVBcnJbaV0ucmVtb3ZlKCk7XHJcbiAgICBcclxuICB9XHJcblxyXG4gIGNvbnNvbGUuZGlyKHRleHRDb250ZW50QXJyKTtcclxuXHJcblxyXG5cclxuICB2YXIgdGFza3NBcnIgPSBbXS5zbGljZS5jYWxsKHRhc2tMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrJykpO1xyXG5cclxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tEb25lQXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBcclxuXHJcbiAgICBmb3IgKHZhciBrID0gMDsgayA8IHRhc2tzQXJyLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgIGlmICh0YXNrc0FycltrXS50ZXh0Q29udGVudCA9PT0gdGFza0RvbmVBcnJbaV0udGV4dENvbnRlbnQpIHtcclxuICAgICAgICB0YXNrc0FycltrXS5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgIH1cclxuICAgIFxyXG4gIH1cclxuXHJcblxyXG5cclxuICBkZWxldGVJY29uVGVtcGxhdGUuY2xhc3NMaXN0LnJlbW92ZSgnZGVsZXRlLWljb24tLXNob3cnKTtcclxuXHJcblxyXG4gIHVwZGF0ZURhdGEoKTtcclxuXHJcbn0pO1xyXG5cclxuXHJcbi8vINCa0J7Qm9CY0KfQldCh0KLQktCeINCX0JDQlNCQ0KdcclxuIFxyXG5cclxuXHJcbnZhciB1cGRhdGVEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gIC8vINGB0L7QsdC10YDQtdC8INC4INGB0LPRgNGD0L/QuNGA0YPQtdC8INGC0LDRgdC60Lgg0L/QviDQutCw0YLQtdCz0L7RgNC40Y/QvCDQsiDQvtCx0YzQtdC60YJcclxuXHJcbiAgdmFyIHRhc2tzQXJyID0gW10uc2xpY2UuY2FsbCh0YXNrTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzaycpKTtcclxuXHJcbiAgdmFyIGNhdGVnb3JpZXNBcnIgPSBbXS5zbGljZS5jYWxsKGNhdGVnb3J5TGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuY2F0ZWdvcnlfX2l0ZW0nKSk7XHJcblxyXG4gIHZhciBjYXRlZ29yaWVzSWRPYmogPSB7fTtcclxuICBcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IGNhdGVnb3JpZXNBcnIubGVuZ3RoOyBpKyspIHtcclxuICAgIGNhdGVnb3JpZXNJZE9ialtjYXRlZ29yaWVzQXJyW2ldLmlkLnNsaWNlKDQpXSA9IDA7XHJcbiAgfVxyXG4gIFxyXG5cclxuICBcclxuICBcclxuICBcclxuICAvLyBcclxuXHJcbiAgLy8g0J/QntCU0KHQp9CV0KIg0KLQkNCh0JrQntCSINCf0J4g0JrQkNCi0JXQk9Ce0KDQmNCv0JxcclxuXHJcbiAgdmFyIGNvdW50VGFza3MgPSBmdW5jdGlvbiAoYXJyYXksIG9iaikge1xyXG4gICAgXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICBcclxuICAgICAgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0td29yaycpKSB7XHJcbiAgICAgICAgb2JqLndvcmsrKztcclxuICAgICAgfSBlbHNlIGlmIChhcnJheVtpXS5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2stLXBlcnNvbmFsJykpe1xyXG4gICAgICAgIG9iai5wZXJzb25hbCsrO1xyXG4gICAgICB9IGVsc2UgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0tc2hvcHBpbmcnKSl7XHJcbiAgICAgICAgb2JqLnNob3BwaW5nKys7XHJcbiAgICAgIH0gZWxzZSBpZiAoYXJyYXlbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLS1mYW1pbHknKSl7XHJcbiAgICAgICAgb2JqLmZhbWlseSsrO1xyXG4gICAgICB9IGVsc2UgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0td2FybmluZycpKXtcclxuICAgICAgICBvYmoud2FybmluZysrO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9iajtcclxuICB9XHJcblxyXG5cclxuICBcclxuXHJcbiAgdmFyIHJlc3VsID0gY291bnRUYXNrcyh0YXNrc0FyciwgY2F0ZWdvcmllc0lkT2JqKTtcclxuICBcclxuICAvLyBcclxuXHJcbiAgLy8g0J7QmtCe0J3Qp9CQ0J3QmNCVINCh0JvQntCS0JAgXCLQl9CQ0JTQkNCn0JBcIlxyXG5cclxuICB2YXIgY29tYmllbmRUYXNrV29yZHMgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICBcclxuICAgIHZhciBjdXJyZW50VmFsdWVDb3VudGVyO1xyXG4gICAgdmFyIHBDb3VudGVyO1xyXG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XHJcbiAgICAgIHBDb3VudGVyID0gY2F0ZWdvcnlMaXN0LnF1ZXJ5U2VsZWN0b3IoJyNjYXRfJyArIGtleSArICcgLmNhdGVnb3J5X19jb3VudCcpO1xyXG4gICAgICBjdXJyZW50VmFsdWVDb3VudGVyID0gb2JqW2tleV0gO1xyXG4gICAgICBpZiAoY3VycmVudFZhbHVlQ291bnRlciA9PT0gMCkge1xyXG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9ICfQndC10YIg0LfQsNC00LDRhyc7XHJcbiAgICAgIH0gZWxzZSBpZihjdXJyZW50VmFsdWVDb3VudGVyID09PSAxKXtcclxuICAgICAgICBwQ291bnRlci5pbm5lclRleHQgPSBjdXJyZW50VmFsdWVDb3VudGVyICsgJyDQt9Cw0LTQsNGH0LAnO1xyXG4gICAgICB9IGVsc2UgaWYoY3VycmVudFZhbHVlQ291bnRlciA+PSAyICYmIGN1cnJlbnRWYWx1ZUNvdW50ZXIgPD0gNCl7XHJcbiAgICAgICAgcENvdW50ZXIuaW5uZXJUZXh0ID0gY3VycmVudFZhbHVlQ291bnRlciArICcg0LfQsNC00LDRh9C4JztcclxuICAgICAgfSBlbHNlIGlmIChjdXJyZW50VmFsdWVDb3VudGVyID49IDUgJiYgY3VycmVudFZhbHVlQ291bnRlciA8PSAyMCkge1xyXG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9IGN1cnJlbnRWYWx1ZUNvdW50ZXIgKyAnINC30LDQtNCw0YcnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgY29tYmllbmRUYXNrV29yZHMocmVzdWwpO1xyXG5cclxufVxyXG5cclxudXBkYXRlRGF0YSgpO1xyXG4gIFxyXG4gIFxyXG4vLyDQntCi0KDQmNCh0J7QktCa0JAg0J7QmtCd0JAg0J3QntCS0J7Qk9CeINCi0JDQodCa0JAgXHJcblxyXG52YXIgY3JlYXRlTmV3VGFzayA9IGZ1bmN0aW9uKCkge1xyXG5cclxuLy8g0L7QutC90L5cclxuICB2YXIgbmV3VGFza1dpbmRvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIG5ld1Rhc2tXaW5kb3cuY2xhc3NMaXN0LmFkZCgnbmV3LXRhc2snKTtcclxuXHJcbi8vINC60L3QvtC/0LrQuCDQvtGC0LzQtdC90LAg0Lgg0LPQvtGC0L7QstC+IFxyXG4gIHZhciBidG5XcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgdmFyIGJ0bkNhbmNlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gIHZhciBidG5Eb25lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcblxyXG4gIGJ0bldyYXBwZXIuYXBwZW5kQ2hpbGQoYnRuQ2FuY2VsKTtcclxuICBidG5XcmFwcGVyLmFwcGVuZENoaWxkKGJ0bkRvbmUpO1xyXG5cclxuLy8g0YHQv9C40YHQvtC6LdC+0LHQtdGA0YLQutCwINC4INC+0LTQuNC9INGC0LDRgdC6XHJcbiAgdmFyIG5ld1Rhc2tMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgdmFyIG5ld1Rhc2tJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgdmFyIG5ld1Rhc2tEb25lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgdmFyIG5ld1Rhc2tJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcblxyXG4gIG5ld1Rhc2tJdGVtLmFwcGVuZENoaWxkKG5ld1Rhc2tEb25lKTtcclxuICBuZXdUYXNrSXRlbS5hcHBlbmRDaGlsZChuZXdUYXNrSW5wdXQpO1xyXG4gIG5ld1Rhc2tMaXN0LmFwcGVuZENoaWxkKG5ld1Rhc2tJdGVtKTtcclxufVxyXG5cclxuXHJcblxyXG4vLyDQodCe0JfQlNCQ0J3QmNCVINCd0J7QktCe0JPQniDQmNCd0J/Qo9Ci0JAg0JTQm9CvINCX0JDQn9CY0KHQmFxyXG5cclxudmFyIGNyZWF0ZVRhc2sgPSBmdW5jdGlvbihjdXJyZW50KSB7XHJcblxyXG4gIHZhciBuZXdMaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgbmV3TGkuY2xhc3NMaXN0LmFkZCgnbmV3LXRhc2tfX2l0ZW0nKTtcclxuICB2YXIgbmV3RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgbmV3RGl2LmNsYXNzTGlzdC5hZGQoJ25ldy10YXNrX19yZWFkeScpO1xyXG4gIHZhciBuZXdJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgbmV3SW5wdXQuaWQgPSAnbmV3LXRhc2stJyArIGN1cnJlbnQ7XHJcbiAgbmV3SW5wdXQubmFtZSA9ICduZXctdGFzayc7XHJcbiAgbmV3SW5wdXQudHlwZSA9ICd0ZXh0JztcclxuICBuZXdJbnB1dC5wbGFjZWhvbGRlciA9ICfQp9GC0L4g0L3Rg9C20L3QviDRgdC00LXQu9Cw0YLRjCA/JztcclxuICBuZXdMaS5hcHBlbmRDaGlsZChuZXdEaXYpO1xyXG4gIG5ld0xpLmFwcGVuZENoaWxkKG5ld0lucHV0KTtcclxuXHJcbiAgcmV0dXJuIG5ld0xpO1xyXG5cclxufTtcclxuXHJcbi8vIFxyXG4vLyBcclxuXHJcbnZhciByZW1vdmVJbnB1dCA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgaWYgKCFlLnRhcmdldC52YWx1ZSkge1xyXG4gICAgZS50YXJnZXQucmVtb3ZlKCk7XHJcbiAgfVxyXG59XHJcblxyXG52YXIgaW5wdXROZXdUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ldy10YXNrLTEnKTtcclxudmFyIGl0ZW1UZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19faXRlbSBpbnB1dCcpO1xyXG52YXIgY3VycmVudEl0ZW0gPSAxO1xyXG5cclxudmFyIGFwcGVuZElucHV0ID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIGlmIChlLmtleUNvZGUgPT09IDEzICYmICFlLnRhcmdldC52YWx1ZSA9PSAwICkge1xyXG4gICAgICB2YXIgbmV3VGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LXRhc2tfX2xpc3QnKTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjdXJyZW50SXRlbSA9ICsrY3VycmVudEl0ZW07XHJcbiAgICAgIHZhciBuZXdJdGVtVGVtcGxhdGUgPSBjcmVhdGVUYXNrKGN1cnJlbnRJdGVtKTtcclxuICAgICAgXHJcbiAgICAgIG5ld0l0ZW1UZW1wbGF0ZS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgYXBwZW5kSW5wdXQpO1xyXG4gICAgICBuZXdUYXNrTGlzdC5hcHBlbmRDaGlsZChuZXdJdGVtVGVtcGxhdGUpO1xyXG4gICAgICB2YXIgdGFiSXRlbW0gPSBuZXdUYXNrTGlzdC5xdWVyeVNlbGVjdG9yKCcjbmV3LXRhc2stJyArIGN1cnJlbnRJdGVtKTtcclxuICAgICAgdGFiSXRlbW0uZm9jdXMoKTtcclxuICAgICAgZS50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFwcGVuZElucHV0KTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChlLmtleUNvZGUgPT09IDEzICYmIGUudGFyZ2V0LnZhbHVlID09IDAgKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgaWYgKGUudGFyZ2V0LnZhbHVlID09IDAgJiYgZS5rZXlDb2RlID09PSA4KSB7XHJcbiAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucHJldmlvdXNFbGVtZW50U2libGluZy5sYXN0RWxlbWVudENoaWxkLmZvY3VzKCk7XHJcbiAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5pdGVtVGVtcGxhdGUuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFwcGVuZElucHV0KTtcclxuXHJcbi8vXHJcblxyXG52YXIgbmV3VGFza1NjcmVlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFzaycpO1xyXG52YXIgZmlyc3RJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuZXctdGFzay0xJyk7XHJcbnZhciB0YXNrQnRuRG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19fYnRuLS1kb25lJyk7XHJcbnZhciB0YXNrQnRuQ2FuY2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy10YXNrX19idG4tLWNhbmNlbCcpO1xyXG5cclxuLy/Qn9Ce0K/QktCb0JXQndCY0JUg0Jgg0KHQmtCg0KvQotCY0JUg0JrQndCe0J/QmtCYIFwi0JPQntCi0J7QktCeXCJcclxuXHJcbmZpcnN0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoZSkge1xyXG4gIGlmIChlLnRhcmdldC52YWx1ZSkge1xyXG4gICAgdGFza0J0bkRvbmUuY2xhc3NMaXN0LnJlbW92ZSgnbmV3LXRhc2tfX2J0bi0taGlkZScpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0YXNrQnRuRG9uZS5jbGFzc0xpc3QuYWRkKCduZXctdGFza19fYnRuLS1oaWRlJyk7XHJcbiAgfVxyXG59KTtcclxuXHJcblxyXG50YXNrQnRuQ2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgbmV3VGFza1NjcmVlbi5jbGFzc0xpc3QuYWRkKCduZXctdGFzay0taGlkZScpO1xyXG59KTtcclxuXHJcblxyXG5cclxudGFza0J0bkRvbmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTsgIFxyXG5cclxuICB2YXIgYWxsTmV3SXRlbXMgPSBuZXdUYXNrU2NyZWVuLnF1ZXJ5U2VsZWN0b3JBbGwoJy5uZXctdGFza19faXRlbSBpbnB1dCcpO1xyXG4gIHZhciBjdXJyZW50Q2F0ZWdvcnkgPSBuZXdUYXNrU2NyZWVuLnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19fY2F0LWl0ZW0gaW5wdXQ6Y2hlY2tlZCcpO1xyXG4gIHZhciBjYXRlZ29yeU5hbWUgPSBjdXJyZW50Q2F0ZWdvcnkudmFsdWU7XHJcbiAgdmFyIGRhdGFOZXdMaXN0ID0ge307XHJcblxyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsTmV3SXRlbXMubGVuZ3RoOyBpKyspIHtcclxuICAgIGlmIChhbGxOZXdJdGVtc1tpXS52YWx1ZSkge1xyXG4gICAgICBkYXRhTmV3TGlzdFthbGxOZXdJdGVtc1tpXS52YWx1ZV0gPSBjYXRlZ29yeU5hbWU7XHJcbiAgICB9XHJcbiAgICBcclxuICB9XHJcbiBcclxuICBzdG9yYWdlLmRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhTmV3TGlzdCk7XHJcbiAgbmV3VGFza1NjcmVlbi5jbGFzc0xpc3QuYWRkKCduZXctdGFzay0taGlkZScpO1xyXG4gIHJlbmRlck1haW5MaXN0KEpTT04ucGFyc2Uoc3RvcmFnZS5kYXRhKSk7XHJcbiAgdXBkYXRlRGF0YSgpO1xyXG59KTsiXX0=
