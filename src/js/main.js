var taskList=document.querySelector(".task-list"),templateList=document.querySelector(".list-template__task-list"),deleteIcon=document.querySelector(".delete-icon"),deleteIconTemplate=document.querySelector(".delete-icon--template"),taskReadyArr=[].slice.call(taskList.querySelectorAll(".task__ready")),doneMark=document.querySelector(".task__ready--done");doneMark&&deleteIcon.classList.add("delete-icon--show");var onTaskDone=function(t){t.addEventListener("click",function(e){e.target.classList.contains("task__ready")&&(e.target.classList.toggle("task__ready--done"),e.target.nextElementSibling.classList.toggle("task__text--done"),e.target.parentElement.classList.toggle("task--done"),t.querySelector(".task__ready--done")?deleteIcon.classList.add("delete-icon--show"):deleteIcon.classList.remove("delete-icon--show"))})};onTaskDone(taskList),deleteIcon.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".task--done")),a=0;a<t.length;a++)t[a].remove();deleteIcon.classList.remove("delete-icon--show"),updateData()});var formBtn=document.querySelector(".form__btn"),btnList=document.querySelector(".create__items"),overlay=document.querySelector(".overlay");formBtn.addEventListener("click",function(e){formBtn.classList.toggle("form__btn--active"),btnList.classList.toggle("create__items--active"),overlay.classList.toggle("overlay--active")});var listTemplate=document.querySelector(".list-template"),templateTitile=listTemplate.querySelector(".list-template__title"),templateCount=listTemplate.querySelector(".list-template__count"),templateTaskList=document.querySelector(".list-template__task-list"),templateItem=document.querySelector(".list-template__task--template"),templateReady=templateItem.querySelector(".list-template__task-ready"),templateText=templateItem.querySelector(".list-template__task-text"),templateDate=templateItem.querySelector("task__date"),categoryList=document.querySelector(".category__list"),callback=function(e){var t=e.target;"LI"===event.target.parentElement.tagName&&(t=event.target.parentElement);var a=getComputedStyle(t).getPropertyValue("background-color"),n=t.firstElementChild.innerText,l=t.lastElementChild.innerText;listTemplate.style.backgroundColor=a,templateTitile.textContent=n,templateCount.textContent=l;var o=t.id.slice(4);!function(){for(var e=[].slice.call(taskList.querySelectorAll(".task--"+o)),t=document.createDocumentFragment(),a=0;a<e.length;a++){var n=document.createElement("div");n.classList.add("list-template__task"),n.classList.add("list-template__task--template");var l=document.createElement("div");l.classList.add("list-template__task-ready"),n.appendChild(l);var s=document.createElement("p");s.classList.add("list-template__task-text"),n.appendChild(s);var r=document.createElement("span");r.classList.add("list-template__task-date"),n.appendChild(r),s.textContent=e[a].textContent,t.appendChild(n)}templateTaskList.innerHTML="",templateTaskList.appendChild(t)}()};categoryList.addEventListener("click",callback),onTaskDone(templateTaskList);var onTaskDoneTemplate=function(t){t.addEventListener("click",function(e){e.target.classList.contains("list-template__task-ready")&&(e.target.classList.toggle("list-template__task-ready--done"),e.target.nextElementSibling.classList.toggle("list-template__task-text--done"),e.target.parentElement.classList.toggle("list-template__task--done"),t.querySelector(".list-template__task-ready--done")?deleteIconTemplate.classList.add("delete-icon--show"):deleteIconTemplate.classList.remove("delete-icon--show"))})};onTaskDoneTemplate(templateList),deleteIconTemplate.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".list-template__task--done")),a=[],n=0;n<t.length;n++)a[n]=t[n].textContent,t[n].remove();console.dir(a);var l=[].slice.call(taskList.querySelectorAll(".task"));for(n=0;n<t.length;n++)for(var s=0;s<l.length;s++)l[s].textContent===t[n].textContent&&l[s].remove();deleteIconTemplate.classList.remove("delete-icon--show"),updateData()});var updateData=function(){for(var e=[].slice.call(taskList.querySelectorAll(".task")),t=[].slice.call(categoryList.querySelectorAll(".category__item")),a={},n=0;n<t.length;n++)a[t[n].id.slice(4)]=0;!function(e){var t,a;for(key in e)a=categoryList.querySelector("#cat_"+key+" .category__count"),0===(t=e[key])?a.innerText="Нет задач":1===t?a.innerText=t+" задача":2<=t&&t<=4?a.innerText=t+" задачи":5<=t&&t<=20&&(a.innerText=t+" задач")}(function(e,t){for(var a=0;a<e.length;a++)e[a].classList.contains("task--work")?t.work++:e[a].classList.contains("task--personal")?t.personal++:e[a].classList.contains("task--shopping")?t.shopping++:e[a].classList.contains("task--family")?t.family++:e[a].classList.contains("task--warning")&&t.warning++;return t}(e,a))};updateData();var createNewTask=function(){document.createElement("div").classList.add("new-task");var e=document.createElement("div"),t=document.createElement("button"),a=document.createElement("button");e.appendChild(t),e.appendChild(a);var n=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div"),r=document.createElement("input");l.appendChild(s),l.appendChild(r),n.appendChild(l)},createTask=function(e){var t=document.createElement("li");t.classList.add("new-task__item");var a=document.createElement("div");a.classList.add("new-task__ready");var n=document.createElement("input");return n.id="new-task-"+e,n.name="new-task",n.type="text",n.placeholder="Что нужно сделать ?",t.appendChild(a),t.appendChild(n),t},removeInput=function(e){e.target.value||e.target.remove()},inputNewTask=document.querySelector("#new-task-1"),itemTemplate=document.querySelector(".new-task__item input"),currentItem=1,appendInput=function(e){if(13===e.keyCode&&0==!e.target.value){var t=document.querySelector(".new-task__list");e.preventDefault(),currentItem=++currentItem;var a=createTask(currentItem);a.addEventListener("keydown",appendInput),t.appendChild(a),t.querySelector("#new-task-"+currentItem).focus(),e.target.removeEventListener("keydown",appendInput),e.preventDefault()}13===e.keyCode&&0==e.target.value&&e.preventDefault(),0==e.target.value&&8===e.keyCode&&(e.target.parentNode.previousElementSibling.lastElementChild.focus(),e.target.parentNode.remove())};itemTemplate.addEventListener("keydown",appendInput);var newTaskScreen=document.querySelector(".new-task"),firstInput=document.querySelector("#new-task-1"),taskBtnDone=document.querySelector(".new-task__btn--done"),taskBtnCancel=document.querySelector(".new-task__btn--cancel");firstInput.addEventListener("input",function(e){e.target.value?taskBtnDone.classList.remove("new-task__btn--hide"):taskBtnDone.classList.add("new-task__btn--hide")}),taskBtnCancel.addEventListener("click",function(e){e.preventDefault(),newTaskScreen.classList.add("new-task--hide")}),taskBtnDone.addEventListener("click",function(e){e.preventDefault();for(var t=document.querySelector(".new-task__cat-list input:checked").value,a=document.querySelectorAll(".new-task__item input"),n=0;n<a.length;n++)a[n].value&&localStorage.setItem(a[n].value,t);console.log(localStorage)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhc2stbWFyay1hbmltYXRlLmpzIl0sIm5hbWVzIjpbInRhc2tMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGVtcGxhdGVMaXN0IiwiZGVsZXRlSWNvbiIsImRlbGV0ZUljb25UZW1wbGF0ZSIsInRhc2tSZWFkeUFyciIsInNsaWNlIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJkb25lTWFyayIsImNsYXNzTGlzdCIsImFkZCIsIm9uVGFza0RvbmUiLCJ3cmFwcGVyTm9kZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJ0b2dnbGUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwidGFza0RvbmVBcnIiLCJpIiwibGVuZ3RoIiwidXBkYXRlRGF0YSIsImZvcm1CdG4iLCJidG5MaXN0Iiwib3ZlcmxheSIsImxpc3RUZW1wbGF0ZSIsInRlbXBsYXRlVGl0aWxlIiwidGVtcGxhdGVDb3VudCIsInRlbXBsYXRlVGFza0xpc3QiLCJ0ZW1wbGF0ZUl0ZW0iLCJ0ZW1wbGF0ZVJlYWR5IiwidGVtcGxhdGVUZXh0IiwidGVtcGxhdGVEYXRlIiwiY2F0ZWdvcnlMaXN0IiwiY2FsbGJhY2siLCJ0YXJnIiwiZXZlbnQiLCJ0YWdOYW1lIiwiY29sb3JUYXJnZXQiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInRpdGxlVGFyZ2V0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpbm5lclRleHQiLCJjb3VudGVyVGFyZ2V0IiwibGFzdEVsZW1lbnRDaGlsZCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwidGV4dENvbnRlbnQiLCJpZENhdGVnb3J5IiwiaWQiLCJ0ZW1wbGF0ZVRhc2tBcnIiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJuZXdJdGVtIiwiY3JlYXRlRWxlbWVudCIsIm5ld0l0ZW1SZWFkeSIsImFwcGVuZENoaWxkIiwibmV3SXRlbVRleHQiLCJuZXdJdGVtRGF0ZSIsImlubmVySFRNTCIsImNyZWF0ZVRhc2tFbGVtIiwib25UYXNrRG9uZVRlbXBsYXRlIiwidGV4dENvbnRlbnRBcnIiLCJjb25zb2xlIiwiZGlyIiwidGFza3NBcnIiLCJrIiwiY2F0ZWdvcmllc0FyciIsImNhdGVnb3JpZXNJZE9iaiIsIm9iaiIsImN1cnJlbnRWYWx1ZUNvdW50ZXIiLCJwQ291bnRlciIsImtleSIsImNvbWJpZW5kVGFza1dvcmRzIiwiYXJyYXkiLCJ3b3JrIiwicGVyc29uYWwiLCJzaG9wcGluZyIsImZhbWlseSIsIndhcm5pbmciLCJjb3VudFRhc2tzIiwiY3JlYXRlTmV3VGFzayIsImJ0bldyYXBwZXIiLCJidG5DYW5jZWwiLCJidG5Eb25lIiwibmV3VGFza0xpc3QiLCJuZXdUYXNrSXRlbSIsIm5ld1Rhc2tEb25lIiwibmV3VGFza0lucHV0IiwiY3JlYXRlVGFzayIsImN1cnJlbnQiLCJuZXdMaSIsIm5ld0RpdiIsIm5ld0lucHV0IiwibmFtZSIsInR5cGUiLCJwbGFjZWhvbGRlciIsInJlbW92ZUlucHV0IiwidmFsdWUiLCJpbnB1dE5ld1Rhc2siLCJpdGVtVGVtcGxhdGUiLCJjdXJyZW50SXRlbSIsImFwcGVuZElucHV0Iiwia2V5Q29kZSIsInByZXZlbnREZWZhdWx0IiwibmV3SXRlbVRlbXBsYXRlIiwiZm9jdXMiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicGFyZW50Tm9kZSIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJuZXdUYXNrU2NyZWVuIiwiZmlyc3RJbnB1dCIsInRhc2tCdG5Eb25lIiwidGFza0J0bkNhbmNlbCIsImNhdGVnb3J5VmFsdWUiLCJjdXJyZW50VGFza3NMaXN0IiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsImxvZyJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsU0FBV0MsU0FBU0MsY0FBYyxjQUNsQ0MsYUFBZUYsU0FBU0MsY0FBYyw2QkFDdENFLFdBQWFILFNBQVNDLGNBQWMsZ0JBQ3BDRyxtQkFBcUJK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SyxRQUNUaEcsRUFBRUMsT0FBT2dHLG9CQUFvQixVQUFXTCxhQUN4QzVGLEVBQUU4RixpQkFHYyxLQUFkOUYsRUFBRTZGLFNBQW9DLEdBQWxCN0YsRUFBRUMsT0FBT3VGLE9BQy9CeEYsRUFBRThGLGlCQUlrQixHQUFsQjlGLEVBQUVDLE9BQU91RixPQUE0QixJQUFkeEYsRUFBRTZGLFVBQzNCN0YsRUFBRUMsT0FBT2lHLFdBQVdDLHVCQUF1QmpFLGlCQUFpQjhELFFBQzVEaEcsRUFBRUMsT0FBT2lHLFdBQVc1RixXQUsxQm9GLGFBQWEzRixpQkFBaUIsVUFBVzZGLGFBSXpDLElBQUlRLGNBQWdCbkgsU0FBU0MsY0FBYyxhQUN2Q21ILFdBQWFwSCxTQUFTQyxjQUFjLGVBQ3BDb0gsWUFBY3JILFNBQVNDLGNBQWMsd0JBQ3JDcUgsY0FBZ0J0SCxTQUFTQyxjQUFjLDBCQUkzQ21ILFdBQVd0RyxpQkFBaUIsUUFBUyxTQUFVQyxHQUN6Q0EsRUFBRUMsT0FBT3VGLE1BQ1hjLFlBQVkzRyxVQUFVVyxPQUFPLHVCQUU3QmdHLFlBQVkzRyxVQUFVQyxJQUFJLHlCQUs5QjJHLGNBQWN4RyxpQkFBaUIsUUFBUyxTQUFVQyxHQUNoREEsRUFBRThGLGlCQUNGTSxjQUFjekcsVUFBVUMsSUFBSSxvQkFJOUIwRyxZQUFZdkcsaUJBQWlCLFFBQVMsU0FBVUMsR0FDOUNBLEVBQUU4RixpQkFLRixJQUpBLElBRUlVLEVBRFd2SCxTQUFTQyxjQUFjLHFDQUNUc0csTUFDekJpQixFQUFtQnhILFNBQVNRLGlCQUFpQix5QkFDeENlLEVBQUksRUFBR0EsRUFBSWlHLEVBQWlCaEcsT0FBUUQsSUFFdkNpRyxFQUFpQmpHLEdBQUdnRixPQUN0QmtCLGFBQWFDLFFBQVFGLEVBQWlCakcsR0FBR2dGLE1BQVFnQixHQUtyRG5ELFFBQVF1RCxJQUFJRiIsImZpbGUiOiJ0YXNrLW1hcmstYW5pbWF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB0YXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWxpc3QnKTtcclxudmFyIHRlbXBsYXRlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190YXNrLWxpc3QnKTtcclxudmFyIGRlbGV0ZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGVsZXRlLWljb24nKTtcclxudmFyIGRlbGV0ZUljb25UZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZWxldGUtaWNvbi0tdGVtcGxhdGUnKTtcclxudmFyIHRhc2tSZWFkeUFyciA9IFtdLnNsaWNlLmNhbGwodGFza0xpc3QucXVlcnlTZWxlY3RvckFsbCgnLnRhc2tfX3JlYWR5JykpO1xyXG5cclxuXHJcblxyXG5cclxuLy8gdmFyIGNyZWF0ZVRhc2tMaXN0ID0gZnVuY3Rpb24gKHNvbWVPYmopIHtcclxuXHJcbi8vICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuLy8gICBmb3IgKHZhciBrZXkgaW4gc29tZU9iaikge1xyXG4vLyAgICAgdmFyIHRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuLy8gICAgIHRhc2suY2xhc3NMaXN0LmFkZCgndGFzaycpO1xyXG4vLyAgICAgdmFyIGNhdENsYXNzID0gc29tZU9iai5nZXRJdGVtKGtleSk7XHJcbi8vICAgICB0YXNrLmNsYXNzTGlzdC5hZGQoJ3Rhc2stLScgKyBjYXRDbGFzcyk7XHJcbiAgICBcclxuLy8gICAgIHZhciB0YXNrUmVhZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuLy8gICAgIHRhc2tSZWFkeS5jbGFzc0xpc3QuYWRkKCd0YXNrX19yZWFkeScpO1xyXG4vLyAgICAgdGFzay5hcHBlbmRDaGlsZCh0YXNrUmVhZHkpO1xyXG5cclxuLy8gICAgIHZhciB0YXNrVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuLy8gICAgIHRhc2tUZXh0LmNsYXNzTGlzdC5hZGQoJ3Rhc2tfX3RleHQnKTtcclxuLy8gICAgIHRhc2tUZXh0LnRleHRDb250ZW50ID0ga2V5O1xyXG4vLyAgICAgdGFzay5hcHBlbmRDaGlsZCh0YXNrVGV4dCk7XHJcblxyXG4vLyAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGFzayk7XHJcbi8vICAgfVxyXG5cclxuLy8gICB0YXNrTGlzdC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XHJcbi8vIH1cclxuXHJcblxyXG4vLyBjcmVhdGVUYXNrTGlzdChsb2NhbFN0b3JhZ2UpO1xyXG5cclxuXHJcbi8vINCT0JDQm9Ce0KfQmtCQINCYINCX0JDQp9CV0KDQmtCY0JLQkNCd0JjQlSDQotCQ0KHQmtCQXHJcblxyXG52YXIgZG9uZU1hcmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFza19fcmVhZHktLWRvbmUnKTtcclxuXHJcbmlmIChkb25lTWFyaykge1xyXG4gIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZCgnZGVsZXRlLWljb24tLXNob3cnKTtcclxufVxyXG5cclxuXHJcbnZhciBvblRhc2tEb25lID0gZnVuY3Rpb24gKHdyYXBwZXJOb2RlKSB7XHJcblxyXG4gIHdyYXBwZXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcblxyXG4gICAgLy8g0KPRgdGC0LDQvdC+0LLQutCwINC60LDQu9C+0YfQutC4INGC0LDRgdC60LBcclxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2tfX3JlYWR5JykpIHtcclxuICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgndGFza19fcmVhZHktLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ3Rhc2tfX3RleHQtLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCd0YXNrLS1kb25lJyk7XHJcblxyXG4gICAgICAvLyDQn9C+0Y/QstC70LXQvdC40LUg0LrQvtGA0LfQuNC90LrQuCDQv9GA0Lgg0LLRi9Cx0L7RgNC1INGC0LDRgdC60LBcclxuICAgICAgdmFyIGRvbmVNYXJrID0gd3JhcHBlck5vZGUucXVlcnlTZWxlY3RvcignLnRhc2tfX3JlYWR5LS1kb25lJyk7XHJcblxyXG4gICAgICBpZiAoZG9uZU1hcmspIHtcclxuICAgICAgICBkZWxldGVJY29uLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xyXG4gICAgICB9XHJcbiAgICB9IFxyXG4gICAgXHJcbiAgfSk7XHJcbn1cclxuXHJcbm9uVGFza0RvbmUodGFza0xpc3QpO1xyXG4vLyBcclxuLy8gXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8g0KPQlNCQ0JvQldCd0JjQlSDQotCQ0KHQmtCQXHJcblxyXG5cclxuZGVsZXRlSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgdmFyIHRhc2tEb25lQXJyID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay0tZG9uZScpKTtcclxuXHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXNrRG9uZUFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgdGFza0RvbmVBcnJbaV0ucmVtb3ZlKCk7XHJcbiAgICBcclxuICB9XHJcblxyXG4gIGRlbGV0ZUljb24uY2xhc3NMaXN0LnJlbW92ZSgnZGVsZXRlLWljb24tLXNob3cnKTtcclxuXHJcbiAgdXBkYXRlRGF0YSgpO1xyXG5cclxufSk7XHJcblxyXG4vLyBcclxuLy8gXHJcblxyXG5cclxuLy8gYnRuLXBsdXNcclxuXHJcbnZhciBmb3JtQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2J0bicpO1xyXG52YXIgYnRuTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGVfX2l0ZW1zJyk7XHJcbnZhciBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKTtcclxuXHJcbmZvcm1CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICBmb3JtQnRuLmNsYXNzTGlzdC50b2dnbGUoJ2Zvcm1fX2J0bi0tYWN0aXZlJyk7XHJcbiAgYnRuTGlzdC5jbGFzc0xpc3QudG9nZ2xlKCdjcmVhdGVfX2l0ZW1zLS1hY3RpdmUnKTtcclxuICBvdmVybGF5LmNsYXNzTGlzdC50b2dnbGUoJ292ZXJsYXktLWFjdGl2ZScpO1xyXG59KTtcclxuLy8gXHJcbi8vIFxyXG5cclxuXHJcblxyXG4vLyBsaXN0LXRlbXBsYXRlXHJcblxyXG4vLyDQodCe0JfQlNCQ0J3QmNCVINCX0JDQk9Ce0JvQntCS0JrQkCDQmCDQptCS0JXQotCQINCa0JDQoNCi0J7Qp9Ca0JhcclxudmFyIGxpc3RUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlJyk7XHJcbnZhciB0ZW1wbGF0ZVRpdGlsZSA9IGxpc3RUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGl0bGUnKTtcclxudmFyIHRlbXBsYXRlQ291bnQgPSBsaXN0VGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX2NvdW50Jyk7XHJcblxyXG4vLyB0ZW1wbGF0ZS1saXN0XHJcbnZhciB0ZW1wbGF0ZVRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stbGlzdCcpO1xyXG52YXIgdGVtcGxhdGVJdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stLXRlbXBsYXRlJyk7XHJcbnZhciB0ZW1wbGF0ZVJlYWR5ID0gdGVtcGxhdGVJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190YXNrLXJlYWR5Jyk7XHJcbnZhciB0ZW1wbGF0ZVRleHQgPSB0ZW1wbGF0ZUl0ZW0ucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dCcpO1xyXG52YXIgdGVtcGxhdGVEYXRlID0gdGVtcGxhdGVJdGVtLnF1ZXJ5U2VsZWN0b3IoJ3Rhc2tfX2RhdGUnKTtcclxuXHJcblxyXG52YXIgY2F0ZWdvcnlMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhdGVnb3J5X19saXN0Jyk7XHJcblxyXG5cclxuXHJcblxyXG5cclxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oZSl7XHJcbiAgdmFyIHRhcmcgPSBlLnRhcmdldDtcclxuXHJcbiAgLy8g0YTQuNC60YEg0LLRi9Cx0L7RgNCwINC60LDRgNGC0L7Rh9C60LhcclxuICBpZiAoZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQudGFnTmFtZSA9PT0gJ0xJJykge1xyXG4gICB0YXJnID0gZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQ7XHJcbiAgfVxyXG4gIFxyXG5cclxuXHJcblxyXG4gIC8vINC/0L7Qu9GD0YfQuNC8INGG0LLQtdGCLCDQt9Cw0LPQvtC70L7QstC+0LosINGB0YfQtdGC0YfQuNC6INC60LDRgtC10LPQvtGA0LjQuFxyXG4gIHZhciBjb2xvclRhcmdldCA9IGdldENvbXB1dGVkU3R5bGUodGFyZykuZ2V0UHJvcGVydHlWYWx1ZSgnYmFja2dyb3VuZC1jb2xvcicpO1xyXG4gIHZhciB0aXRsZVRhcmdldCA9IHRhcmcuZmlyc3RFbGVtZW50Q2hpbGQuaW5uZXJUZXh0O1xyXG4gIHZhciBjb3VudGVyVGFyZ2V0ID0gdGFyZy5sYXN0RWxlbWVudENoaWxkLmlubmVyVGV4dDtcclxuXHJcblxyXG4gIC8v0LfQsNC00LDQtNC40Lwg0YbQstC10YIsINC30LDQs9C+0LvQvtCy0L7Quiwg0YHRh9C10YLRh9C40Log0LrQsNGA0YLQvtGH0LrQuFxyXG4gIGxpc3RUZW1wbGF0ZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclRhcmdldDtcclxuICB0ZW1wbGF0ZVRpdGlsZS50ZXh0Q29udGVudCA9ICB0aXRsZVRhcmdldDtcclxuICB0ZW1wbGF0ZUNvdW50LnRleHRDb250ZW50ID0gY291bnRlclRhcmdldDtcclxuXHJcblxyXG5cclxuICAvLyBcclxuICAvLyBcclxuXHJcbiAgLy8g0YHQvtCx0LXRgNC10Lwg0YHQv9C40YHQvtC6INC30LDQtNCw0YdcclxuICB2YXIgaWRDYXRlZ29yeSA9IHRhcmcuaWQuc2xpY2UoNCk7XHJcblxyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVUYXNrRWxlbSgpIHtcclxuXHJcbiAgICB2YXIgdGVtcGxhdGVUYXNrQXJyID0gW10uc2xpY2UuY2FsbCh0YXNrTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay0tJyArIGlkQ2F0ZWdvcnkpKTtcclxuXHJcbiAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICBcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRlbXBsYXRlVGFza0Fyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICB2YXIgbmV3SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICBuZXdJdGVtLmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2snKTtcclxuICAgICAgbmV3SXRlbS5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrLS10ZW1wbGF0ZScpO1xyXG5cclxuICAgICAgdmFyIG5ld0l0ZW1SZWFkeSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICBuZXdJdGVtUmVhZHkuY2xhc3NMaXN0LmFkZCgnbGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeScpO1xyXG4gICAgICBuZXdJdGVtLmFwcGVuZENoaWxkKG5ld0l0ZW1SZWFkeSk7XHJcblxyXG4gICAgICB2YXIgbmV3SXRlbVRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICAgIG5ld0l0ZW1UZXh0LmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dCcpO1xyXG4gICAgICBuZXdJdGVtLmFwcGVuZENoaWxkKG5ld0l0ZW1UZXh0KTtcclxuXHJcbiAgICAgIHZhciBuZXdJdGVtRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgbmV3SXRlbURhdGUuY2xhc3NMaXN0LmFkZCgnbGlzdC10ZW1wbGF0ZV9fdGFzay1kYXRlJyk7XHJcbiAgICAgIG5ld0l0ZW0uYXBwZW5kQ2hpbGQobmV3SXRlbURhdGUpO1xyXG4gICAgICBuZXdJdGVtVGV4dC50ZXh0Q29udGVudCA9IHRlbXBsYXRlVGFza0FycltpXS50ZXh0Q29udGVudDtcclxuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobmV3SXRlbSk7XHJcbiAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0ZW1wbGF0ZVRhc2tMaXN0LmlubmVySFRNTD0gJyc7XHJcbiAgICB0ZW1wbGF0ZVRhc2tMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcclxuICB9XHJcblxyXG5cclxuICBjcmVhdGVUYXNrRWxlbSgpO1xyXG4gIFxyXG5cclxuICBcclxufTtcclxuXHJcbmNhdGVnb3J5TGlzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNhbGxiYWNrKTtcclxuXHJcbm9uVGFza0RvbmUodGVtcGxhdGVUYXNrTGlzdCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vINCT0LDQu9C+0YfQutCwINC4INC/0L7Rj9Cy0LvQtdC90LjQtSDQutC+0YDQt9C40L3QutC4INCyINC60LDRgNGC0L7Rh9C60LVcclxuXHJcbnZhciBvblRhc2tEb25lVGVtcGxhdGUgPSBmdW5jdGlvbiAod3JhcHBlck5vZGUpIHtcclxuXHJcbiAgd3JhcHBlck5vZGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuXHJcbiAgICAvLyDQo9GB0YLQsNC90L7QstC60LAg0LrQsNC70L7Rh9C60Lgg0YLQsNGB0LrQsFxyXG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeScpKSB7XHJcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stcmVhZHktLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dC0tZG9uZScpO1xyXG4gICAgICBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stLWRvbmUnKTtcclxuXHJcbiAgICAgIC8vINCf0L7Rj9Cy0LvQtdC90LjQtSDQutC+0YDQt9C40L3QutC4INC/0YDQuCDQstGL0LHQvtGA0LUg0YLQsNGB0LrQsFxyXG4gICAgICB2YXIgZG9uZU1hcmsgPSB3cmFwcGVyTm9kZS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeS0tZG9uZScpO1xyXG5cclxuICAgICAgaWYgKGRvbmVNYXJrKSB7XHJcbiAgICAgICAgZGVsZXRlSWNvblRlbXBsYXRlLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVsZXRlSWNvblRlbXBsYXRlLmNsYXNzTGlzdC5yZW1vdmUoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XHJcbiAgICAgIH1cclxuICAgIH0gXHJcbiAgICBcclxuICB9KTtcclxufVxyXG5cclxub25UYXNrRG9uZVRlbXBsYXRlKHRlbXBsYXRlTGlzdCk7XHJcblxyXG4vLyDQo9CU0JDQm9CV0J3QmNCVINCi0JDQodCa0JAg0JIg0JrQkNCg0KLQntCn0JrQlVxyXG5cclxuZGVsZXRlSWNvblRlbXBsYXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICB2YXIgdGFza0RvbmVBcnIgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saXN0LXRlbXBsYXRlX190YXNrLS1kb25lJykpO1xyXG5cclxuICB2YXIgdGV4dENvbnRlbnRBcnIgPSBbXTtcclxuICBcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tEb25lQXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICB0ZXh0Q29udGVudEFycltpXSA9IHRhc2tEb25lQXJyW2ldLnRleHRDb250ZW50O1xyXG4gICAgdGFza0RvbmVBcnJbaV0ucmVtb3ZlKCk7XHJcbiAgICBcclxuICB9XHJcblxyXG4gIGNvbnNvbGUuZGlyKHRleHRDb250ZW50QXJyKTtcclxuXHJcblxyXG5cclxuICB2YXIgdGFza3NBcnIgPSBbXS5zbGljZS5jYWxsKHRhc2tMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrJykpO1xyXG5cclxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tEb25lQXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBcclxuXHJcbiAgICBmb3IgKHZhciBrID0gMDsgayA8IHRhc2tzQXJyLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgIGlmICh0YXNrc0FycltrXS50ZXh0Q29udGVudCA9PT0gdGFza0RvbmVBcnJbaV0udGV4dENvbnRlbnQpIHtcclxuICAgICAgICB0YXNrc0FycltrXS5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgIH1cclxuICAgIFxyXG4gIH1cclxuXHJcblxyXG5cclxuICBkZWxldGVJY29uVGVtcGxhdGUuY2xhc3NMaXN0LnJlbW92ZSgnZGVsZXRlLWljb24tLXNob3cnKTtcclxuXHJcblxyXG4gIHVwZGF0ZURhdGEoKTtcclxuXHJcbn0pO1xyXG5cclxuXHJcbi8vINCa0J7Qm9CY0KfQldCh0KLQktCeINCX0JDQlNCQ0KdcclxuIFxyXG5cclxuXHJcbnZhciB1cGRhdGVEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gIC8vINGB0L7QsdC10YDQtdC8INC4INGB0LPRgNGD0L/QuNGA0YPQtdC8INGC0LDRgdC60Lgg0L/QviDQutCw0YLQtdCz0L7RgNC40Y/QvCDQsiDQvtCx0YzQtdC60YJcclxuXHJcbiAgdmFyIHRhc2tzQXJyID0gW10uc2xpY2UuY2FsbCh0YXNrTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzaycpKTtcclxuXHJcbiAgdmFyIGNhdGVnb3JpZXNBcnIgPSBbXS5zbGljZS5jYWxsKGNhdGVnb3J5TGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuY2F0ZWdvcnlfX2l0ZW0nKSk7XHJcblxyXG4gIHZhciBjYXRlZ29yaWVzSWRPYmogPSB7fTtcclxuICBcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IGNhdGVnb3JpZXNBcnIubGVuZ3RoOyBpKyspIHtcclxuICAgIGNhdGVnb3JpZXNJZE9ialtjYXRlZ29yaWVzQXJyW2ldLmlkLnNsaWNlKDQpXSA9IDA7XHJcbiAgfVxyXG4gIFxyXG5cclxuICBcclxuICBcclxuICBcclxuICAvLyBcclxuXHJcbiAgLy8g0J/QntCU0KHQp9CV0KIg0KLQkNCh0JrQntCSINCf0J4g0JrQkNCi0JXQk9Ce0KDQmNCv0JxcclxuXHJcbiAgdmFyIGNvdW50VGFza3MgPSBmdW5jdGlvbiAoYXJyYXksIG9iaikge1xyXG4gICAgXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICBcclxuICAgICAgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0td29yaycpKSB7XHJcbiAgICAgICAgb2JqLndvcmsrKztcclxuICAgICAgfSBlbHNlIGlmIChhcnJheVtpXS5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2stLXBlcnNvbmFsJykpe1xyXG4gICAgICAgIG9iai5wZXJzb25hbCsrO1xyXG4gICAgICB9IGVsc2UgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0tc2hvcHBpbmcnKSl7XHJcbiAgICAgICAgb2JqLnNob3BwaW5nKys7XHJcbiAgICAgIH0gZWxzZSBpZiAoYXJyYXlbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLS1mYW1pbHknKSl7XHJcbiAgICAgICAgb2JqLmZhbWlseSsrO1xyXG4gICAgICB9IGVsc2UgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0td2FybmluZycpKXtcclxuICAgICAgICBvYmoud2FybmluZysrO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9iajtcclxuICB9XHJcblxyXG5cclxuICBcclxuXHJcbiAgdmFyIHJlc3VsID0gY291bnRUYXNrcyh0YXNrc0FyciwgY2F0ZWdvcmllc0lkT2JqKTtcclxuICBcclxuICAvLyBcclxuXHJcbiAgLy8g0J7QmtCe0J3Qp9CQ0J3QmNCVINCh0JvQntCS0JAgXCLQl9CQ0JTQkNCn0JBcIlxyXG5cclxuICB2YXIgY29tYmllbmRUYXNrV29yZHMgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICBcclxuICAgIHZhciBjdXJyZW50VmFsdWVDb3VudGVyO1xyXG4gICAgdmFyIHBDb3VudGVyO1xyXG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XHJcbiAgICAgIHBDb3VudGVyID0gY2F0ZWdvcnlMaXN0LnF1ZXJ5U2VsZWN0b3IoJyNjYXRfJyArIGtleSArICcgLmNhdGVnb3J5X19jb3VudCcpO1xyXG4gICAgICBjdXJyZW50VmFsdWVDb3VudGVyID0gb2JqW2tleV0gO1xyXG4gICAgICBpZiAoY3VycmVudFZhbHVlQ291bnRlciA9PT0gMCkge1xyXG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9ICfQndC10YIg0LfQsNC00LDRhyc7XHJcbiAgICAgIH0gZWxzZSBpZihjdXJyZW50VmFsdWVDb3VudGVyID09PSAxKXtcclxuICAgICAgICBwQ291bnRlci5pbm5lclRleHQgPSBjdXJyZW50VmFsdWVDb3VudGVyICsgJyDQt9Cw0LTQsNGH0LAnO1xyXG4gICAgICB9IGVsc2UgaWYoY3VycmVudFZhbHVlQ291bnRlciA+PSAyICYmIGN1cnJlbnRWYWx1ZUNvdW50ZXIgPD0gNCl7XHJcbiAgICAgICAgcENvdW50ZXIuaW5uZXJUZXh0ID0gY3VycmVudFZhbHVlQ291bnRlciArICcg0LfQsNC00LDRh9C4JztcclxuICAgICAgfSBlbHNlIGlmIChjdXJyZW50VmFsdWVDb3VudGVyID49IDUgJiYgY3VycmVudFZhbHVlQ291bnRlciA8PSAyMCkge1xyXG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9IGN1cnJlbnRWYWx1ZUNvdW50ZXIgKyAnINC30LDQtNCw0YcnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgY29tYmllbmRUYXNrV29yZHMocmVzdWwpO1xyXG5cclxufVxyXG5cclxudXBkYXRlRGF0YSgpO1xyXG4gIFxyXG4gIFxyXG4vLyDQntCi0KDQmNCh0J7QktCa0JAg0J7QmtCd0JAg0J3QntCS0J7Qk9CeINCi0JDQodCa0JAgXHJcblxyXG52YXIgY3JlYXRlTmV3VGFzayA9IGZ1bmN0aW9uKCkge1xyXG5cclxuLy8g0L7QutC90L5cclxuICB2YXIgbmV3VGFza1dpbmRvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIG5ld1Rhc2tXaW5kb3cuY2xhc3NMaXN0LmFkZCgnbmV3LXRhc2snKTtcclxuXHJcbi8vINC60L3QvtC/0LrQuCDQvtGC0LzQtdC90LAg0Lgg0LPQvtGC0L7QstC+IFxyXG4gIHZhciBidG5XcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgdmFyIGJ0bkNhbmNlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gIHZhciBidG5Eb25lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcblxyXG4gIGJ0bldyYXBwZXIuYXBwZW5kQ2hpbGQoYnRuQ2FuY2VsKTtcclxuICBidG5XcmFwcGVyLmFwcGVuZENoaWxkKGJ0bkRvbmUpO1xyXG5cclxuLy8g0YHQv9C40YHQvtC6LdC+0LHQtdGA0YLQutCwINC4INC+0LTQuNC9INGC0LDRgdC6XHJcbiAgdmFyIG5ld1Rhc2tMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgdmFyIG5ld1Rhc2tJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgdmFyIG5ld1Rhc2tEb25lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgdmFyIG5ld1Rhc2tJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcblxyXG4gIG5ld1Rhc2tJdGVtLmFwcGVuZENoaWxkKG5ld1Rhc2tEb25lKTtcclxuICBuZXdUYXNrSXRlbS5hcHBlbmRDaGlsZChuZXdUYXNrSW5wdXQpO1xyXG4gIG5ld1Rhc2tMaXN0LmFwcGVuZENoaWxkKG5ld1Rhc2tJdGVtKTtcclxufVxyXG5cclxuXHJcblxyXG4vLyDQodCe0JfQlNCQ0J3QmNCVINCd0J7QktCe0JPQniDQmNCd0J/Qo9Ci0JAg0JTQm9CvINCX0JDQn9CY0KHQmFxyXG5cclxudmFyIGNyZWF0ZVRhc2sgPSBmdW5jdGlvbihjdXJyZW50KSB7XHJcblxyXG4gIHZhciBuZXdMaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgbmV3TGkuY2xhc3NMaXN0LmFkZCgnbmV3LXRhc2tfX2l0ZW0nKTtcclxuICB2YXIgbmV3RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgbmV3RGl2LmNsYXNzTGlzdC5hZGQoJ25ldy10YXNrX19yZWFkeScpO1xyXG4gIHZhciBuZXdJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgbmV3SW5wdXQuaWQgPSAnbmV3LXRhc2stJyArIGN1cnJlbnQ7XHJcbiAgbmV3SW5wdXQubmFtZSA9ICduZXctdGFzayc7XHJcbiAgbmV3SW5wdXQudHlwZSA9ICd0ZXh0JztcclxuICBuZXdJbnB1dC5wbGFjZWhvbGRlciA9ICfQp9GC0L4g0L3Rg9C20L3QviDRgdC00LXQu9Cw0YLRjCA/JztcclxuICBuZXdMaS5hcHBlbmRDaGlsZChuZXdEaXYpO1xyXG4gIG5ld0xpLmFwcGVuZENoaWxkKG5ld0lucHV0KTtcclxuXHJcbiAgcmV0dXJuIG5ld0xpO1xyXG5cclxufTtcclxuXHJcbi8vIFxyXG4vLyBcclxuXHJcbnZhciByZW1vdmVJbnB1dCA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgaWYgKCFlLnRhcmdldC52YWx1ZSkge1xyXG4gICAgZS50YXJnZXQucmVtb3ZlKCk7XHJcbiAgfVxyXG59XHJcblxyXG52YXIgaW5wdXROZXdUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ldy10YXNrLTEnKTtcclxudmFyIGl0ZW1UZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19faXRlbSBpbnB1dCcpO1xyXG52YXIgY3VycmVudEl0ZW0gPSAxO1xyXG5cclxudmFyIGFwcGVuZElucHV0ID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIGlmIChlLmtleUNvZGUgPT09IDEzICYmICFlLnRhcmdldC52YWx1ZSA9PSAwICkge1xyXG4gICAgICB2YXIgbmV3VGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LXRhc2tfX2xpc3QnKTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjdXJyZW50SXRlbSA9ICsrY3VycmVudEl0ZW07XHJcbiAgICAgIHZhciBuZXdJdGVtVGVtcGxhdGUgPSBjcmVhdGVUYXNrKGN1cnJlbnRJdGVtKTtcclxuICAgICAgXHJcbiAgICAgIG5ld0l0ZW1UZW1wbGF0ZS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgYXBwZW5kSW5wdXQpO1xyXG4gICAgICBuZXdUYXNrTGlzdC5hcHBlbmRDaGlsZChuZXdJdGVtVGVtcGxhdGUpO1xyXG4gICAgICB2YXIgdGFiSXRlbW0gPSBuZXdUYXNrTGlzdC5xdWVyeVNlbGVjdG9yKCcjbmV3LXRhc2stJyArIGN1cnJlbnRJdGVtKTtcclxuICAgICAgdGFiSXRlbW0uZm9jdXMoKTtcclxuICAgICAgZS50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFwcGVuZElucHV0KTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChlLmtleUNvZGUgPT09IDEzICYmIGUudGFyZ2V0LnZhbHVlID09IDAgKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgaWYgKGUudGFyZ2V0LnZhbHVlID09IDAgJiYgZS5rZXlDb2RlID09PSA4KSB7XHJcbiAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucHJldmlvdXNFbGVtZW50U2libGluZy5sYXN0RWxlbWVudENoaWxkLmZvY3VzKCk7XHJcbiAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5pdGVtVGVtcGxhdGUuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFwcGVuZElucHV0KTtcclxuXHJcbi8vXHJcblxyXG52YXIgbmV3VGFza1NjcmVlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFzaycpO1xyXG52YXIgZmlyc3RJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuZXctdGFzay0xJyk7XHJcbnZhciB0YXNrQnRuRG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19fYnRuLS1kb25lJyk7XHJcbnZhciB0YXNrQnRuQ2FuY2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy10YXNrX19idG4tLWNhbmNlbCcpO1xyXG5cclxuLy/Qn9Ce0K/QktCb0JXQndCY0JUg0Jgg0KHQmtCg0KvQotCY0JUg0JrQndCe0J/QmtCYIFwi0JPQntCi0J7QktCeXCJcclxuXHJcbmZpcnN0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoZSkge1xyXG4gIGlmIChlLnRhcmdldC52YWx1ZSkge1xyXG4gICAgdGFza0J0bkRvbmUuY2xhc3NMaXN0LnJlbW92ZSgnbmV3LXRhc2tfX2J0bi0taGlkZScpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0YXNrQnRuRG9uZS5jbGFzc0xpc3QuYWRkKCduZXctdGFza19fYnRuLS1oaWRlJyk7XHJcbiAgfVxyXG59KTtcclxuXHJcblxyXG50YXNrQnRuQ2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgbmV3VGFza1NjcmVlbi5jbGFzc0xpc3QuYWRkKCduZXctdGFzay0taGlkZScpO1xyXG59KTtcclxuXHJcblxyXG50YXNrQnRuRG9uZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHZhciBjdXJyZW50VGFza3MgPSB7fTtcclxuICB2YXIgY2F0ZWdvcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LXRhc2tfX2NhdC1saXN0IGlucHV0OmNoZWNrZWQnKTtcclxuICB2YXIgY2F0ZWdvcnlWYWx1ZSA9IGNhdGVnb3J5LnZhbHVlO1xyXG4gIHZhciBjdXJyZW50VGFza3NMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm5ldy10YXNrX19pdGVtIGlucHV0Jyk7XHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjdXJyZW50VGFza3NMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICBcclxuICAgIGlmIChjdXJyZW50VGFza3NMaXN0W2ldLnZhbHVlKSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGN1cnJlbnRUYXNrc0xpc3RbaV0udmFsdWUsICBjYXRlZ29yeVZhbHVlKTtcclxuICAgIH1cclxuICAgIFxyXG4gIH1cclxuXHJcbiAgY29uc29sZS5sb2cobG9jYWxTdG9yYWdlKTtcclxuXHJcblxyXG59KTsiXX0=
