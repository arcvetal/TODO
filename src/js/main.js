var taskList=document.querySelector(".task-list"),templateList=document.querySelector(".list-template__task-list"),deleteIcon=document.querySelector(".delete-icon"),deleteIconTemplate=document.querySelector(".delete-icon--template"),taskReadyArr=[].slice.call(taskList.querySelectorAll(".task__ready")),doneMark=document.querySelector(".task__ready--done");doneMark&&deleteIcon.classList.add("delete-icon--show");var onTaskDone=function(t){t.addEventListener("click",function(e){e.target.classList.contains("task__ready")&&(e.target.classList.toggle("task__ready--done"),e.target.nextElementSibling.classList.toggle("task__text--done"),e.target.parentElement.classList.toggle("task--done"),t.querySelector(".task__ready--done")?deleteIcon.classList.add("delete-icon--show"):deleteIcon.classList.remove("delete-icon--show"))})};onTaskDone(taskList),deleteIcon.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".task--done")),a=0;a<t.length;a++)t[a].remove();deleteIcon.classList.remove("delete-icon--show"),updateData()});var formBtn=document.querySelector(".form__btn"),btnList=document.querySelector(".create__items"),overlay=document.querySelector(".overlay");formBtn.addEventListener("click",function(e){formBtn.classList.toggle("form__btn--active"),btnList.classList.toggle("create__items--active"),overlay.classList.toggle("overlay--active")});var listTemplate=document.querySelector(".list-template"),templateTitile=listTemplate.querySelector(".list-template__title"),templateCount=listTemplate.querySelector(".list-template__count"),templateTaskList=document.querySelector(".list-template__task-list"),templateItem=document.querySelector(".list-template__task--template"),templateReady=templateItem.querySelector(".list-template__task-ready"),templateText=templateItem.querySelector(".list-template__task-text"),templateDate=templateItem.querySelector("task__date"),categoryList=document.querySelector(".category__list"),callback=function(e){var t=e.target;"LI"===event.target.parentElement.tagName&&(t=event.target.parentElement);var a=getComputedStyle(t).getPropertyValue("background-color"),l=t.firstElementChild.innerText,n=t.lastElementChild.innerText;listTemplate.style.backgroundColor=a,templateTitile.textContent=l,templateCount.textContent=n;var c=t.id.slice(4);!function(){for(var e=[].slice.call(taskList.querySelectorAll(".task--"+c)),t=document.createDocumentFragment(),a=0;a<e.length;a++){var l=document.createElement("div");l.classList.add("list-template__task"),l.classList.add("list-template__task--template");var n=document.createElement("div");n.classList.add("list-template__task-ready"),l.appendChild(n);var s=document.createElement("p");s.classList.add("list-template__task-text"),l.appendChild(s);var r=document.createElement("span");r.classList.add("list-template__task-date"),l.appendChild(r),s.textContent=e[a].textContent,t.appendChild(l)}templateTaskList.innerHTML="",templateTaskList.appendChild(t)}()};categoryList.addEventListener("click",callback),onTaskDone(templateTaskList);var onTaskDoneTemplate=function(t){t.addEventListener("click",function(e){e.target.classList.contains("list-template__task-ready")&&(e.target.classList.toggle("list-template__task-ready--done"),e.target.nextElementSibling.classList.toggle("list-template__task-text--done"),e.target.parentElement.classList.toggle("list-template__task--done"),t.querySelector(".list-template__task-ready--done")?deleteIconTemplate.classList.add("delete-icon--show"):deleteIconTemplate.classList.remove("delete-icon--show"))})};onTaskDoneTemplate(templateList),deleteIconTemplate.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".list-template__task--done")),a=[],l=0;l<t.length;l++)a[l]=t[l].textContent,t[l].remove();console.dir(a);var n=[].slice.call(taskList.querySelectorAll(".task"));for(l=0;l<t.length;l++)for(var s=0;s<n.length;s++)n[s].textContent===t[l].textContent&&n[s].remove();deleteIconTemplate.classList.remove("delete-icon--show"),updateData()});var updateData=function(){for(var e=[].slice.call(taskList.querySelectorAll(".task")),t=[].slice.call(categoryList.querySelectorAll(".category__item")),a={},l=0;l<t.length;l++)a[t[l].id.slice(4)]=0;!function(e){var t,a;for(key in e)a=categoryList.querySelector("#cat_"+key+" .category__count"),0===(t=e[key])?a.innerText="Нет задач":1===t?a.innerText=t+" задача":2<=t&&t<=4?a.innerText=t+" задачи":5<=t&&t<=20&&(a.innerText=t+" задач")}(function(e,t){for(var a=0;a<e.length;a++)e[a].classList.contains("task--work")?t.work++:e[a].classList.contains("task--personal")?t.personal++:e[a].classList.contains("task--shopping")?t.shopping++:e[a].classList.contains("task--family")?t.family++:e[a].classList.contains("task--warning")&&t.warning++;return t}(e,a))};updateData();var createNewTask=function(){document.createElement("div").classList.add("new-task");var e=document.createElement("div"),t=document.createElement("button"),a=document.createElement("button");e.appendChild(t),e.appendChild(a);var l=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div"),r=document.createElement("input");n.appendChild(s),n.appendChild(r),l.appendChild(n)},createTask=function(e){var t=document.createElement("li");t.classList.add("new-task__item");var a=document.createElement("div");a.classList.add("new-task__ready");var l=document.createElement("input");return l.id="new-task-"+e,l.name="new-task",l.type="text",l.placeholder="Что нужно сделать",t.appendChild(a),t.appendChild(l),t},inputNewTask=document.querySelector("#new-task-1"),itemTemplate=document.querySelector(".new-task__item input"),currentItem=1,appendInput=function(e){if(13===e.keyCode){var t=document.querySelector(".new-task__list");e.preventDefault(),currentItem=++currentItem;var a=createTask(currentItem);a.addEventListener("keydown",appendInput),t.appendChild(a),t.querySelector("#new-task-"+currentItem).focus(),e.target.removeEventListener("keydown",appendInput),e.preventDefault()}};itemTemplate.addEventListener("keydown",appendInput);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhc2stbWFyay1hbmltYXRlLmpzIl0sIm5hbWVzIjpbInRhc2tMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGVtcGxhdGVMaXN0IiwiZGVsZXRlSWNvbiIsImRlbGV0ZUljb25UZW1wbGF0ZSIsInRhc2tSZWFkeUFyciIsInNsaWNlIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJkb25lTWFyayIsImNsYXNzTGlzdCIsImFkZCIsIm9uVGFza0RvbmUiLCJ3cmFwcGVyTm9kZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJ0b2dnbGUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwidGFza0RvbmVBcnIiLCJpIiwibGVuZ3RoIiwidXBkYXRlRGF0YSIsImZvcm1CdG4iLCJidG5MaXN0Iiwib3ZlcmxheSIsImxpc3RUZW1wbGF0ZSIsInRlbXBsYXRlVGl0aWxlIiwidGVtcGxhdGVDb3VudCIsInRlbXBsYXRlVGFza0xpc3QiLCJ0ZW1wbGF0ZUl0ZW0iLCJ0ZW1wbGF0ZVJlYWR5IiwidGVtcGxhdGVUZXh0IiwidGVtcGxhdGVEYXRlIiwiY2F0ZWdvcnlMaXN0IiwiY2FsbGJhY2siLCJ0YXJnIiwiZXZlbnQiLCJ0YWdOYW1lIiwiY29sb3JUYXJnZXQiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInRpdGxlVGFyZ2V0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpbm5lclRleHQiLCJjb3VudGVyVGFyZ2V0IiwibGFzdEVsZW1lbnRDaGlsZCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwidGV4dENvbnRlbnQiLCJpZENhdGVnb3J5IiwiaWQiLCJ0ZW1wbGF0ZVRhc2tBcnIiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJuZXdJdGVtIiwiY3JlYXRlRWxlbWVudCIsIm5ld0l0ZW1SZWFkeSIsImFwcGVuZENoaWxkIiwibmV3SXRlbVRleHQiLCJuZXdJdGVtRGF0ZSIsImlubmVySFRNTCIsImNyZWF0ZVRhc2tFbGVtIiwib25UYXNrRG9uZVRlbXBsYXRlIiwidGV4dENvbnRlbnRBcnIiLCJjb25zb2xlIiwiZGlyIiwidGFza3NBcnIiLCJrIiwiY2F0ZWdvcmllc0FyciIsImNhdGVnb3JpZXNJZE9iaiIsIm9iaiIsImN1cnJlbnRWYWx1ZUNvdW50ZXIiLCJwQ291bnRlciIsImtleSIsImNvbWJpZW5kVGFza1dvcmRzIiwiYXJyYXkiLCJ3b3JrIiwicGVyc29uYWwiLCJzaG9wcGluZyIsImZhbWlseSIsIndhcm5pbmciLCJjb3VudFRhc2tzIiwiY3JlYXRlTmV3VGFzayIsImJ0bldyYXBwZXIiLCJidG5DYW5jZWwiLCJidG5Eb25lIiwibmV3VGFza0xpc3QiLCJuZXdUYXNrSXRlbSIsIm5ld1Rhc2tEb25lIiwibmV3VGFza0lucHV0IiwiY3JlYXRlVGFzayIsImN1cnJlbnQiLCJuZXdMaSIsIm5ld0RpdiIsIm5ld0lucHV0IiwibmFtZSIsInR5cGUiLCJwbGFjZWhvbGRlciIsImlucHV0TmV3VGFzayIsIml0ZW1UZW1wbGF0ZSIsImN1cnJlbnRJdGVtIiwiYXBwZW5kSW5wdXQiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJuZXdJdGVtVGVtcGxhdGUiLCJmb2N1cyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFNBQVdDLFNBQVNDLGNBQWMsY0FDbENDLGFBQWVGLFNBQVNDLGNBQWMsNkJBQ3RDRSxXQUFhSCxTQUFTQyxjQUFjLGdCQUNwQ0csbUJBQXFCSixTQUFTQyxjQUFjLDBCQUM1Q0ksYUFBZSxHQUFHQyxNQUFNQyxLQUFLUixTQUFTUyxpQkFBaUIsaUJBSXZEQyxTQUFXVCxTQUFTQyxjQUFjLHNCQUVsQ1EsVUFDRk4sV0FBV08sVUFBVUMsSUFBSSxxQkFJM0IsSUFBSUMsV0FBYSxTQUFVQyxHQUV6QkEsRUFBWUMsaUJBQWlCLFFBQVMsU0FBU0MsR0FHekNBLEVBQUVDLE9BQU9O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QUFZK0IsR0FDeEJELEVBQVk5QixZQUFZZ0MsR0FDeEJILEVBQVk3QixZQUFZOEIsSUFPdEJHLFdBQWEsU0FBU0MsR0FFeEIsSUFBSUMsRUFBUWhHLFNBQVMyRCxjQUFjLE1BQ25DcUMsRUFBTXRGLFVBQVVDLElBQUksa0JBQ3BCLElBQUlzRixFQUFTakcsU0FBUzJELGNBQWMsT0FDcENzQyxFQUFPdkYsVUFBVUMsSUFBSSxtQkFDckIsSUFBSXVGLEVBQVdsRyxTQUFTMkQsY0FBYyxTQVF0QyxPQVBBdUMsRUFBUzVDLEdBQUssWUFBY3lDLEVBQzVCRyxFQUFTQyxLQUFPLFdBQ2hCRCxFQUFTRSxLQUFPLE9BQ2hCRixFQUFTRyxZQUFjLG9CQUN2QkwsRUFBTW5DLFlBQVlvQyxHQUNsQkQsRUFBTW5DLFlBQVlxQyxHQUVYRixHQUlMTSxhQUFldEcsU0FBU0MsY0FBYyxlQUN0Q3NHLGFBQWV2RyxTQUFTQyxjQUFjLHlCQUN0Q3VHLFlBQWMsRUFFZEMsWUFBYyxTQUFVMUYsR0FDeEIsR0FBa0IsS0FBZEEsRUFBRTJGLFFBQWdCLENBQ3BCLElBQUloQixFQUFjMUYsU0FBU0MsY0FBYyxtQkFDekNjLEVBQUU0RixpQkFDRkgsY0FBZ0JBLFlBQ2hCLElBQUlJLEVBQWtCZCxXQUFXVSxhQUVqQ0ksRUFBZ0I5RixpQkFBaUIsVUFBVzJGLGFBQzVDZixFQUFZN0IsWUFBWStDLEdBQ1RsQixFQUFZekYsY0FBYyxhQUFldUcsYUFDL0NLLFFBQ1Q5RixFQUFFQyxPQUFPOEYsb0JBQW9CLFVBQVdMLGFBQ3hDMUYsRUFBRTRGLG1CQUtSSixhQUFhekYsaUJBQWlCLFVBQVcyRiIsImZpbGUiOiJ0YXNrLW1hcmstYW5pbWF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB0YXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWxpc3QnKTtcbnZhciB0ZW1wbGF0ZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGFzay1saXN0Jyk7XG52YXIgZGVsZXRlSWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZWxldGUtaWNvbicpO1xudmFyIGRlbGV0ZUljb25UZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZWxldGUtaWNvbi0tdGVtcGxhdGUnKTtcbnZhciB0YXNrUmVhZHlBcnIgPSBbXS5zbGljZS5jYWxsKHRhc2tMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrX19yZWFkeScpKTtcblxuLy8g0JPQkNCb0J7Qp9Ca0JAg0Jgg0JfQkNCn0JXQoNCa0JjQktCQ0J3QmNCVINCi0JDQodCa0JBcblxudmFyIGRvbmVNYXJrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhc2tfX3JlYWR5LS1kb25lJyk7XG5cbmlmIChkb25lTWFyaykge1xuICBkZWxldGVJY29uLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XG59XG5cblxudmFyIG9uVGFza0RvbmUgPSBmdW5jdGlvbiAod3JhcHBlck5vZGUpIHtcblxuICB3cmFwcGVyTm9kZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xuXG4gICAgLy8g0KPRgdGC0LDQvdC+0LLQutCwINC60LDQu9C+0YfQutC4INGC0LDRgdC60LBcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrX19yZWFkeScpKSB7XG4gICAgICBlLnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCd0YXNrX19yZWFkeS0tZG9uZScpO1xuICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ3Rhc2tfX3RleHQtLWRvbmUnKTtcbiAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgndGFzay0tZG9uZScpO1xuXG4gICAgICAvLyDQn9C+0Y/QstC70LXQvdC40LUg0LrQvtGA0LfQuNC90LrQuCDQv9GA0Lgg0LLRi9Cx0L7RgNC1INGC0LDRgdC60LBcbiAgICAgIHZhciBkb25lTWFyayA9IHdyYXBwZXJOb2RlLnF1ZXJ5U2VsZWN0b3IoJy50YXNrX19yZWFkeS0tZG9uZScpO1xuXG4gICAgICBpZiAoZG9uZU1hcmspIHtcbiAgICAgICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QuYWRkKCdkZWxldGUtaWNvbi0tc2hvdycpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xuICAgICAgfVxuICAgIH0gXG4gICAgXG4gIH0pO1xufVxuXG5vblRhc2tEb25lKHRhc2tMaXN0KTtcbi8vIFxuLy8gXG5cblxuXG5cblxuXG5cblxuLy8g0KPQlNCQ0JvQldCd0JjQlSDQotCQ0KHQmtCQXG5cblxuZGVsZXRlSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gIHZhciB0YXNrRG9uZUFyciA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhc2stLWRvbmUnKSk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXNrRG9uZUFyci5sZW5ndGg7IGkrKykge1xuICAgIHRhc2tEb25lQXJyW2ldLnJlbW92ZSgpO1xuICAgIFxuICB9XG5cbiAgZGVsZXRlSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xuXG4gIHVwZGF0ZURhdGEoKTtcblxufSk7XG5cbi8vIFxuLy8gXG5cblxuLy8gYnRuLXBsdXNcblxudmFyIGZvcm1CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fYnRuJyk7XG52YXIgYnRuTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGVfX2l0ZW1zJyk7XG52YXIgb3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5vdmVybGF5Jyk7XG5cbmZvcm1CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcbiAgZm9ybUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdmb3JtX19idG4tLWFjdGl2ZScpO1xuICBidG5MaXN0LmNsYXNzTGlzdC50b2dnbGUoJ2NyZWF0ZV9faXRlbXMtLWFjdGl2ZScpO1xuICBvdmVybGF5LmNsYXNzTGlzdC50b2dnbGUoJ292ZXJsYXktLWFjdGl2ZScpO1xufSk7XG4vLyBcbi8vIFxuXG5cblxuLy8gbGlzdC10ZW1wbGF0ZVxuXG4vLyDQodCe0JfQlNCQ0J3QmNCVINCX0JDQk9Ce0JvQntCS0JrQkCDQmCDQptCS0JXQotCQINCa0JDQoNCi0J7Qp9Ca0JhcbnZhciBsaXN0VGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZScpO1xudmFyIHRlbXBsYXRlVGl0aWxlID0gbGlzdFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190aXRsZScpO1xudmFyIHRlbXBsYXRlQ291bnQgPSBsaXN0VGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX2NvdW50Jyk7XG5cbi8vIHRlbXBsYXRlLWxpc3RcbnZhciB0ZW1wbGF0ZVRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stbGlzdCcpO1xudmFyIHRlbXBsYXRlSXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190YXNrLS10ZW1wbGF0ZScpO1xudmFyIHRlbXBsYXRlUmVhZHkgPSB0ZW1wbGF0ZUl0ZW0ucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stcmVhZHknKTtcbnZhciB0ZW1wbGF0ZVRleHQgPSB0ZW1wbGF0ZUl0ZW0ucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dCcpO1xudmFyIHRlbXBsYXRlRGF0ZSA9IHRlbXBsYXRlSXRlbS5xdWVyeVNlbGVjdG9yKCd0YXNrX19kYXRlJyk7XG5cblxudmFyIGNhdGVnb3J5TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXRlZ29yeV9fbGlzdCcpO1xuXG5cblxuXG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKGUpe1xuICB2YXIgdGFyZyA9IGUudGFyZ2V0O1xuXG4gIC8vINGE0LjQutGBINCy0YvQsdC+0YDQsCDQutCw0YDRgtC+0YfQutC4XG4gIGlmIChldmVudC50YXJnZXQucGFyZW50RWxlbWVudC50YWdOYW1lID09PSAnTEknKSB7XG4gICB0YXJnID0gZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQ7XG4gIH1cbiAgXG5cblxuXG4gIC8vINC/0L7Qu9GD0YfQuNC8INGG0LLQtdGCLCDQt9Cw0LPQvtC70L7QstC+0LosINGB0YfQtdGC0YfQuNC6INC60LDRgtC10LPQvtGA0LjQuFxuICB2YXIgY29sb3JUYXJnZXQgPSBnZXRDb21wdXRlZFN0eWxlKHRhcmcpLmdldFByb3BlcnR5VmFsdWUoJ2JhY2tncm91bmQtY29sb3InKTtcbiAgdmFyIHRpdGxlVGFyZ2V0ID0gdGFyZy5maXJzdEVsZW1lbnRDaGlsZC5pbm5lclRleHQ7XG4gIHZhciBjb3VudGVyVGFyZ2V0ID0gdGFyZy5sYXN0RWxlbWVudENoaWxkLmlubmVyVGV4dDtcblxuXG4gIC8v0LfQsNC00LDQtNC40Lwg0YbQstC10YIsINC30LDQs9C+0LvQvtCy0L7Quiwg0YHRh9C10YLRh9C40Log0LrQsNGA0YLQvtGH0LrQuFxuICBsaXN0VGVtcGxhdGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3JUYXJnZXQ7XG4gIHRlbXBsYXRlVGl0aWxlLnRleHRDb250ZW50ID0gIHRpdGxlVGFyZ2V0O1xuICB0ZW1wbGF0ZUNvdW50LnRleHRDb250ZW50ID0gY291bnRlclRhcmdldDtcblxuXG5cbiAgLy8gXG4gIC8vIFxuXG4gIC8vINGB0L7QsdC10YDQtdC8INGB0L/QuNGB0L7QuiDQt9Cw0LTQsNGHXG4gIHZhciBpZENhdGVnb3J5ID0gdGFyZy5pZC5zbGljZSg0KTtcblxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVRhc2tFbGVtKCkge1xuXG4gICAgdmFyIHRlbXBsYXRlVGFza0FyciA9IFtdLnNsaWNlLmNhbGwodGFza0xpc3QucXVlcnlTZWxlY3RvckFsbCgnLnRhc2stLScgKyBpZENhdGVnb3J5KSk7XG5cbiAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgXG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRlbXBsYXRlVGFza0Fyci5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG5ld0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIG5ld0l0ZW0uY2xhc3NMaXN0LmFkZCgnbGlzdC10ZW1wbGF0ZV9fdGFzaycpO1xuICAgICAgbmV3SXRlbS5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrLS10ZW1wbGF0ZScpO1xuXG4gICAgICB2YXIgbmV3SXRlbVJlYWR5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBuZXdJdGVtUmVhZHkuY2xhc3NMaXN0LmFkZCgnbGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeScpO1xuICAgICAgbmV3SXRlbS5hcHBlbmRDaGlsZChuZXdJdGVtUmVhZHkpO1xuXG4gICAgICB2YXIgbmV3SXRlbVRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgICBuZXdJdGVtVGV4dC5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrLXRleHQnKTtcbiAgICAgIG5ld0l0ZW0uYXBwZW5kQ2hpbGQobmV3SXRlbVRleHQpO1xuXG4gICAgICB2YXIgbmV3SXRlbURhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICBuZXdJdGVtRGF0ZS5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrLWRhdGUnKTtcbiAgICAgIG5ld0l0ZW0uYXBwZW5kQ2hpbGQobmV3SXRlbURhdGUpO1xuICAgICAgbmV3SXRlbVRleHQudGV4dENvbnRlbnQgPSB0ZW1wbGF0ZVRhc2tBcnJbaV0udGV4dENvbnRlbnQ7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChuZXdJdGVtKTtcbiAgICAgIFxuICAgIH1cbiAgICBcbiAgICB0ZW1wbGF0ZVRhc2tMaXN0LmlubmVySFRNTD0gJyc7XG4gICAgdGVtcGxhdGVUYXNrTGlzdC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gIH1cblxuXG4gIGNyZWF0ZVRhc2tFbGVtKCk7XG4gIFxuXG4gIFxufTtcblxuY2F0ZWdvcnlMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2FsbGJhY2spO1xuXG5vblRhc2tEb25lKHRlbXBsYXRlVGFza0xpc3QpO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuLy8g0JPQsNC70L7Rh9C60LAg0Lgg0L/QvtGP0LLQu9C10L3QuNC1INC60L7RgNC30LjQvdC60Lgg0LIg0LrQsNGA0YLQvtGH0LrQtVxuXG52YXIgb25UYXNrRG9uZVRlbXBsYXRlID0gZnVuY3Rpb24gKHdyYXBwZXJOb2RlKSB7XG5cbiAgd3JhcHBlck5vZGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcblxuICAgIC8vINCj0YHRgtCw0L3QvtCy0LrQsCDQutCw0LvQvtGH0LrQuCDRgtCw0YHQutCwXG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeScpKSB7XG4gICAgICBlLnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LXRlbXBsYXRlX190YXNrLXJlYWR5LS1kb25lJyk7XG4gICAgICBlLnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LnRvZ2dsZSgnbGlzdC10ZW1wbGF0ZV9fdGFzay10ZXh0LS1kb25lJyk7XG4gICAgICBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stLWRvbmUnKTtcblxuICAgICAgLy8g0J/QvtGP0LLQu9C10L3QuNC1INC60L7RgNC30LjQvdC60Lgg0L/RgNC4INCy0YvQsdC+0YDQtSDRgtCw0YHQutCwXG4gICAgICB2YXIgZG9uZU1hcmsgPSB3cmFwcGVyTm9kZS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeS0tZG9uZScpO1xuXG4gICAgICBpZiAoZG9uZU1hcmspIHtcbiAgICAgICAgZGVsZXRlSWNvblRlbXBsYXRlLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZWxldGVJY29uVGVtcGxhdGUuY2xhc3NMaXN0LnJlbW92ZSgnZGVsZXRlLWljb24tLXNob3cnKTtcbiAgICAgIH1cbiAgICB9IFxuICAgIFxuICB9KTtcbn1cblxub25UYXNrRG9uZVRlbXBsYXRlKHRlbXBsYXRlTGlzdCk7XG5cbi8vINCj0JTQkNCb0JXQndCY0JUg0KLQkNCh0JrQkCDQkiDQmtCQ0KDQotCe0KfQmtCVXG5cbmRlbGV0ZUljb25UZW1wbGF0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gIHZhciB0YXNrRG9uZUFyciA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxpc3QtdGVtcGxhdGVfX3Rhc2stLWRvbmUnKSk7XG5cbiAgdmFyIHRleHRDb250ZW50QXJyID0gW107XG4gIFxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tEb25lQXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgdGV4dENvbnRlbnRBcnJbaV0gPSB0YXNrRG9uZUFycltpXS50ZXh0Q29udGVudDtcbiAgICB0YXNrRG9uZUFycltpXS5yZW1vdmUoKTtcbiAgICBcbiAgfVxuXG4gIGNvbnNvbGUuZGlyKHRleHRDb250ZW50QXJyKTtcblxuXG5cbiAgdmFyIHRhc2tzQXJyID0gW10uc2xpY2UuY2FsbCh0YXNrTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzaycpKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tEb25lQXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgXG5cbiAgICBmb3IgKHZhciBrID0gMDsgayA8IHRhc2tzQXJyLmxlbmd0aDsgaysrKSB7XG4gICAgICBpZiAodGFza3NBcnJba10udGV4dENvbnRlbnQgPT09IHRhc2tEb25lQXJyW2ldLnRleHRDb250ZW50KSB7XG4gICAgICAgIHRhc2tzQXJyW2tdLnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgXG4gICAgfVxuICAgIFxuICB9XG5cblxuXG4gIGRlbGV0ZUljb25UZW1wbGF0ZS5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xuXG5cbiAgdXBkYXRlRGF0YSgpO1xuXG59KTtcblxuXG4vLyDQmtCe0JvQmNCn0JXQodCi0JLQniDQl9CQ0JTQkNCnXG4gXG5cblxudmFyIHVwZGF0ZURhdGEgPSBmdW5jdGlvbiAoKSB7XG4gIC8vINGB0L7QsdC10YDQtdC8INC4INGB0LPRgNGD0L/QuNGA0YPQtdC8INGC0LDRgdC60Lgg0L/QviDQutCw0YLQtdCz0L7RgNC40Y/QvCDQsiDQvtCx0YzQtdC60YJcblxuICB2YXIgdGFza3NBcnIgPSBbXS5zbGljZS5jYWxsKHRhc2tMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrJykpO1xuXG4gIHZhciBjYXRlZ29yaWVzQXJyID0gW10uc2xpY2UuY2FsbChjYXRlZ29yeUxpc3QucXVlcnlTZWxlY3RvckFsbCgnLmNhdGVnb3J5X19pdGVtJykpO1xuXG4gIHZhciBjYXRlZ29yaWVzSWRPYmogPSB7fTtcbiAgXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2F0ZWdvcmllc0Fyci5sZW5ndGg7IGkrKykge1xuICAgIGNhdGVnb3JpZXNJZE9ialtjYXRlZ29yaWVzQXJyW2ldLmlkLnNsaWNlKDQpXSA9IDA7XG4gIH1cbiAgXG5cbiAgXG4gIFxuICBcbiAgLy8gXG5cbiAgLy8g0J/QntCU0KHQp9CV0KIg0KLQkNCh0JrQntCSINCf0J4g0JrQkNCi0JXQk9Ce0KDQmNCv0JxcblxuICB2YXIgY291bnRUYXNrcyA9IGZ1bmN0aW9uIChhcnJheSwgb2JqKSB7XG4gICAgXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuXG4gICAgICBcbiAgICAgIGlmIChhcnJheVtpXS5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2stLXdvcmsnKSkge1xuICAgICAgICBvYmoud29yaysrO1xuICAgICAgfSBlbHNlIGlmIChhcnJheVtpXS5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2stLXBlcnNvbmFsJykpe1xuICAgICAgICBvYmoucGVyc29uYWwrKztcbiAgICAgIH0gZWxzZSBpZiAoYXJyYXlbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLS1zaG9wcGluZycpKXtcbiAgICAgICAgb2JqLnNob3BwaW5nKys7XG4gICAgICB9IGVsc2UgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0tZmFtaWx5Jykpe1xuICAgICAgICBvYmouZmFtaWx5Kys7XG4gICAgICB9IGVsc2UgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0td2FybmluZycpKXtcbiAgICAgICAgb2JqLndhcm5pbmcrKztcbiAgICAgIH1cbiAgICAgIFxuICAgIH1cbiAgICByZXR1cm4gb2JqO1xuICB9XG5cblxuICBcblxuICB2YXIgcmVzdWwgPSBjb3VudFRhc2tzKHRhc2tzQXJyLCBjYXRlZ29yaWVzSWRPYmopO1xuICBcbiAgLy8gXG5cbiAgLy8g0J7QmtCe0J3Qp9CQ0J3QmNCVINCh0JvQntCS0JAgXCLQl9CQ0JTQkNCn0JBcIlxuXG4gIHZhciBjb21iaWVuZFRhc2tXb3JkcyA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICBcbiAgICB2YXIgY3VycmVudFZhbHVlQ291bnRlcjtcbiAgICB2YXIgcENvdW50ZXI7XG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICBwQ291bnRlciA9IGNhdGVnb3J5TGlzdC5xdWVyeVNlbGVjdG9yKCcjY2F0XycgKyBrZXkgKyAnIC5jYXRlZ29yeV9fY291bnQnKTtcbiAgICAgIGN1cnJlbnRWYWx1ZUNvdW50ZXIgPSBvYmpba2V5XSA7XG4gICAgICBpZiAoY3VycmVudFZhbHVlQ291bnRlciA9PT0gMCkge1xuICAgICAgICBwQ291bnRlci5pbm5lclRleHQgPSAn0J3QtdGCINC30LDQtNCw0YcnO1xuICAgICAgfSBlbHNlIGlmKGN1cnJlbnRWYWx1ZUNvdW50ZXIgPT09IDEpe1xuICAgICAgICBwQ291bnRlci5pbm5lclRleHQgPSBjdXJyZW50VmFsdWVDb3VudGVyICsgJyDQt9Cw0LTQsNGH0LAnO1xuICAgICAgfSBlbHNlIGlmKGN1cnJlbnRWYWx1ZUNvdW50ZXIgPj0gMiAmJiBjdXJyZW50VmFsdWVDb3VudGVyIDw9IDQpe1xuICAgICAgICBwQ291bnRlci5pbm5lclRleHQgPSBjdXJyZW50VmFsdWVDb3VudGVyICsgJyDQt9Cw0LTQsNGH0LgnO1xuICAgICAgfSBlbHNlIGlmIChjdXJyZW50VmFsdWVDb3VudGVyID49IDUgJiYgY3VycmVudFZhbHVlQ291bnRlciA8PSAyMCkge1xuICAgICAgICBwQ291bnRlci5pbm5lclRleHQgPSBjdXJyZW50VmFsdWVDb3VudGVyICsgJyDQt9Cw0LTQsNGHJztcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIGNvbWJpZW5kVGFza1dvcmRzKHJlc3VsKTtcblxufVxuXG51cGRhdGVEYXRhKCk7XG4gIFxuICBcbi8vINCe0KLQoNCY0KHQntCS0JrQkCDQntCa0J3QkCDQndCe0JLQntCT0J4g0KLQkNCh0JrQkCBcblxudmFyIGNyZWF0ZU5ld1Rhc2sgPSBmdW5jdGlvbigpIHtcblxuLy8g0L7QutC90L5cbiAgdmFyIG5ld1Rhc2tXaW5kb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgbmV3VGFza1dpbmRvdy5jbGFzc0xpc3QuYWRkKCduZXctdGFzaycpO1xuXG4vLyDQutC90L7Qv9C60Lgg0L7RgtC80LXQvdCwINC4INCz0L7RgtC+0LLQviBcbiAgdmFyIGJ0bldyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgdmFyIGJ0bkNhbmNlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICB2YXIgYnRuRG9uZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG4gIGJ0bldyYXBwZXIuYXBwZW5kQ2hpbGQoYnRuQ2FuY2VsKTtcbiAgYnRuV3JhcHBlci5hcHBlbmRDaGlsZChidG5Eb25lKTtcblxuLy8g0YHQv9C40YHQvtC6LdC+0LHQtdGA0YLQutCwINC4INC+0LTQuNC9INGC0LDRgdC6XG4gIHZhciBuZXdUYXNrTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB2YXIgbmV3VGFza0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgdmFyIG5ld1Rhc2tEb25lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHZhciBuZXdUYXNrSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuXG4gIG5ld1Rhc2tJdGVtLmFwcGVuZENoaWxkKG5ld1Rhc2tEb25lKTtcbiAgbmV3VGFza0l0ZW0uYXBwZW5kQ2hpbGQobmV3VGFza0lucHV0KTtcbiAgbmV3VGFza0xpc3QuYXBwZW5kQ2hpbGQobmV3VGFza0l0ZW0pO1xufVxuXG5cblxuLy8g0KDQkNCR0J7QotCQINChINCd0J7QktCr0Jwg0KLQkNCh0JrQntCcXG5cbnZhciBjcmVhdGVUYXNrID0gZnVuY3Rpb24oY3VycmVudCkge1xuXG4gIHZhciBuZXdMaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIG5ld0xpLmNsYXNzTGlzdC5hZGQoJ25ldy10YXNrX19pdGVtJyk7XG4gIHZhciBuZXdEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgbmV3RGl2LmNsYXNzTGlzdC5hZGQoJ25ldy10YXNrX19yZWFkeScpO1xuICB2YXIgbmV3SW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICBuZXdJbnB1dC5pZCA9ICduZXctdGFzay0nICsgY3VycmVudDtcbiAgbmV3SW5wdXQubmFtZSA9ICduZXctdGFzayc7XG4gIG5ld0lucHV0LnR5cGUgPSAndGV4dCc7XG4gIG5ld0lucHV0LnBsYWNlaG9sZGVyID0gJ9Cn0YLQviDQvdGD0LbQvdC+INGB0LTQtdC70LDRgtGMJztcbiAgbmV3TGkuYXBwZW5kQ2hpbGQobmV3RGl2KTtcbiAgbmV3TGkuYXBwZW5kQ2hpbGQobmV3SW5wdXQpO1xuXG4gIHJldHVybiBuZXdMaTtcblxufTtcblxudmFyIGlucHV0TmV3VGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuZXctdGFzay0xJyk7XG52YXIgaXRlbVRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy10YXNrX19pdGVtIGlucHV0Jyk7XG52YXIgY3VycmVudEl0ZW0gPSAxO1xuXG52YXIgYXBwZW5kSW5wdXQgPSBmdW5jdGlvbiAoZSkge1xuICAgIGlmIChlLmtleUNvZGUgPT09IDEzKSB7XG4gICAgICB2YXIgbmV3VGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LXRhc2tfX2xpc3QnKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGN1cnJlbnRJdGVtID0gKytjdXJyZW50SXRlbTtcbiAgICAgIHZhciBuZXdJdGVtVGVtcGxhdGUgPSBjcmVhdGVUYXNrKGN1cnJlbnRJdGVtKTtcbiAgICAgIFxuICAgICAgbmV3SXRlbVRlbXBsYXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBhcHBlbmRJbnB1dCk7XG4gICAgICBuZXdUYXNrTGlzdC5hcHBlbmRDaGlsZChuZXdJdGVtVGVtcGxhdGUpO1xuICAgICAgdmFyIHRhYkl0ZW1tID0gbmV3VGFza0xpc3QucXVlcnlTZWxlY3RvcignI25ldy10YXNrLScgKyBjdXJyZW50SXRlbSk7XG4gICAgICB0YWJJdGVtbS5mb2N1cygpO1xuICAgICAgZS50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFwcGVuZElucHV0KTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbn1cblxuaXRlbVRlbXBsYXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBhcHBlbmRJbnB1dCk7Il19
