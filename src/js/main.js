var taskList=document.querySelector(".task-list"),templateList=document.querySelector(".list-template__task-list"),deleteIcon=document.querySelector(".delete-icon"),deleteIconTemplate=document.querySelector(".delete-icon--template"),taskReadyArr=[].slice.call(taskList.querySelectorAll(".task__ready")),storage=localStorage,dataList={"Начать делать презентацию":"work","Заплатить за аренду":"personal","Купить молоко":"shopping","Не забыть забрать Мишу со школы":"family","Купить шоколад Маше":"shopping"};storage.data=JSON.stringify(dataList);var renderMainList=function(e){var t=document.createDocumentFragment();for(key in e){var a=document.createElement("div");a.classList.add("task"),a.classList.add("task--"+e[key]);var n=document.createElement("div");n.classList.add("task__ready"),a.appendChild(n);var l=document.createElement("p");l.classList.add("task__text"),l.textContent=key,a.appendChild(l),t.appendChild(a)}taskList.appendChild(t)};renderMainList(JSON.parse(storage.data));var doneMark=document.querySelector(".task__ready--done");doneMark&&deleteIcon.classList.add("delete-icon--show");var onTaskDone=function(t){t.addEventListener("click",function(e){e.target.classList.contains("task__ready")&&(e.target.classList.toggle("task__ready--done"),e.target.nextElementSibling.classList.toggle("task__text--done"),e.target.parentElement.classList.toggle("task--done"),t.querySelector(".task__ready--done")?deleteIcon.classList.add("delete-icon--show"):deleteIcon.classList.remove("delete-icon--show"))})};onTaskDone(taskList),deleteIcon.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".task--done")),a=0;a<t.length;a++)t[a].remove();deleteIcon.classList.remove("delete-icon--show"),updateData()});var formBtn=document.querySelector(".form__btn"),btnList=document.querySelector(".create__items"),overlay=document.querySelector(".overlay");formBtn.addEventListener("click",function(e){formBtn.classList.toggle("form__btn--active"),btnList.classList.toggle("create__items--active"),overlay.classList.toggle("overlay--active")});var listTemplate=document.querySelector(".list-template"),templateTitile=listTemplate.querySelector(".list-template__title"),templateCount=listTemplate.querySelector(".list-template__count"),templateTaskList=document.querySelector(".list-template__task-list"),templateItem=document.querySelector(".list-template__task--template"),templateReady=templateItem.querySelector(".list-template__task-ready"),templateText=templateItem.querySelector(".list-template__task-text"),templateDate=templateItem.querySelector("task__date"),categoryList=document.querySelector(".category__list"),callback=function(e){var t=e.target;"LI"===e.target.parentElement.tagName&&(t=e.target.parentElement);var a=getComputedStyle(t).getPropertyValue("background-color"),n=t.firstElementChild.innerText,l=t.lastElementChild.innerText;listTemplate.style.backgroundColor=a,templateTitile.textContent=n,templateCount.textContent=l;var c=t.id.slice(4);!function(){for(var e=[].slice.call(taskList.querySelectorAll(".task--"+c)),t=document.createDocumentFragment(),a=0;a<e.length;a++){var n=document.createElement("div");n.classList.add("list-template__task"),n.classList.add("list-template__task--template");var l=document.createElement("div");l.classList.add("list-template__task-ready"),n.appendChild(l);var s=document.createElement("p");s.classList.add("list-template__task-text"),n.appendChild(s);var r=document.createElement("span");r.classList.add("list-template__task-date"),n.appendChild(r),s.textContent=e[a].textContent,t.appendChild(n)}templateTaskList.innerHTML="",templateTaskList.appendChild(t)}()};categoryList.addEventListener("click",callback),onTaskDone(templateTaskList);var onTaskDoneTemplate=function(t){t.addEventListener("click",function(e){e.target.classList.contains("list-template__task-ready")&&(e.target.classList.toggle("list-template__task-ready--done"),e.target.nextElementSibling.classList.toggle("list-template__task-text--done"),e.target.parentElement.classList.toggle("list-template__task--done"),t.querySelector(".list-template__task-ready--done")?deleteIconTemplate.classList.add("delete-icon--show"):deleteIconTemplate.classList.remove("delete-icon--show"))})};onTaskDoneTemplate(templateList),deleteIconTemplate.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".list-template__task--done")),a=[],n=0;n<t.length;n++)a[n]=t[n].textContent,t[n].remove();var l=[].slice.call(taskList.querySelectorAll(".task"));for(n=0;n<t.length;n++)for(var s=0;s<l.length;s++)l[s].textContent===t[n].textContent&&l[s].remove();deleteIconTemplate.classList.remove("delete-icon--show"),updateData()});var updateData=function(){for(var e=[].slice.call(taskList.querySelectorAll(".task")),t=[].slice.call(categoryList.querySelectorAll(".category__item")),a={},n=0;n<t.length;n++)a[t[n].id.slice(4)]=0;!function(e){var t,a;for(key in e)a=categoryList.querySelector("#cat_"+key+" .category__count"),0===(t=e[key])?a.innerText="Нет задач":1===t?a.innerText=t+" задача":2<=t&&t<=4?a.innerText=t+" задачи":5<=t&&t<=20&&(a.innerText=t+" задач")}(function(e,t){for(var a=0;a<e.length;a++)e[a].classList.contains("task--work")?t.work++:e[a].classList.contains("task--personal")?t.personal++:e[a].classList.contains("task--shopping")?t.shopping++:e[a].classList.contains("task--family")?t.family++:e[a].classList.contains("task--warning")&&t.warning++;return t}(e,a))};updateData();var createNewTask=function(){document.createElement("div").classList.add("new-task");var e=document.createElement("div"),t=document.createElement("button"),a=document.createElement("button");e.appendChild(t),e.appendChild(a);var n=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div"),r=document.createElement("input");l.appendChild(s),l.appendChild(r),n.appendChild(l)},createTask=function(e){var t=document.createElement("li");t.classList.add("new-task__item");var a=document.createElement("div");a.classList.add("new-task__ready");var n=document.createElement("input");return n.id="new-task-"+e,n.name="new-task",n.type="text",n.placeholder="Что нужно сделать ?",t.appendChild(a),t.appendChild(n),t},removeInput=function(e){e.target.value||e.target.remove()},inputNewTask=document.querySelector("#new-task-1"),itemTemplate=document.querySelector(".new-task__item input"),currentItem=1,appendInput=function(e){if(13===e.keyCode&&0==!e.target.value){var t=document.querySelector(".new-task__list");e.preventDefault(),currentItem=++currentItem;var a=createTask(currentItem);a.addEventListener("keydown",appendInput),t.appendChild(a),t.querySelector("#new-task-"+currentItem).focus(),e.target.removeEventListener("keydown",appendInput),e.preventDefault()}13===e.keyCode&&0==e.target.value&&e.preventDefault(),0==e.target.value&&8===e.keyCode&&(e.target.parentNode.previousElementSibling.lastElementChild.focus(),e.target.parentNode.remove())};itemTemplate.addEventListener("keydown",appendInput);var newTaskScreen=document.querySelector(".new-task"),firstInput=document.querySelector("#new-task-1"),taskBtnDone=document.querySelector(".new-task__btn--done"),taskBtnCancel=document.querySelector(".new-task__btn--cancel");firstInput.addEventListener("input",function(e){e.target.value?taskBtnDone.classList.remove("new-task__btn--hide"):taskBtnDone.classList.add("new-task__btn--hide")}),taskBtnCancel.addEventListener("click",function(e){e.preventDefault(),newTaskScreen.classList.add("new-task--hide");var t=document.querySelector(".task__text");console.dir(t.textContent)}),taskBtnDone.addEventListener("click",function(e){e.preventDefault();for(var t=newTaskScreen.querySelectorAll(".new-task__item input"),a=newTaskScreen.querySelector(".new-task__cat-item input:checked").value,n={},l=0;l<t.length;l++)t[l].value&&(n[t[l].value]=a);storage.data=JSON.stringify(n),newTaskScreen.classList.add("new-task--hide"),renderMainList(JSON.parse(storage.data)),updateData()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhc2stbWFyay1hbmltYXRlLmpzIl0sIm5hbWVzIjpbInRhc2tMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGVtcGxhdGVMaXN0IiwiZGVsZXRlSWNvbiIsImRlbGV0ZUljb25UZW1wbGF0ZSIsInRhc2tSZWFkeUFyciIsInNsaWNlIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwiZGF0YUxpc3QiLCLQndCw0YfQsNGC0Ywg0LTQtdC70LDRgtGMINC/0YDQtdC30LXQvdGC0LDRhtC40Y4iLCLQl9Cw0L/Qu9Cw0YLQuNGC0Ywg0LfQsCDQsNGA0LXQvdC00YMiLCLQmtGD0L/QuNGC0Ywg0LzQvtC70L7QutC+Iiwi0J3QtSDQt9Cw0LHRi9GC0Ywg0LfQsNCx0YDQsNGC0Ywg0JzQuNGI0YMg0YHQviDRiNC60L7Qu9GLIiwi0JrRg9C/0LjRgtGMINGI0L7QutC+0LvQsNC0INCc0LDRiNC1IiwiZGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZW5kZXJNYWluTGlzdCIsIm9iaiIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImtleSIsInRhc2tJdGVtIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInRhc2tJdGVtUmVhZHkiLCJhcHBlbmRDaGlsZCIsInRhc2tJdGVtVGV4dCIsInRleHRDb250ZW50IiwicGFyc2UiLCJkb25lTWFyayIsIm9uVGFza0RvbmUiLCJ3cmFwcGVyTm9kZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJ0b2dnbGUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwidGFza0RvbmVBcnIiLCJpIiwibGVuZ3RoIiwidXBkYXRlRGF0YSIsImZvcm1CdG4iLCJidG5MaXN0Iiwib3ZlcmxheSIsImxpc3RUZW1wbGF0ZSIsInRlbXBsYXRlVGl0aWxlIiwidGVtcGxhdGVDb3VudCIsInRlbXBsYXRlVGFza0xpc3QiLCJ0ZW1wbGF0ZUl0ZW0iLCJ0ZW1wbGF0ZVJlYWR5IiwidGVtcGxhdGVUZXh0IiwidGVtcGxhdGVEYXRlIiwiY2F0ZWdvcnlMaXN0IiwiY2FsbGJhY2siLCJ0YXJnIiwidGFnTmFtZSIsImNvbG9yVGFyZ2V0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImdldFByb3BlcnR5VmFsdWUiLCJ0aXRsZVRhcmdldCIsImZpcnN0RWxlbWVudENoaWxkIiwiaW5uZXJUZXh0IiwiY291bnRlclRhcmdldCIsImxhc3RFbGVtZW50Q2hpbGQiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImlkQ2F0ZWdvcnkiLCJpZCIsInRlbXBsYXRlVGFza0FyciIsIm5ld0l0ZW0iLCJuZXdJdGVtUmVhZHkiLCJuZXdJdGVtVGV4dCIsIm5ld0l0ZW1EYXRlIiwiaW5uZXJIVE1MIiwiY3JlYXRlVGFza0VsZW0iLCJvblRhc2tEb25lVGVtcGxhdGUiLCJ0ZXh0Q29udGVudEFyciIsInRhc2tzQXJyIiwiayIsImNhdGVnb3JpZXNBcnIiLCJjYXRlZ29yaWVzSWRPYmoiLCJjdXJyZW50VmFsdWVDb3VudGVyIiwicENvdW50ZXIiLCJjb21iaWVuZFRhc2tXb3JkcyIsImFycmF5Iiwid29yayIsInBlcnNvbmFsIiwic2hvcHBpbmciLCJmYW1pbHkiLCJ3YXJuaW5nIiwiY291bnRUYXNrcyIsImNyZWF0ZU5ld1Rhc2siLCJidG5XcmFwcGVyIiwiYnRuQ2FuY2VsIiwiYnRuRG9uZSIsIm5ld1Rhc2tMaXN0IiwibmV3VGFza0l0ZW0iLCJuZXdUYXNrRG9uZSIsIm5ld1Rhc2tJbnB1dCIsImNyZWF0ZVRhc2siLCJjdXJyZW50IiwibmV3TGkiLCJuZXdEaXYiLCJuZXdJbnB1dCIsIm5hbWUiLCJ0eXBlIiwicGxhY2Vob2xkZXIiLCJyZW1vdmVJbnB1dCIsInZhbHVlIiwiaW5wdXROZXdUYXNrIiwiaXRlbVRlbXBsYXRlIiwiY3VycmVudEl0ZW0iLCJhcHBlbmRJbnB1dCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsIm5ld0l0ZW1UZW1wbGF0ZSIsImZvY3VzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInBhcmVudE5vZGUiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwibmV3VGFza1NjcmVlbiIsImZpcnN0SW5wdXQiLCJ0YXNrQnRuRG9uZSIsInRhc2tCdG5DYW5jZWwiLCJ0YXNrRG9uZSIsImNvbnNvbGUiLCJkaXIiLCJhbGxOZXdJdGVtcyIsImNhdGVnb3J5TmFtZSIsImRhdGFOZXdMaXN0Il0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxTQUFXQyxTQUFTQyxjQUFjLGNBQ2xDQyxhQUFlRixTQUFTQyxjQUFjLDZCQUN0Q0UsV0FBYUgsU0FBU0MsY0FBYyxnQkFDcENHLG1CQUFxQkosU0FBU0MsY0FBYywwQkFDNUNJLGFBQWUsR0FBR0MsTUFBTUMsS0FBS1IsU0FBU1MsaUJBQWlCLGlCQUV2REMsUUFBVUMsYUFFVkMsU0FBVyxDQUNiQyw0QkFBNkIsT0FDN0JDLHNCQUF1QixXQUN2QkMsZ0JBQWlCLFdBQ2pCQyxrQ0FBbUMsU0FDbkNDLHNCQUF1QixZQUt6QlAsUUFBUVEsS0FBT0MsS0FBS0MsVUFBVVIsVUFTOUIsSUFBSVMsZUFBaUIsU0FBVUMsR0FDN0IsSUFBSUMsRUFBV3RCLFNBQVN1Qix5QkFFeEIsSUFBS0MsT0FBT0gsRUFBSyxDQUVmLElBQUlJLEVBQVd6QixTQUFTMEIsY0FBYyxPQUN0Q0QsRUFBU0UsVUFBVUMsSUFBSSxRQUN2QkgsRUFBU0UsVUFBVUMsSUFBSSxTQUFXUCxFQUFJRyxNQUV0QyxJQUFJSyxFQUFnQjdCLFNBQVMwQixjQUFjLE9BQzNDRyxFQUFjRixVQUFVQyxJQUFJLGVBQzVCSCxFQUFTSyxZQUFZRCxHQUVyQixJQUFJRSxFQUFlL0IsU0FBUzBCLGNBQWMsS0FDMUNLLEVBQWFKLFVBQVVDLElBQUksY0FDM0JHLEVBQWFDLFlBQWNSLElBQzNCQyxFQUFTSyxZQUFZQyxHQUVyQlQsRUFBU1EsWUFBWUwsR0FHdkIxQixTQUFTK0IsWUFBWVIsSUFJdkJGLGVBQWVGLEtBQUtlLE1B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QUFlRixLQUFLZSxNQUFNeEIsUUFBUVEsT0FDbEMrQiIsImZpbGUiOiJ0YXNrLW1hcmstYW5pbWF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB0YXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWxpc3QnKTtcclxudmFyIHRlbXBsYXRlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190YXNrLWxpc3QnKTtcclxudmFyIGRlbGV0ZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGVsZXRlLWljb24nKTtcclxudmFyIGRlbGV0ZUljb25UZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZWxldGUtaWNvbi0tdGVtcGxhdGUnKTtcclxudmFyIHRhc2tSZWFkeUFyciA9IFtdLnNsaWNlLmNhbGwodGFza0xpc3QucXVlcnlTZWxlY3RvckFsbCgnLnRhc2tfX3JlYWR5JykpO1xyXG5cclxudmFyIHN0b3JhZ2UgPSBsb2NhbFN0b3JhZ2U7XHJcblxyXG52YXIgZGF0YUxpc3QgPSB7XHJcbiAgXCLQndCw0YfQsNGC0Ywg0LTQtdC70LDRgtGMINC/0YDQtdC30LXQvdGC0LDRhtC40Y5cIjogXCJ3b3JrXCIsXHJcbiAgXCLQl9Cw0L/Qu9Cw0YLQuNGC0Ywg0LfQsCDQsNGA0LXQvdC00YNcIjogXCJwZXJzb25hbFwiLFxyXG4gIFwi0JrRg9C/0LjRgtGMINC80L7Qu9C+0LrQvlwiOiBcInNob3BwaW5nXCIsXHJcbiAgXCLQndC1INC30LDQsdGL0YLRjCDQt9Cw0LHRgNCw0YLRjCDQnNC40YjRgyDRgdC+INGI0LrQvtC70YtcIjogXCJmYW1pbHlcIixcclxuICBcItCa0YPQv9C40YLRjCDRiNC+0LrQvtC70LDQtCDQnNCw0YjQtVwiOiBcInNob3BwaW5nXCJcclxuXHJcblxyXG59O1xyXG5cclxuc3RvcmFnZS5kYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YUxpc3QpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vLyDQpNCe0KDQnNCY0KDQntCS0JDQndCY0JUg0KHQotCQ0KDQotCe0JLQntCT0J4g0KHQn9CY0KHQmtCQXHJcblxyXG52YXIgcmVuZGVyTWFpbkxpc3QgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICBmb3IgKGtleSBpbiBvYmopIHtcclxuXHJcbiAgICB2YXIgdGFza0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRhc2tJdGVtLmNsYXNzTGlzdC5hZGQoJ3Rhc2snKTtcclxuICAgIHRhc2tJdGVtLmNsYXNzTGlzdC5hZGQoJ3Rhc2stLScgKyBvYmpba2V5XSk7XHJcblxyXG4gICAgdmFyIHRhc2tJdGVtUmVhZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRhc2tJdGVtUmVhZHkuY2xhc3NMaXN0LmFkZCgndGFza19fcmVhZHknKTtcclxuICAgIHRhc2tJdGVtLmFwcGVuZENoaWxkKHRhc2tJdGVtUmVhZHkpO1xyXG5cclxuICAgIHZhciB0YXNrSXRlbVRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICB0YXNrSXRlbVRleHQuY2xhc3NMaXN0LmFkZCgndGFza19fdGV4dCcpO1xyXG4gICAgdGFza0l0ZW1UZXh0LnRleHRDb250ZW50ID0ga2V5O1xyXG4gICAgdGFza0l0ZW0uYXBwZW5kQ2hpbGQodGFza0l0ZW1UZXh0KTtcclxuXHJcbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0YXNrSXRlbSk7XHJcbiAgfVxyXG5cclxuICB0YXNrTGlzdC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XHJcblxyXG59O1xyXG5cclxucmVuZGVyTWFpbkxpc3QoSlNPTi5wYXJzZShzdG9yYWdlLmRhdGEpKTtcclxuXHJcblxyXG5cclxuXHJcbi8vINCT0JDQm9Ce0KfQmtCQINCYINCX0JDQp9CV0KDQmtCY0JLQkNCd0JjQlSDQotCQ0KHQmtCQXHJcblxyXG52YXIgZG9uZU1hcmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFza19fcmVhZHktLWRvbmUnKTtcclxuXHJcbmlmIChkb25lTWFyaykge1xyXG4gIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZCgnZGVsZXRlLWljb24tLXNob3cnKTtcclxufVxyXG5cclxuXHJcbnZhciBvblRhc2tEb25lID0gZnVuY3Rpb24gKHdyYXBwZXJOb2RlKSB7XHJcblxyXG4gIHdyYXBwZXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcblxyXG4gICAgLy8g0KPRgdGC0LDQvdC+0LLQutCwINC60LDQu9C+0YfQutC4INGC0LDRgdC60LBcclxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2tfX3JlYWR5JykpIHtcclxuICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgndGFza19fcmVhZHktLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ3Rhc2tfX3RleHQtLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCd0YXNrLS1kb25lJyk7XHJcblxyXG4gICAgICAvLyDQn9C+0Y/QstC70LXQvdC40LUg0LrQvtGA0LfQuNC90LrQuCDQv9GA0Lgg0LLRi9Cx0L7RgNC1INGC0LDRgdC60LBcclxuICAgICAgdmFyIGRvbmVNYXJrID0gd3JhcHBlck5vZGUucXVlcnlTZWxlY3RvcignLnRhc2tfX3JlYWR5LS1kb25lJyk7XHJcblxyXG4gICAgICBpZiAoZG9uZU1hcmspIHtcclxuICAgICAgICBkZWxldGVJY29uLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVsZXRlSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xyXG4gICAgICB9XHJcbiAgICB9IFxyXG4gICAgXHJcbiAgfSk7XHJcbn1cclxuXHJcbm9uVGFza0RvbmUodGFza0xpc3QpO1xyXG4vLyBcclxuLy8gXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8g0KPQlNCQ0JvQldCd0JjQlSDQotCQ0KHQmtCQXHJcblxyXG5cclxuZGVsZXRlSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgdmFyIHRhc2tEb25lQXJyID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay0tZG9uZScpKTtcclxuXHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXNrRG9uZUFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgdGFza0RvbmVBcnJbaV0ucmVtb3ZlKCk7XHJcbiAgICBcclxuICB9XHJcblxyXG4gIGRlbGV0ZUljb24uY2xhc3NMaXN0LnJlbW92ZSgnZGVsZXRlLWljb24tLXNob3cnKTtcclxuXHJcbiAgdXBkYXRlRGF0YSgpO1xyXG5cclxufSk7XHJcblxyXG4vLyBcclxuLy8gXHJcblxyXG5cclxuLy8gYnRuLXBsdXNcclxuXHJcbnZhciBmb3JtQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2J0bicpO1xyXG52YXIgYnRuTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGVfX2l0ZW1zJyk7XHJcbnZhciBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKTtcclxuXHJcbmZvcm1CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICBmb3JtQnRuLmNsYXNzTGlzdC50b2dnbGUoJ2Zvcm1fX2J0bi0tYWN0aXZlJyk7XHJcbiAgYnRuTGlzdC5jbGFzc0xpc3QudG9nZ2xlKCdjcmVhdGVfX2l0ZW1zLS1hY3RpdmUnKTtcclxuICBvdmVybGF5LmNsYXNzTGlzdC50b2dnbGUoJ292ZXJsYXktLWFjdGl2ZScpO1xyXG59KTtcclxuLy8gXHJcbi8vIFxyXG5cclxuXHJcblxyXG4vLyBsaXN0LXRlbXBsYXRlXHJcblxyXG4vLyDQodCe0JfQlNCQ0J3QmNCVINCX0JDQk9Ce0JvQntCS0JrQkCDQmCDQptCS0JXQotCQINCa0JDQoNCi0J7Qp9Ca0JhcclxudmFyIGxpc3RUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlJyk7XHJcbnZhciB0ZW1wbGF0ZVRpdGlsZSA9IGxpc3RUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGl0bGUnKTtcclxudmFyIHRlbXBsYXRlQ291bnQgPSBsaXN0VGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX2NvdW50Jyk7XHJcblxyXG4vLyB0ZW1wbGF0ZS1saXN0XHJcbnZhciB0ZW1wbGF0ZVRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stbGlzdCcpO1xyXG52YXIgdGVtcGxhdGVJdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stLXRlbXBsYXRlJyk7XHJcbnZhciB0ZW1wbGF0ZVJlYWR5ID0gdGVtcGxhdGVJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190YXNrLXJlYWR5Jyk7XHJcbnZhciB0ZW1wbGF0ZVRleHQgPSB0ZW1wbGF0ZUl0ZW0ucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dCcpO1xyXG52YXIgdGVtcGxhdGVEYXRlID0gdGVtcGxhdGVJdGVtLnF1ZXJ5U2VsZWN0b3IoJ3Rhc2tfX2RhdGUnKTtcclxuXHJcblxyXG52YXIgY2F0ZWdvcnlMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhdGVnb3J5X19saXN0Jyk7XHJcblxyXG5cclxuXHJcblxyXG5cclxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oZSl7XHJcbiAgdmFyIHRhcmcgPSBlLnRhcmdldDtcclxuXHJcbiAgLy8g0YTQuNC60YEg0LLRi9Cx0L7RgNCwINC60LDRgNGC0L7Rh9C60LhcclxuICBpZiAoZS50YXJnZXQucGFyZW50RWxlbWVudC50YWdOYW1lID09PSAnTEknKSB7XHJcbiAgIHRhcmcgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50O1xyXG4gIH1cclxuICBcclxuXHJcblxyXG5cclxuICAvLyDQv9C+0LvRg9GH0LjQvCDRhtCy0LXRgiwg0LfQsNCz0L7Qu9C+0LLQvtC6LCDRgdGH0LXRgtGH0LjQuiDQutCw0YLQtdCz0L7RgNC40LhcclxuICB2YXIgY29sb3JUYXJnZXQgPSBnZXRDb21wdXRlZFN0eWxlKHRhcmcpLmdldFByb3BlcnR5VmFsdWUoJ2JhY2tncm91bmQtY29sb3InKTtcclxuICB2YXIgdGl0bGVUYXJnZXQgPSB0YXJnLmZpcnN0RWxlbWVudENoaWxkLmlubmVyVGV4dDtcclxuICB2YXIgY291bnRlclRhcmdldCA9IHRhcmcubGFzdEVsZW1lbnRDaGlsZC5pbm5lclRleHQ7XHJcblxyXG5cclxuICAvL9C30LDQtNCw0LTQuNC8INGG0LLQtdGCLCDQt9Cw0LPQvtC70L7QstC+0LosINGB0YfQtdGC0YfQuNC6INC60LDRgNGC0L7Rh9C60LhcclxuICBsaXN0VGVtcGxhdGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3JUYXJnZXQ7XHJcbiAgdGVtcGxhdGVUaXRpbGUudGV4dENvbnRlbnQgPSAgdGl0bGVUYXJnZXQ7XHJcbiAgdGVtcGxhdGVDb3VudC50ZXh0Q29udGVudCA9IGNvdW50ZXJUYXJnZXQ7XHJcblxyXG5cclxuXHJcbiAgLy8gXHJcbiAgLy8gXHJcblxyXG4gIC8vINGB0L7QsdC10YDQtdC8INGB0L/QuNGB0L7QuiDQt9Cw0LTQsNGHXHJcbiAgdmFyIGlkQ2F0ZWdvcnkgPSB0YXJnLmlkLnNsaWNlKDQpO1xyXG5cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlVGFza0VsZW0oKSB7XHJcblxyXG4gICAgdmFyIHRlbXBsYXRlVGFza0FyciA9IFtdLnNsaWNlLmNhbGwodGFza0xpc3QucXVlcnlTZWxlY3RvckFsbCgnLnRhc2stLScgKyBpZENhdGVnb3J5KSk7XHJcblxyXG4gICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG4gICAgXHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZW1wbGF0ZVRhc2tBcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdmFyIG5ld0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgbmV3SXRlbS5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrJyk7XHJcbiAgICAgIG5ld0l0ZW0uY2xhc3NMaXN0LmFkZCgnbGlzdC10ZW1wbGF0ZV9fdGFzay0tdGVtcGxhdGUnKTtcclxuXHJcbiAgICAgIHZhciBuZXdJdGVtUmVhZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgbmV3SXRlbVJlYWR5LmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stcmVhZHknKTtcclxuICAgICAgbmV3SXRlbS5hcHBlbmRDaGlsZChuZXdJdGVtUmVhZHkpO1xyXG5cclxuICAgICAgdmFyIG5ld0l0ZW1UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgICBuZXdJdGVtVGV4dC5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrLXRleHQnKTtcclxuICAgICAgbmV3SXRlbS5hcHBlbmRDaGlsZChuZXdJdGVtVGV4dCk7XHJcblxyXG4gICAgICB2YXIgbmV3SXRlbURhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgIG5ld0l0ZW1EYXRlLmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stZGF0ZScpO1xyXG4gICAgICBuZXdJdGVtLmFwcGVuZENoaWxkKG5ld0l0ZW1EYXRlKTtcclxuICAgICAgbmV3SXRlbVRleHQudGV4dENvbnRlbnQgPSB0ZW1wbGF0ZVRhc2tBcnJbaV0udGV4dENvbnRlbnQ7XHJcbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKG5ld0l0ZW0pO1xyXG4gICAgICBcclxuICAgIH1cclxuICAgIFxyXG4gICAgdGVtcGxhdGVUYXNrTGlzdC5pbm5lckhUTUw9ICcnO1xyXG4gICAgdGVtcGxhdGVUYXNrTGlzdC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XHJcbiAgfVxyXG5cclxuXHJcbiAgY3JlYXRlVGFza0VsZW0oKTtcclxuICBcclxuXHJcbiAgXHJcbn07XHJcblxyXG5jYXRlZ29yeUxpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjYWxsYmFjayk7XHJcblxyXG5vblRhc2tEb25lKHRlbXBsYXRlVGFza0xpc3QpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vLyDQk9Cw0LvQvtGH0LrQsCDQuCDQv9C+0Y/QstC70LXQvdC40LUg0LrQvtGA0LfQuNC90LrQuCDQsiDQutCw0YDRgtC+0YfQutC1XHJcblxyXG52YXIgb25UYXNrRG9uZVRlbXBsYXRlID0gZnVuY3Rpb24gKHdyYXBwZXJOb2RlKSB7XHJcblxyXG4gIHdyYXBwZXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcblxyXG4gICAgLy8g0KPRgdGC0LDQvdC+0LLQutCwINC60LDQu9C+0YfQutC4INGC0LDRgdC60LBcclxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stcmVhZHknKSkge1xyXG4gICAgICBlLnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LXRlbXBsYXRlX190YXNrLXJlYWR5LS1kb25lJyk7XHJcbiAgICAgIGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LXRlbXBsYXRlX190YXNrLXRleHQtLWRvbmUnKTtcclxuICAgICAgZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LXRlbXBsYXRlX190YXNrLS1kb25lJyk7XHJcblxyXG4gICAgICAvLyDQn9C+0Y/QstC70LXQvdC40LUg0LrQvtGA0LfQuNC90LrQuCDQv9GA0Lgg0LLRi9Cx0L7RgNC1INGC0LDRgdC60LBcclxuICAgICAgdmFyIGRvbmVNYXJrID0gd3JhcHBlck5vZGUucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stcmVhZHktLWRvbmUnKTtcclxuXHJcbiAgICAgIGlmIChkb25lTWFyaykge1xyXG4gICAgICAgIGRlbGV0ZUljb25UZW1wbGF0ZS5jbGFzc0xpc3QuYWRkKCdkZWxldGUtaWNvbi0tc2hvdycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRlbGV0ZUljb25UZW1wbGF0ZS5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xyXG4gICAgICB9XHJcbiAgICB9IFxyXG4gICAgXHJcbiAgfSk7XHJcbn1cclxuXHJcbm9uVGFza0RvbmVUZW1wbGF0ZSh0ZW1wbGF0ZUxpc3QpO1xyXG5cclxuLy8g0KPQlNCQ0JvQldCd0JjQlSDQotCQ0KHQmtCQINCSINCa0JDQoNCi0J7Qp9Ca0JVcclxuXHJcbmRlbGV0ZUljb25UZW1wbGF0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgdmFyIHRhc2tEb25lQXJyID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubGlzdC10ZW1wbGF0ZV9fdGFzay0tZG9uZScpKTtcclxuXHJcbiAgdmFyIHRleHRDb250ZW50QXJyID0gW107XHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXNrRG9uZUFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgdGV4dENvbnRlbnRBcnJbaV0gPSB0YXNrRG9uZUFycltpXS50ZXh0Q29udGVudDtcclxuICAgIHRhc2tEb25lQXJyW2ldLnJlbW92ZSgpO1xyXG4gICAgXHJcbiAgfVxyXG5cclxuICB2YXIgdGFza3NBcnIgPSBbXS5zbGljZS5jYWxsKHRhc2tMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrJykpO1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGFza0RvbmVBcnIubGVuZ3RoOyBpKyspIHtcclxuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdGFza3NBcnIubGVuZ3RoOyBrKyspIHtcclxuICAgICAgaWYgKHRhc2tzQXJyW2tdLnRleHRDb250ZW50ID09PSB0YXNrRG9uZUFycltpXS50ZXh0Q29udGVudCkge1xyXG4gICAgICAgIHRhc2tzQXJyW2tdLnJlbW92ZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgfVxyXG5cclxuXHJcblxyXG4gIGRlbGV0ZUljb25UZW1wbGF0ZS5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xyXG5cclxuXHJcbiAgdXBkYXRlRGF0YSgpO1xyXG5cclxufSk7XHJcblxyXG5cclxuLy8g0JrQntCb0JjQp9CV0KHQotCS0J4g0JfQkNCU0JDQp1xyXG4gXHJcblxyXG5cclxudmFyIHVwZGF0ZURhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgLy8g0YHQvtCx0LXRgNC10Lwg0Lgg0YHQs9GA0YPQv9C40YDRg9C10Lwg0YLQsNGB0LrQuCDQv9C+INC60LDRgtC10LPQvtGA0LjRj9C8INCyINC+0LHRjNC10LrRglxyXG5cclxuICB2YXIgdGFza3NBcnIgPSBbXS5zbGljZS5jYWxsKHRhc2tMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrJykpO1xyXG5cclxuICB2YXIgY2F0ZWdvcmllc0FyciA9IFtdLnNsaWNlLmNhbGwoY2F0ZWdvcnlMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXRlZ29yeV9faXRlbScpKTtcclxuXHJcbiAgdmFyIGNhdGVnb3JpZXNJZE9iaiA9IHt9O1xyXG4gIFxyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2F0ZWdvcmllc0Fyci5sZW5ndGg7IGkrKykge1xyXG4gICAgY2F0ZWdvcmllc0lkT2JqW2NhdGVnb3JpZXNBcnJbaV0uaWQuc2xpY2UoNCldID0gMDtcclxuICB9XHJcbiAgXHJcblxyXG4gIFxyXG4gIFxyXG4gIFxyXG4gIC8vIFxyXG5cclxuICAvLyDQn9Ce0JTQodCn0JXQoiDQotCQ0KHQmtCe0JIg0J/QniDQmtCQ0KLQldCT0J7QoNCY0K/QnFxyXG5cclxuICB2YXIgY291bnRUYXNrcyA9IGZ1bmN0aW9uIChhcnJheSwgb2JqKSB7XHJcbiAgICBcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXJyYXlbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLS13b3JrJykpIHtcclxuICAgICAgICBvYmoud29yaysrO1xyXG4gICAgICB9IGVsc2UgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0tcGVyc29uYWwnKSl7XHJcbiAgICAgICAgb2JqLnBlcnNvbmFsKys7XHJcbiAgICAgIH0gZWxzZSBpZiAoYXJyYXlbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLS1zaG9wcGluZycpKXtcclxuICAgICAgICBvYmouc2hvcHBpbmcrKztcclxuICAgICAgfSBlbHNlIGlmIChhcnJheVtpXS5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2stLWZhbWlseScpKXtcclxuICAgICAgICBvYmouZmFtaWx5Kys7XHJcbiAgICAgIH0gZWxzZSBpZiAoYXJyYXlbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLS13YXJuaW5nJykpe1xyXG4gICAgICAgIG9iai53YXJuaW5nKys7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9XHJcbiAgICByZXR1cm4gb2JqO1xyXG4gIH1cclxuXHJcblxyXG4gIFxyXG5cclxuICB2YXIgcmVzdWwgPSBjb3VudFRhc2tzKHRhc2tzQXJyLCBjYXRlZ29yaWVzSWRPYmopO1xyXG4gIFxyXG4gIC8vIFxyXG5cclxuICAvLyDQntCa0J7QndCn0JDQndCY0JUg0KHQm9Ce0JLQkCBcItCX0JDQlNCQ0KfQkFwiXHJcblxyXG4gIHZhciBjb21iaWVuZFRhc2tXb3JkcyA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgIFxyXG4gICAgdmFyIGN1cnJlbnRWYWx1ZUNvdW50ZXI7XHJcbiAgICB2YXIgcENvdW50ZXI7XHJcbiAgICBmb3IgKGtleSBpbiBvYmopIHtcclxuICAgICAgcENvdW50ZXIgPSBjYXRlZ29yeUxpc3QucXVlcnlTZWxlY3RvcignI2NhdF8nICsga2V5ICsgJyAuY2F0ZWdvcnlfX2NvdW50Jyk7XHJcbiAgICAgIGN1cnJlbnRWYWx1ZUNvdW50ZXIgPSBvYmpba2V5XSA7XHJcbiAgICAgIGlmIChjdXJyZW50VmFsdWVDb3VudGVyID09PSAwKSB7XHJcbiAgICAgICAgcENvdW50ZXIuaW5uZXJUZXh0ID0gJ9Cd0LXRgiDQt9Cw0LTQsNGHJztcclxuICAgICAgfSBlbHNlIGlmKGN1cnJlbnRWYWx1ZUNvdW50ZXIgPT09IDEpe1xyXG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9IGN1cnJlbnRWYWx1ZUNvdW50ZXIgKyAnINC30LDQtNCw0YfQsCc7XHJcbiAgICAgIH0gZWxzZSBpZihjdXJyZW50VmFsdWVDb3VudGVyID49IDIgJiYgY3VycmVudFZhbHVlQ291bnRlciA8PSA0KXtcclxuICAgICAgICBwQ291bnRlci5pbm5lclRleHQgPSBjdXJyZW50VmFsdWVDb3VudGVyICsgJyDQt9Cw0LTQsNGH0LgnO1xyXG4gICAgICB9IGVsc2UgaWYgKGN1cnJlbnRWYWx1ZUNvdW50ZXIgPj0gNSAmJiBjdXJyZW50VmFsdWVDb3VudGVyIDw9IDIwKSB7XHJcbiAgICAgICAgcENvdW50ZXIuaW5uZXJUZXh0ID0gY3VycmVudFZhbHVlQ291bnRlciArICcg0LfQsNC00LDRhyc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICBjb21iaWVuZFRhc2tXb3JkcyhyZXN1bCk7XHJcblxyXG59XHJcblxyXG51cGRhdGVEYXRhKCk7XHJcbiAgXHJcbiAgXHJcbi8vINCe0KLQoNCY0KHQntCS0JrQkCDQntCa0J3QkCDQndCe0JLQntCT0J4g0KLQkNCh0JrQkCBcclxuXHJcbnZhciBjcmVhdGVOZXdUYXNrID0gZnVuY3Rpb24oKSB7XHJcblxyXG4vLyDQvtC60L3QvlxyXG4gIHZhciBuZXdUYXNrV2luZG93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgbmV3VGFza1dpbmRvdy5jbGFzc0xpc3QuYWRkKCduZXctdGFzaycpO1xyXG5cclxuLy8g0LrQvdC+0L/QutC4INC+0YLQvNC10L3QsCDQuCDQs9C+0YLQvtCy0L4gXHJcbiAgdmFyIGJ0bldyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICB2YXIgYnRuQ2FuY2VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgdmFyIGJ0bkRvbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuXHJcbiAgYnRuV3JhcHBlci5hcHBlbmRDaGlsZChidG5DYW5jZWwpO1xyXG4gIGJ0bldyYXBwZXIuYXBwZW5kQ2hpbGQoYnRuRG9uZSk7XHJcblxyXG4vLyDRgdC/0LjRgdC+0Lot0L7QsdC10YDRgtC60LAg0Lgg0L7QtNC40L0g0YLQsNGB0LpcclxuICB2YXIgbmV3VGFza0xpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICB2YXIgbmV3VGFza0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICB2YXIgbmV3VGFza0RvbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICB2YXIgbmV3VGFza0lucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuXHJcbiAgbmV3VGFza0l0ZW0uYXBwZW5kQ2hpbGQobmV3VGFza0RvbmUpO1xyXG4gIG5ld1Rhc2tJdGVtLmFwcGVuZENoaWxkKG5ld1Rhc2tJbnB1dCk7XHJcbiAgbmV3VGFza0xpc3QuYXBwZW5kQ2hpbGQobmV3VGFza0l0ZW0pO1xyXG59XHJcblxyXG5cclxuXHJcbi8vINCh0J7Ql9CU0JDQndCY0JUg0J3QntCS0J7Qk9CeINCY0J3Qn9Cj0KLQkCDQlNCb0K8g0JfQkNCf0JjQodCYXHJcblxyXG52YXIgY3JlYXRlVGFzayA9IGZ1bmN0aW9uKGN1cnJlbnQpIHtcclxuXHJcbiAgdmFyIG5ld0xpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBuZXdMaS5jbGFzc0xpc3QuYWRkKCduZXctdGFza19faXRlbScpO1xyXG4gIHZhciBuZXdEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBuZXdEaXYuY2xhc3NMaXN0LmFkZCgnbmV3LXRhc2tfX3JlYWR5Jyk7XHJcbiAgdmFyIG5ld0lucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICBuZXdJbnB1dC5pZCA9ICduZXctdGFzay0nICsgY3VycmVudDtcclxuICBuZXdJbnB1dC5uYW1lID0gJ25ldy10YXNrJztcclxuICBuZXdJbnB1dC50eXBlID0gJ3RleHQnO1xyXG4gIG5ld0lucHV0LnBsYWNlaG9sZGVyID0gJ9Cn0YLQviDQvdGD0LbQvdC+INGB0LTQtdC70LDRgtGMID8nO1xyXG4gIG5ld0xpLmFwcGVuZENoaWxkKG5ld0Rpdik7XHJcbiAgbmV3TGkuYXBwZW5kQ2hpbGQobmV3SW5wdXQpO1xyXG5cclxuICByZXR1cm4gbmV3TGk7XHJcblxyXG59O1xyXG5cclxuLy8gXHJcbi8vIFxyXG5cclxudmFyIHJlbW92ZUlucHV0ID0gZnVuY3Rpb24gKGUpIHtcclxuICBpZiAoIWUudGFyZ2V0LnZhbHVlKSB7XHJcbiAgICBlLnRhcmdldC5yZW1vdmUoKTtcclxuICB9XHJcbn1cclxuXHJcbnZhciBpbnB1dE5ld1Rhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmV3LXRhc2stMScpO1xyXG52YXIgaXRlbVRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy10YXNrX19pdGVtIGlucHV0Jyk7XHJcbnZhciBjdXJyZW50SXRlbSA9IDE7XHJcblxyXG52YXIgYXBwZW5kSW5wdXQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgaWYgKGUua2V5Q29kZSA9PT0gMTMgJiYgIWUudGFyZ2V0LnZhbHVlID09IDAgKSB7XHJcbiAgICAgIHZhciBuZXdUYXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19fbGlzdCcpO1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGN1cnJlbnRJdGVtID0gKytjdXJyZW50SXRlbTtcclxuICAgICAgdmFyIG5ld0l0ZW1UZW1wbGF0ZSA9IGNyZWF0ZVRhc2soY3VycmVudEl0ZW0pO1xyXG4gICAgICBcclxuICAgICAgbmV3SXRlbVRlbXBsYXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBhcHBlbmRJbnB1dCk7XHJcbiAgICAgIG5ld1Rhc2tMaXN0LmFwcGVuZENoaWxkKG5ld0l0ZW1UZW1wbGF0ZSk7XHJcbiAgICAgIHZhciB0YWJJdGVtbSA9IG5ld1Rhc2tMaXN0LnF1ZXJ5U2VsZWN0b3IoJyNuZXctdGFzay0nICsgY3VycmVudEl0ZW0pO1xyXG4gICAgICB0YWJJdGVtbS5mb2N1cygpO1xyXG4gICAgICBlLnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgYXBwZW5kSW5wdXQpO1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGUua2V5Q29kZSA9PT0gMTMgJiYgZS50YXJnZXQudmFsdWUgPT0gMCApIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBpZiAoZS50YXJnZXQudmFsdWUgPT0gMCAmJiBlLmtleUNvZGUgPT09IDgpIHtcclxuICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmxhc3RFbGVtZW50Q2hpbGQuZm9jdXMoKTtcclxuICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbml0ZW1UZW1wbGF0ZS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgYXBwZW5kSW5wdXQpO1xyXG5cclxuLy9cclxuXHJcbnZhciBuZXdUYXNrU2NyZWVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy10YXNrJyk7XHJcbnZhciBmaXJzdElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ldy10YXNrLTEnKTtcclxudmFyIHRhc2tCdG5Eb25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy10YXNrX19idG4tLWRvbmUnKTtcclxudmFyIHRhc2tCdG5DYW5jZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LXRhc2tfX2J0bi0tY2FuY2VsJyk7XHJcblxyXG4vL9Cf0J7Qr9CS0JvQldCd0JjQlSDQmCDQodCa0KDQq9Ci0JjQlSDQmtCd0J7Qn9Ca0JggXCLQk9Ce0KLQntCS0J5cIlxyXG5cclxuZmlyc3RJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgaWYgKGUudGFyZ2V0LnZhbHVlKSB7XHJcbiAgICB0YXNrQnRuRG9uZS5jbGFzc0xpc3QucmVtb3ZlKCduZXctdGFza19fYnRuLS1oaWRlJyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRhc2tCdG5Eb25lLmNsYXNzTGlzdC5hZGQoJ25ldy10YXNrX19idG4tLWhpZGUnKTtcclxuICB9XHJcbn0pO1xyXG5cclxuXHJcbnRhc2tCdG5DYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBuZXdUYXNrU2NyZWVuLmNsYXNzTGlzdC5hZGQoJ25ldy10YXNrLS1oaWRlJyk7XHJcblxyXG4gIHZhciB0YXNrRG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrX190ZXh0Jyk7XHJcbmNvbnNvbGUuZGlyKHRhc2tEb25lLnRleHRDb250ZW50KTtcclxufSk7XHJcblxyXG5cclxuXHJcbnRhc2tCdG5Eb25lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7ICBcclxuXHJcbiAgdmFyIGFsbE5ld0l0ZW1zID0gbmV3VGFza1NjcmVlbi5xdWVyeVNlbGVjdG9yQWxsKCcubmV3LXRhc2tfX2l0ZW0gaW5wdXQnKTtcclxuICB2YXIgY3VycmVudENhdGVnb3J5ID0gbmV3VGFza1NjcmVlbi5xdWVyeVNlbGVjdG9yKCcubmV3LXRhc2tfX2NhdC1pdGVtIGlucHV0OmNoZWNrZWQnKTtcclxuICB2YXIgY2F0ZWdvcnlOYW1lID0gY3VycmVudENhdGVnb3J5LnZhbHVlO1xyXG4gIHZhciBkYXRhTmV3TGlzdCA9IHt9O1xyXG5cclxuICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbE5ld0l0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBpZiAoYWxsTmV3SXRlbXNbaV0udmFsdWUpIHtcclxuICAgICAgZGF0YU5ld0xpc3RbYWxsTmV3SXRlbXNbaV0udmFsdWVdID0gY2F0ZWdvcnlOYW1lO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgfVxyXG5cclxuICBzdG9yYWdlLmRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhTmV3TGlzdCk7XHJcbiAgbmV3VGFza1NjcmVlbi5jbGFzc0xpc3QuYWRkKCduZXctdGFzay0taGlkZScpO1xyXG4gIHJlbmRlck1haW5MaXN0KEpTT04ucGFyc2Uoc3RvcmFnZS5kYXRhKSk7XHJcbiAgdXBkYXRlRGF0YSgpO1xyXG5cclxufSk7Il19
