var taskList=document.querySelector(".task-list"),templateList=document.querySelector(".list-template__task-list"),deleteIcon=document.querySelector(".delete-icon"),deleteIconTemplate=document.querySelector(".delete-icon--template"),taskReadyArr=[].slice.call(taskList.querySelectorAll(".task__ready")),doneMark=document.querySelector(".task__ready--done");doneMark&&deleteIcon.classList.add("delete-icon--show");var onTaskDone=function(t){t.addEventListener("click",function(e){e.target.classList.contains("task__ready")&&(e.target.classList.toggle("task__ready--done"),e.target.nextElementSibling.classList.toggle("task__text--done"),e.target.parentElement.classList.toggle("task--done"),t.querySelector(".task__ready--done")?deleteIcon.classList.add("delete-icon--show"):deleteIcon.classList.remove("delete-icon--show"))})};onTaskDone(taskList),deleteIcon.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".task--done")),a=0;a<t.length;a++)t[a].remove();deleteIcon.classList.remove("delete-icon--show"),updateData()});var formBtn=document.querySelector(".form__btn"),btnList=document.querySelector(".create__items"),overlay=document.querySelector(".overlay");formBtn.addEventListener("click",function(e){formBtn.classList.toggle("form__btn--active"),btnList.classList.toggle("create__items--active"),overlay.classList.toggle("overlay--active")});var listTemplate=document.querySelector(".list-template"),templateTitile=listTemplate.querySelector(".list-template__title"),templateCount=listTemplate.querySelector(".list-template__count"),templateTaskList=document.querySelector(".list-template__task-list"),templateItem=document.querySelector(".list-template__task--template"),templateReady=templateItem.querySelector(".list-template__task-ready"),templateText=templateItem.querySelector(".list-template__task-text"),templateDate=templateItem.querySelector("task__date"),categoryList=document.querySelector(".category__list"),callback=function(e){var t=e.target;"LI"===event.target.parentElement.tagName&&(t=event.target.parentElement);var a=getComputedStyle(t).getPropertyValue("background-color"),n=t.firstElementChild.innerText,l=t.lastElementChild.innerText;listTemplate.style.backgroundColor=a,templateTitile.textContent=n,templateCount.textContent=l;var c=t.id.slice(4);!function(){for(var e=[].slice.call(taskList.querySelectorAll(".task--"+c)),t=document.createDocumentFragment(),a=0;a<e.length;a++){var n=document.createElement("div");n.classList.add("list-template__task"),n.classList.add("list-template__task--template");var l=document.createElement("div");l.classList.add("list-template__task-ready"),n.appendChild(l);var s=document.createElement("p");s.classList.add("list-template__task-text"),n.appendChild(s);var r=document.createElement("span");r.classList.add("list-template__task-date"),n.appendChild(r),s.textContent=e[a].textContent,t.appendChild(n)}templateTaskList.innerHTML="",templateTaskList.appendChild(t)}()};categoryList.addEventListener("click",callback),onTaskDone(templateTaskList);var onTaskDoneTemplate=function(t){t.addEventListener("click",function(e){e.target.classList.contains("list-template__task-ready")&&(e.target.classList.toggle("list-template__task-ready--done"),e.target.nextElementSibling.classList.toggle("list-template__task-text--done"),e.target.parentElement.classList.toggle("list-template__task--done"),t.querySelector(".list-template__task-ready--done")?deleteIconTemplate.classList.add("delete-icon--show"):deleteIconTemplate.classList.remove("delete-icon--show"))})};onTaskDoneTemplate(templateList),deleteIconTemplate.addEventListener("click",function(e){for(var t=[].slice.call(document.querySelectorAll(".list-template__task--done")),a=[],n=0;n<t.length;n++)a[n]=t[n].textContent,t[n].remove();console.dir(a);var l=[].slice.call(taskList.querySelectorAll(".task"));for(n=0;n<t.length;n++)for(var s=0;s<l.length;s++)l[s].textContent===t[n].textContent&&l[s].remove();deleteIconTemplate.classList.remove("delete-icon--show"),updateData()});var updateData=function(){for(var e=[].slice.call(taskList.querySelectorAll(".task")),t=[].slice.call(categoryList.querySelectorAll(".category__item")),a={},n=0;n<t.length;n++)a[t[n].id.slice(4)]=0;!function(e){var t,a;for(key in e)a=categoryList.querySelector("#cat_"+key+" .category__count"),0===(t=e[key])?a.innerText="Нет задач":1===t?a.innerText=t+" задача":2<=t&&t<=4?a.innerText=t+" задачи":5<=t&&t<=20&&(a.innerText=t+" задач")}(function(e,t){for(var a=0;a<e.length;a++)e[a].classList.contains("task--work")?t.work++:e[a].classList.contains("task--personal")?t.personal++:e[a].classList.contains("task--shopping")?t.shopping++:e[a].classList.contains("task--family")?t.family++:e[a].classList.contains("task--warning")&&t.warning++;return t}(e,a))};updateData();var createNewTask=function(){document.createElement("div").classList.add("new-task");var e=document.createElement("div"),t=document.createElement("button"),a=document.createElement("button");e.appendChild(t),e.appendChild(a);var n=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div"),r=document.createElement("input");l.appendChild(s),l.appendChild(r),n.appendChild(l)},createTask=function(e){var t=document.createElement("li");t.classList.add("new-task__item");var a=document.createElement("div");a.classList.add("new-task__ready");var n=document.createElement("input");return n.id="new-task-"+e,n.name="new-task",n.type="text",n.placeholder="Что нужно сделать ?",t.appendChild(a),t.appendChild(n),t},removeInput=function(e){e.target.value||e.target.remove()},inputNewTask=document.querySelector("#new-task-1"),itemTemplate=document.querySelector(".new-task__item input"),currentItem=1,appendInput=function(e){if(13===e.keyCode&&0==!e.target.value){var t=document.querySelector(".new-task__list");e.preventDefault(),currentItem=++currentItem;var a=createTask(currentItem);a.addEventListener("keydown",appendInput),t.appendChild(a),t.querySelector("#new-task-"+currentItem).focus(),e.target.removeEventListener("keydown",appendInput),e.preventDefault()}13===e.keyCode&&0==e.target.value&&e.preventDefault(),0==e.target.value&&8===e.keyCode&&(e.target.parentNode.previousElementSibling.lastElementChild.focus(),e.target.parentNode.remove())};itemTemplate.addEventListener("keydown",appendInput);var newTaskScreen=document.querySelector(".new-task"),firstInput=document.querySelector("#new-task-1"),taskBtnDone=document.querySelector(".new-task__btn--done"),taskBtnCancel=document.querySelector(".new-task__btn--cancel");firstInput.addEventListener("input",function(e){e.target.value?taskBtnDone.classList.remove("new-task__btn--hide"):taskBtnDone.classList.add("new-task__btn--hide")}),taskBtnCancel.addEventListener("click",function(e){e.preventDefault(),newTaskScreen.classList.add("new-task--hide")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhc2stbWFyay1hbmltYXRlLmpzIl0sIm5hbWVzIjpbInRhc2tMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGVtcGxhdGVMaXN0IiwiZGVsZXRlSWNvbiIsImRlbGV0ZUljb25UZW1wbGF0ZSIsInRhc2tSZWFkeUFyciIsInNsaWNlIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJkb25lTWFyayIsImNsYXNzTGlzdCIsImFkZCIsIm9uVGFza0RvbmUiLCJ3cmFwcGVyTm9kZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJ0b2dnbGUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwidGFza0RvbmVBcnIiLCJpIiwibGVuZ3RoIiwidXBkYXRlRGF0YSIsImZvcm1CdG4iLCJidG5MaXN0Iiwib3ZlcmxheSIsImxpc3RUZW1wbGF0ZSIsInRlbXBsYXRlVGl0aWxlIiwidGVtcGxhdGVDb3VudCIsInRlbXBsYXRlVGFza0xpc3QiLCJ0ZW1wbGF0ZUl0ZW0iLCJ0ZW1wbGF0ZVJlYWR5IiwidGVtcGxhdGVUZXh0IiwidGVtcGxhdGVEYXRlIiwiY2F0ZWdvcnlMaXN0IiwiY2FsbGJhY2siLCJ0YXJnIiwiZXZlbnQiLCJ0YWdOYW1lIiwiY29sb3JUYXJnZXQiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInRpdGxlVGFyZ2V0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpbm5lclRleHQiLCJjb3VudGVyVGFyZ2V0IiwibGFzdEVsZW1lbnRDaGlsZCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwidGV4dENvbnRlbnQiLCJpZENhdGVnb3J5IiwiaWQiLCJ0ZW1wbGF0ZVRhc2tBcnIiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJuZXdJdGVtIiwiY3JlYXRlRWxlbWVudCIsIm5ld0l0ZW1SZWFkeSIsImFwcGVuZENoaWxkIiwibmV3SXRlbVRleHQiLCJuZXdJdGVtRGF0ZSIsImlubmVySFRNTCIsImNyZWF0ZVRhc2tFbGVtIiwib25UYXNrRG9uZVRlbXBsYXRlIiwidGV4dENvbnRlbnRBcnIiLCJjb25zb2xlIiwiZGlyIiwidGFza3NBcnIiLCJrIiwiY2F0ZWdvcmllc0FyciIsImNhdGVnb3JpZXNJZE9iaiIsIm9iaiIsImN1cnJlbnRWYWx1ZUNvdW50ZXIiLCJwQ291bnRlciIsImtleSIsImNvbWJpZW5kVGFza1dvcmRzIiwiYXJyYXkiLCJ3b3JrIiwicGVyc29uYWwiLCJzaG9wcGluZyIsImZhbWlseSIsIndhcm5pbmciLCJjb3VudFRhc2tzIiwiY3JlYXRlTmV3VGFzayIsImJ0bldyYXBwZXIiLCJidG5DYW5jZWwiLCJidG5Eb25lIiwibmV3VGFza0xpc3QiLCJuZXdUYXNrSXRlbSIsIm5ld1Rhc2tEb25lIiwibmV3VGFza0lucHV0IiwiY3JlYXRlVGFzayIsImN1cnJlbnQiLCJuZXdMaSIsIm5ld0RpdiIsIm5ld0lucHV0IiwibmFtZSIsInR5cGUiLCJwbGFjZWhvbGRlciIsInJlbW92ZUlucHV0IiwidmFsdWUiLCJpbnB1dE5ld1Rhc2siLCJpdGVtVGVtcGxhdGUiLCJjdXJyZW50SXRlbSIsImFwcGVuZElucHV0Iiwia2V5Q29kZSIsInByZXZlbnREZWZhdWx0IiwibmV3SXRlbVRlbXBsYXRlIiwiZm9jdXMiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicGFyZW50Tm9kZSIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJuZXdUYXNrU2NyZWVuIiwiZmlyc3RJbnB1dCIsInRhc2tCdG5Eb25lIiwidGFza0J0bkNhbmNlbCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsU0FBV0MsU0FBU0MsY0FBYyxjQUNsQ0MsYUFBZUYsU0FBU0MsY0FBYyw2QkFDdENFLFdBQWFILFNBQVNDLGNBQWMsZ0JBQ3BDRyxtQkFBcUJKLFNBQVNDLGNBQWMsMEJBQzVDSSxhQUFlLEdBQUdDLE1BQU1DLEtBQUtSLFNBQVNTLGlCQUFpQixpQkFJdkRDLFNB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NkYsU0FBb0MsR0FBbEI3RixFQUFFQyxPQUFPdUYsT0FDL0J4RixFQUFFOEYsaUJBSWtCLEdBQWxCOUYsRUFBRUMsT0FBT3VGLE9BQTRCLElBQWR4RixFQUFFNkYsVUFDM0I3RixFQUFFQyxPQUFPaUcsV0FBV0MsdUJBQXVCakUsaUJBQWlCOEQsUUFDNURoRyxFQUFFQyxPQUFPaUcsV0FBVzVGLFdBSzFCb0YsYUFBYTNGLGlCQUFpQixVQUFXNkYsYUFJekMsSUFBSVEsY0FBZ0JuSCxTQUFTQyxjQUFjLGFBQ3ZDbUgsV0FBYXBILFNBQVNDLGNBQWMsZUFDcENvSCxZQUFjckgsU0FBU0MsY0FBYyx3QkFDckNxSCxjQUFnQnRILFNBQVNDLGNBQWMsMEJBSTNDbUgsV0FBV3RHLGlCQUFpQixRQUFTLFNBQVVDLEdBQ3pDQSxFQUFFQyxPQUFPdUYsTUFDWGMsWUFBWTNHLFVBQVVXLE9BQU8sdUJBRTdCZ0csWUFBWTNHLFVBQVVDLElBQUkseUJBSzlCMkcsY0FBY3hHLGlCQUFpQixRQUFTLFNBQVVDLEdBQ2hEQSxFQUFFOEYsaUJBQ0ZNLGNBQWN6RyxVQUFVQyxJQUFJIiwiZmlsZSI6InRhc2stbWFyay1hbmltYXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhc2stbGlzdCcpO1xudmFyIHRlbXBsYXRlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190YXNrLWxpc3QnKTtcbnZhciBkZWxldGVJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlbGV0ZS1pY29uJyk7XG52YXIgZGVsZXRlSWNvblRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlbGV0ZS1pY29uLS10ZW1wbGF0ZScpO1xudmFyIHRhc2tSZWFkeUFyciA9IFtdLnNsaWNlLmNhbGwodGFza0xpc3QucXVlcnlTZWxlY3RvckFsbCgnLnRhc2tfX3JlYWR5JykpO1xuXG4vLyDQk9CQ0JvQntCn0JrQkCDQmCDQl9CQ0KfQldCg0JrQmNCS0JDQndCY0JUg0KLQkNCh0JrQkFxuXG52YXIgZG9uZU1hcmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFza19fcmVhZHktLWRvbmUnKTtcblxuaWYgKGRvbmVNYXJrKSB7XG4gIGRlbGV0ZUljb24uY2xhc3NMaXN0LmFkZCgnZGVsZXRlLWljb24tLXNob3cnKTtcbn1cblxuXG52YXIgb25UYXNrRG9uZSA9IGZ1bmN0aW9uICh3cmFwcGVyTm9kZSkge1xuXG4gIHdyYXBwZXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XG5cbiAgICAvLyDQo9GB0YLQsNC90L7QstC60LAg0LrQsNC70L7Rh9C60Lgg0YLQsNGB0LrQsFxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2tfX3JlYWR5JykpIHtcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ3Rhc2tfX3JlYWR5LS1kb25lJyk7XG4gICAgICBlLnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LnRvZ2dsZSgndGFza19fdGV4dC0tZG9uZScpO1xuICAgICAgZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCd0YXNrLS1kb25lJyk7XG5cbiAgICAgIC8vINCf0L7Rj9Cy0LvQtdC90LjQtSDQutC+0YDQt9C40L3QutC4INC/0YDQuCDQstGL0LHQvtGA0LUg0YLQsNGB0LrQsFxuICAgICAgdmFyIGRvbmVNYXJrID0gd3JhcHBlck5vZGUucXVlcnlTZWxlY3RvcignLnRhc2tfX3JlYWR5LS1kb25lJyk7XG5cbiAgICAgIGlmIChkb25lTWFyaykge1xuICAgICAgICBkZWxldGVJY29uLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZWxldGVJY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XG4gICAgICB9XG4gICAgfSBcbiAgICBcbiAgfSk7XG59XG5cbm9uVGFza0RvbmUodGFza0xpc3QpO1xuLy8gXG4vLyBcblxuXG5cblxuXG5cblxuXG4vLyDQo9CU0JDQm9CV0J3QmNCVINCi0JDQodCa0JBcblxuXG5kZWxldGVJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgdmFyIHRhc2tEb25lQXJyID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay0tZG9uZScpKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRhc2tEb25lQXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgdGFza0RvbmVBcnJbaV0ucmVtb3ZlKCk7XG4gICAgXG4gIH1cblxuICBkZWxldGVJY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XG5cbiAgdXBkYXRlRGF0YSgpO1xuXG59KTtcblxuLy8gXG4vLyBcblxuXG4vLyBidG4tcGx1c1xuXG52YXIgZm9ybUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19idG4nKTtcbnZhciBidG5MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZV9faXRlbXMnKTtcbnZhciBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKTtcblxuZm9ybUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xuICBmb3JtQnRuLmNsYXNzTGlzdC50b2dnbGUoJ2Zvcm1fX2J0bi0tYWN0aXZlJyk7XG4gIGJ0bkxpc3QuY2xhc3NMaXN0LnRvZ2dsZSgnY3JlYXRlX19pdGVtcy0tYWN0aXZlJyk7XG4gIG92ZXJsYXkuY2xhc3NMaXN0LnRvZ2dsZSgnb3ZlcmxheS0tYWN0aXZlJyk7XG59KTtcbi8vIFxuLy8gXG5cblxuXG4vLyBsaXN0LXRlbXBsYXRlXG5cbi8vINCh0J7Ql9CU0JDQndCY0JUg0JfQkNCT0J7Qm9Ce0JLQmtCQINCYINCm0JLQldCi0JAg0JrQkNCg0KLQntCn0JrQmFxudmFyIGxpc3RUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlJyk7XG52YXIgdGVtcGxhdGVUaXRpbGUgPSBsaXN0VGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3RpdGxlJyk7XG52YXIgdGVtcGxhdGVDb3VudCA9IGxpc3RUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fY291bnQnKTtcblxuLy8gdGVtcGxhdGUtbGlzdFxudmFyIHRlbXBsYXRlVGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGFzay1saXN0Jyk7XG52YXIgdGVtcGxhdGVJdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdGVtcGxhdGVfX3Rhc2stLXRlbXBsYXRlJyk7XG52YXIgdGVtcGxhdGVSZWFkeSA9IHRlbXBsYXRlSXRlbS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGFzay1yZWFkeScpO1xudmFyIHRlbXBsYXRlVGV4dCA9IHRlbXBsYXRlSXRlbS5xdWVyeVNlbGVjdG9yKCcubGlzdC10ZW1wbGF0ZV9fdGFzay10ZXh0Jyk7XG52YXIgdGVtcGxhdGVEYXRlID0gdGVtcGxhdGVJdGVtLnF1ZXJ5U2VsZWN0b3IoJ3Rhc2tfX2RhdGUnKTtcblxuXG52YXIgY2F0ZWdvcnlMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhdGVnb3J5X19saXN0Jyk7XG5cblxuXG5cblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oZSl7XG4gIHZhciB0YXJnID0gZS50YXJnZXQ7XG5cbiAgLy8g0YTQuNC60YEg0LLRi9Cx0L7RgNCwINC60LDRgNGC0L7Rh9C60LhcbiAgaWYgKGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50LnRhZ05hbWUgPT09ICdMSScpIHtcbiAgIHRhcmcgPSBldmVudC50YXJnZXQucGFyZW50RWxlbWVudDtcbiAgfVxuICBcblxuXG5cbiAgLy8g0L/QvtC70YPRh9C40Lwg0YbQstC10YIsINC30LDQs9C+0LvQvtCy0L7Quiwg0YHRh9C10YLRh9C40Log0LrQsNGC0LXQs9C+0YDQuNC4XG4gIHZhciBjb2xvclRhcmdldCA9IGdldENvbXB1dGVkU3R5bGUodGFyZykuZ2V0UHJvcGVydHlWYWx1ZSgnYmFja2dyb3VuZC1jb2xvcicpO1xuICB2YXIgdGl0bGVUYXJnZXQgPSB0YXJnLmZpcnN0RWxlbWVudENoaWxkLmlubmVyVGV4dDtcbiAgdmFyIGNvdW50ZXJUYXJnZXQgPSB0YXJnLmxhc3RFbGVtZW50Q2hpbGQuaW5uZXJUZXh0O1xuXG5cbiAgLy/Qt9Cw0LTQsNC00LjQvCDRhtCy0LXRgiwg0LfQsNCz0L7Qu9C+0LLQvtC6LCDRgdGH0LXRgtGH0LjQuiDQutCw0YDRgtC+0YfQutC4XG4gIGxpc3RUZW1wbGF0ZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclRhcmdldDtcbiAgdGVtcGxhdGVUaXRpbGUudGV4dENvbnRlbnQgPSAgdGl0bGVUYXJnZXQ7XG4gIHRlbXBsYXRlQ291bnQudGV4dENvbnRlbnQgPSBjb3VudGVyVGFyZ2V0O1xuXG5cblxuICAvLyBcbiAgLy8gXG5cbiAgLy8g0YHQvtCx0LXRgNC10Lwg0YHQv9C40YHQvtC6INC30LDQtNCw0YdcbiAgdmFyIGlkQ2F0ZWdvcnkgPSB0YXJnLmlkLnNsaWNlKDQpO1xuXG5cbiAgZnVuY3Rpb24gY3JlYXRlVGFza0VsZW0oKSB7XG5cbiAgICB2YXIgdGVtcGxhdGVUYXNrQXJyID0gW10uc2xpY2UuY2FsbCh0YXNrTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay0tJyArIGlkQ2F0ZWdvcnkpKTtcblxuICAgIHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGVtcGxhdGVUYXNrQXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbmV3SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgbmV3SXRlbS5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrJyk7XG4gICAgICBuZXdJdGVtLmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stLXRlbXBsYXRlJyk7XG5cbiAgICAgIHZhciBuZXdJdGVtUmVhZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIG5ld0l0ZW1SZWFkeS5jbGFzc0xpc3QuYWRkKCdsaXN0LXRlbXBsYXRlX190YXNrLXJlYWR5Jyk7XG4gICAgICBuZXdJdGVtLmFwcGVuZENoaWxkKG5ld0l0ZW1SZWFkeSk7XG5cbiAgICAgIHZhciBuZXdJdGVtVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgIG5ld0l0ZW1UZXh0LmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stdGV4dCcpO1xuICAgICAgbmV3SXRlbS5hcHBlbmRDaGlsZChuZXdJdGVtVGV4dCk7XG5cbiAgICAgIHZhciBuZXdJdGVtRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIG5ld0l0ZW1EYXRlLmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stZGF0ZScpO1xuICAgICAgbmV3SXRlbS5hcHBlbmRDaGlsZChuZXdJdGVtRGF0ZSk7XG4gICAgICBuZXdJdGVtVGV4dC50ZXh0Q29udGVudCA9IHRlbXBsYXRlVGFza0FycltpXS50ZXh0Q29udGVudDtcbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKG5ld0l0ZW0pO1xuICAgICAgXG4gICAgfVxuICAgIFxuICAgIHRlbXBsYXRlVGFza0xpc3QuaW5uZXJIVE1MPSAnJztcbiAgICB0ZW1wbGF0ZVRhc2tMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgfVxuXG5cbiAgY3JlYXRlVGFza0VsZW0oKTtcbiAgXG5cbiAgXG59O1xuXG5jYXRlZ29yeUxpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjYWxsYmFjayk7XG5cbm9uVGFza0RvbmUodGVtcGxhdGVUYXNrTGlzdCk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4vLyDQk9Cw0LvQvtGH0LrQsCDQuCDQv9C+0Y/QstC70LXQvdC40LUg0LrQvtGA0LfQuNC90LrQuCDQsiDQutCw0YDRgtC+0YfQutC1XG5cbnZhciBvblRhc2tEb25lVGVtcGxhdGUgPSBmdW5jdGlvbiAod3JhcHBlck5vZGUpIHtcblxuICB3cmFwcGVyTm9kZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xuXG4gICAgLy8g0KPRgdGC0LDQvdC+0LLQutCwINC60LDQu9C+0YfQutC4INGC0LDRgdC60LBcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdsaXN0LXRlbXBsYXRlX190YXNrLXJlYWR5JykpIHtcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtdGVtcGxhdGVfX3Rhc2stcmVhZHktLWRvbmUnKTtcbiAgICAgIGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LXRlbXBsYXRlX190YXNrLXRleHQtLWRvbmUnKTtcbiAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnbGlzdC10ZW1wbGF0ZV9fdGFzay0tZG9uZScpO1xuXG4gICAgICAvLyDQn9C+0Y/QstC70LXQvdC40LUg0LrQvtGA0LfQuNC90LrQuCDQv9GA0Lgg0LLRi9Cx0L7RgNC1INGC0LDRgdC60LBcbiAgICAgIHZhciBkb25lTWFyayA9IHdyYXBwZXJOb2RlLnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRlbXBsYXRlX190YXNrLXJlYWR5LS1kb25lJyk7XG5cbiAgICAgIGlmIChkb25lTWFyaykge1xuICAgICAgICBkZWxldGVJY29uVGVtcGxhdGUuY2xhc3NMaXN0LmFkZCgnZGVsZXRlLWljb24tLXNob3cnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlbGV0ZUljb25UZW1wbGF0ZS5jbGFzc0xpc3QucmVtb3ZlKCdkZWxldGUtaWNvbi0tc2hvdycpO1xuICAgICAgfVxuICAgIH0gXG4gICAgXG4gIH0pO1xufVxuXG5vblRhc2tEb25lVGVtcGxhdGUodGVtcGxhdGVMaXN0KTtcblxuLy8g0KPQlNCQ0JvQldCd0JjQlSDQotCQ0KHQmtCQINCSINCa0JDQoNCi0J7Qp9Ca0JVcblxuZGVsZXRlSWNvblRlbXBsYXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgdmFyIHRhc2tEb25lQXJyID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubGlzdC10ZW1wbGF0ZV9fdGFzay0tZG9uZScpKTtcblxuICB2YXIgdGV4dENvbnRlbnRBcnIgPSBbXTtcbiAgXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGFza0RvbmVBcnIubGVuZ3RoOyBpKyspIHtcbiAgICB0ZXh0Q29udGVudEFycltpXSA9IHRhc2tEb25lQXJyW2ldLnRleHRDb250ZW50O1xuICAgIHRhc2tEb25lQXJyW2ldLnJlbW92ZSgpO1xuICAgIFxuICB9XG5cbiAgY29uc29sZS5kaXIodGV4dENvbnRlbnRBcnIpO1xuXG5cblxuICB2YXIgdGFza3NBcnIgPSBbXS5zbGljZS5jYWxsKHRhc2tMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrJykpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGFza0RvbmVBcnIubGVuZ3RoOyBpKyspIHtcbiAgICBcblxuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdGFza3NBcnIubGVuZ3RoOyBrKyspIHtcbiAgICAgIGlmICh0YXNrc0FycltrXS50ZXh0Q29udGVudCA9PT0gdGFza0RvbmVBcnJbaV0udGV4dENvbnRlbnQpIHtcbiAgICAgICAgdGFza3NBcnJba10ucmVtb3ZlKCk7XG4gICAgICB9XG4gICAgICBcbiAgICB9XG4gICAgXG4gIH1cblxuXG5cbiAgZGVsZXRlSWNvblRlbXBsYXRlLmNsYXNzTGlzdC5yZW1vdmUoJ2RlbGV0ZS1pY29uLS1zaG93Jyk7XG5cblxuICB1cGRhdGVEYXRhKCk7XG5cbn0pO1xuXG5cbi8vINCa0J7Qm9CY0KfQldCh0KLQktCeINCX0JDQlNCQ0KdcbiBcblxuXG52YXIgdXBkYXRlRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgLy8g0YHQvtCx0LXRgNC10Lwg0Lgg0YHQs9GA0YPQv9C40YDRg9C10Lwg0YLQsNGB0LrQuCDQv9C+INC60LDRgtC10LPQvtGA0LjRj9C8INCyINC+0LHRjNC10LrRglxuXG4gIHZhciB0YXNrc0FyciA9IFtdLnNsaWNlLmNhbGwodGFza0xpc3QucXVlcnlTZWxlY3RvckFsbCgnLnRhc2snKSk7XG5cbiAgdmFyIGNhdGVnb3JpZXNBcnIgPSBbXS5zbGljZS5jYWxsKGNhdGVnb3J5TGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuY2F0ZWdvcnlfX2l0ZW0nKSk7XG5cbiAgdmFyIGNhdGVnb3JpZXNJZE9iaiA9IHt9O1xuICBcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXRlZ29yaWVzQXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgY2F0ZWdvcmllc0lkT2JqW2NhdGVnb3JpZXNBcnJbaV0uaWQuc2xpY2UoNCldID0gMDtcbiAgfVxuICBcblxuICBcbiAgXG4gIFxuICAvLyBcblxuICAvLyDQn9Ce0JTQodCn0JXQoiDQotCQ0KHQmtCe0JIg0J/QniDQmtCQ0KLQldCT0J7QoNCY0K/QnFxuXG4gIHZhciBjb3VudFRhc2tzID0gZnVuY3Rpb24gKGFycmF5LCBvYmopIHtcbiAgICBcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgIFxuICAgICAgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0td29yaycpKSB7XG4gICAgICAgIG9iai53b3JrKys7XG4gICAgICB9IGVsc2UgaWYgKGFycmF5W2ldLmNsYXNzTGlzdC5jb250YWlucygndGFzay0tcGVyc29uYWwnKSl7XG4gICAgICAgIG9iai5wZXJzb25hbCsrO1xuICAgICAgfSBlbHNlIGlmIChhcnJheVtpXS5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2stLXNob3BwaW5nJykpe1xuICAgICAgICBvYmouc2hvcHBpbmcrKztcbiAgICAgIH0gZWxzZSBpZiAoYXJyYXlbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLS1mYW1pbHknKSl7XG4gICAgICAgIG9iai5mYW1pbHkrKztcbiAgICAgIH0gZWxzZSBpZiAoYXJyYXlbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0YXNrLS13YXJuaW5nJykpe1xuICAgICAgICBvYmoud2FybmluZysrO1xuICAgICAgfVxuICAgICAgXG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH1cblxuXG4gIFxuXG4gIHZhciByZXN1bCA9IGNvdW50VGFza3ModGFza3NBcnIsIGNhdGVnb3JpZXNJZE9iaik7XG4gIFxuICAvLyBcblxuICAvLyDQntCa0J7QndCn0JDQndCY0JUg0KHQm9Ce0JLQkCBcItCX0JDQlNCQ0KfQkFwiXG5cbiAgdmFyIGNvbWJpZW5kVGFza1dvcmRzID0gZnVuY3Rpb24gKG9iaikge1xuICAgIFxuICAgIHZhciBjdXJyZW50VmFsdWVDb3VudGVyO1xuICAgIHZhciBwQ291bnRlcjtcbiAgICBmb3IgKGtleSBpbiBvYmopIHtcbiAgICAgIHBDb3VudGVyID0gY2F0ZWdvcnlMaXN0LnF1ZXJ5U2VsZWN0b3IoJyNjYXRfJyArIGtleSArICcgLmNhdGVnb3J5X19jb3VudCcpO1xuICAgICAgY3VycmVudFZhbHVlQ291bnRlciA9IG9ialtrZXldIDtcbiAgICAgIGlmIChjdXJyZW50VmFsdWVDb3VudGVyID09PSAwKSB7XG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9ICfQndC10YIg0LfQsNC00LDRhyc7XG4gICAgICB9IGVsc2UgaWYoY3VycmVudFZhbHVlQ291bnRlciA9PT0gMSl7XG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9IGN1cnJlbnRWYWx1ZUNvdW50ZXIgKyAnINC30LDQtNCw0YfQsCc7XG4gICAgICB9IGVsc2UgaWYoY3VycmVudFZhbHVlQ291bnRlciA+PSAyICYmIGN1cnJlbnRWYWx1ZUNvdW50ZXIgPD0gNCl7XG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9IGN1cnJlbnRWYWx1ZUNvdW50ZXIgKyAnINC30LDQtNCw0YfQuCc7XG4gICAgICB9IGVsc2UgaWYgKGN1cnJlbnRWYWx1ZUNvdW50ZXIgPj0gNSAmJiBjdXJyZW50VmFsdWVDb3VudGVyIDw9IDIwKSB7XG4gICAgICAgIHBDb3VudGVyLmlubmVyVGV4dCA9IGN1cnJlbnRWYWx1ZUNvdW50ZXIgKyAnINC30LDQtNCw0YcnO1xuICAgICAgfVxuICAgIH1cblxuICB9XG5cbiAgY29tYmllbmRUYXNrV29yZHMocmVzdWwpO1xuXG59XG5cbnVwZGF0ZURhdGEoKTtcbiAgXG4gIFxuLy8g0J7QotCg0JjQodCe0JLQmtCQINCe0JrQndCQINCd0J7QktCe0JPQniDQotCQ0KHQmtCQIFxuXG52YXIgY3JlYXRlTmV3VGFzayA9IGZ1bmN0aW9uKCkge1xuXG4vLyDQvtC60L3QvlxuICB2YXIgbmV3VGFza1dpbmRvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBuZXdUYXNrV2luZG93LmNsYXNzTGlzdC5hZGQoJ25ldy10YXNrJyk7XG5cbi8vINC60L3QvtC/0LrQuCDQvtGC0LzQtdC90LAg0Lgg0LPQvtGC0L7QstC+IFxuICB2YXIgYnRuV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB2YXIgYnRuQ2FuY2VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gIHZhciBidG5Eb25lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgYnRuV3JhcHBlci5hcHBlbmRDaGlsZChidG5DYW5jZWwpO1xuICBidG5XcmFwcGVyLmFwcGVuZENoaWxkKGJ0bkRvbmUpO1xuXG4vLyDRgdC/0LjRgdC+0Lot0L7QsdC10YDRgtC60LAg0Lgg0L7QtNC40L0g0YLQsNGB0LpcbiAgdmFyIG5ld1Rhc2tMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHZhciBuZXdUYXNrSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB2YXIgbmV3VGFza0RvbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgdmFyIG5ld1Rhc2tJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG5cbiAgbmV3VGFza0l0ZW0uYXBwZW5kQ2hpbGQobmV3VGFza0RvbmUpO1xuICBuZXdUYXNrSXRlbS5hcHBlbmRDaGlsZChuZXdUYXNrSW5wdXQpO1xuICBuZXdUYXNrTGlzdC5hcHBlbmRDaGlsZChuZXdUYXNrSXRlbSk7XG59XG5cblxuXG4vLyDQodCe0JfQlNCQ0J3QmNCVINCd0J7QktCe0JPQniDQmNCd0J/Qo9Ci0JAg0JTQm9CvINCX0JDQn9CY0KHQmFxuXG52YXIgY3JlYXRlVGFzayA9IGZ1bmN0aW9uKGN1cnJlbnQpIHtcblxuICB2YXIgbmV3TGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICBuZXdMaS5jbGFzc0xpc3QuYWRkKCduZXctdGFza19faXRlbScpO1xuICB2YXIgbmV3RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIG5ld0Rpdi5jbGFzc0xpc3QuYWRkKCduZXctdGFza19fcmVhZHknKTtcbiAgdmFyIG5ld0lucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgbmV3SW5wdXQuaWQgPSAnbmV3LXRhc2stJyArIGN1cnJlbnQ7XG4gIG5ld0lucHV0Lm5hbWUgPSAnbmV3LXRhc2snO1xuICBuZXdJbnB1dC50eXBlID0gJ3RleHQnO1xuICBuZXdJbnB1dC5wbGFjZWhvbGRlciA9ICfQp9GC0L4g0L3Rg9C20L3QviDRgdC00LXQu9Cw0YLRjCA/JztcbiAgbmV3TGkuYXBwZW5kQ2hpbGQobmV3RGl2KTtcbiAgbmV3TGkuYXBwZW5kQ2hpbGQobmV3SW5wdXQpO1xuXG4gIHJldHVybiBuZXdMaTtcblxufTtcblxuLy8gXG4vLyBcblxudmFyIHJlbW92ZUlucHV0ID0gZnVuY3Rpb24gKGUpIHtcbiAgaWYgKCFlLnRhcmdldC52YWx1ZSkge1xuICAgIGUudGFyZ2V0LnJlbW92ZSgpO1xuICB9XG59XG5cbnZhciBpbnB1dE5ld1Rhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmV3LXRhc2stMScpO1xudmFyIGl0ZW1UZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19faXRlbSBpbnB1dCcpO1xudmFyIGN1cnJlbnRJdGVtID0gMTtcblxudmFyIGFwcGVuZElucHV0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICBpZiAoZS5rZXlDb2RlID09PSAxMyAmJiAhZS50YXJnZXQudmFsdWUgPT0gMCApIHtcbiAgICAgIHZhciBuZXdUYXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19fbGlzdCcpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgY3VycmVudEl0ZW0gPSArK2N1cnJlbnRJdGVtO1xuICAgICAgdmFyIG5ld0l0ZW1UZW1wbGF0ZSA9IGNyZWF0ZVRhc2soY3VycmVudEl0ZW0pO1xuICAgICAgXG4gICAgICBuZXdJdGVtVGVtcGxhdGUuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFwcGVuZElucHV0KTtcbiAgICAgIG5ld1Rhc2tMaXN0LmFwcGVuZENoaWxkKG5ld0l0ZW1UZW1wbGF0ZSk7XG4gICAgICB2YXIgdGFiSXRlbW0gPSBuZXdUYXNrTGlzdC5xdWVyeVNlbGVjdG9yKCcjbmV3LXRhc2stJyArIGN1cnJlbnRJdGVtKTtcbiAgICAgIHRhYkl0ZW1tLmZvY3VzKCk7XG4gICAgICBlLnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgYXBwZW5kSW5wdXQpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cblxuICAgIGlmIChlLmtleUNvZGUgPT09IDEzICYmIGUudGFyZ2V0LnZhbHVlID09IDAgKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG5cbiAgICBpZiAoZS50YXJnZXQudmFsdWUgPT0gMCAmJiBlLmtleUNvZGUgPT09IDgpIHtcbiAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucHJldmlvdXNFbGVtZW50U2libGluZy5sYXN0RWxlbWVudENoaWxkLmZvY3VzKCk7XG4gICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH1cblxufVxuXG5pdGVtVGVtcGxhdGUuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFwcGVuZElucHV0KTtcblxuLy9cblxudmFyIG5ld1Rhc2tTY3JlZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LXRhc2snKTtcbnZhciBmaXJzdElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ldy10YXNrLTEnKTtcbnZhciB0YXNrQnRuRG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19fYnRuLS1kb25lJyk7XG52YXIgdGFza0J0bkNhbmNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdGFza19fYnRuLS1jYW5jZWwnKTtcblxuLy/Qn9Ce0K/QktCb0JXQndCY0JUg0Jgg0KHQmtCg0KvQotCY0JUg0JrQndCe0J/QmtCYIFwi0JPQntCi0J7QktCeXCJcblxuZmlyc3RJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uIChlKSB7XG4gIGlmIChlLnRhcmdldC52YWx1ZSkge1xuICAgIHRhc2tCdG5Eb25lLmNsYXNzTGlzdC5yZW1vdmUoJ25ldy10YXNrX19idG4tLWhpZGUnKTtcbiAgfSBlbHNlIHtcbiAgICB0YXNrQnRuRG9uZS5jbGFzc0xpc3QuYWRkKCduZXctdGFza19fYnRuLS1oaWRlJyk7XG4gIH1cbn0pO1xuXG5cbnRhc2tCdG5DYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIG5ld1Rhc2tTY3JlZW4uY2xhc3NMaXN0LmFkZCgnbmV3LXRhc2stLWhpZGUnKTtcbn0pOyJdfQ==
